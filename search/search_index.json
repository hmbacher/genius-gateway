{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#genius-gateway","title":"Genius Gateway","text":"<p>IMPORTANT DISCLAIMER</p> <p>This is a reverse-engineered implementation NOT AFFILIATED with Hekatron. </p> <p>You are solely responsible for ensuring compliance with all local regulations regarding RF communication and fire safety systems. The authors assume no liability for any damages or safety issues.</p> <p>USE AT YOUR OWN RISK! </p>"},{"location":"#what-is-the-genius-gateway","title":"What is the Genius Gateway?","text":"<p>The Genius Gateway is a reverse-engineered interface for Hekatron Genius Plus X smoke detection systems. It enables real-time monitoring, MQTT integration, and web-based management of Genius smoke detectors without requiring proprietary Hekatron gateways.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li> Manage smoke detectors - Real-time monitoring and control</li> <li> Manage alarm lines - Configure and monitor alarm communications  </li> <li> Capture, visualize and analyze packets - Real-time packet inspection tools</li> <li> Manage gateway settings - Complete configuration interface</li> <li> MQTT and WebSocket support - Modern API interfaces for integration</li> <li> Home Assistant integration - Native support with automatic discovery</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Get your Genius Gateway up and running:</p> <ol> <li>Review the documentation structure to understand how information is organized</li> <li>Perform the General Setup</li> <li>Configure Genius Gateway to use its full potential</li> </ol>"},{"location":"#source-code","title":"Source Code","text":"<p>View on GitHub </p>"},{"location":"background/","title":"Background","text":""},{"location":"background/#background","title":"Background","text":""},{"location":"background/#motivation","title":"Motivation","text":"<p>Having multiple networked Hekatron Genius Plus X smoke detectors in a modern residential installation presents a unique challenge: while these devices communicate effectively with each other, they cannot be integrated into modern home automation systems without Hekatron's proprietary gateway Genius Port .</p> <p>Even with the Genius Port, control is only possible through the Genius Control App , and smart home system integration seems limited exclusively to the digitalSTROM  platform.</p> <p>The core problem is the lack of integration options with state-of-the-art protocols like MQTT, REST APIs, or WebSocket connections that modern extensible smart home ecosystems rely on. This leaves users with an isolated fire safety network that cannot participate in comprehensive home monitoring and automation scenarios.</p>"},{"location":"background/#analyzed-smoke-detectors","title":"Analyzed smoke detectors","text":"<p>This project focuses on Hekatron Genius Plus X  smoke detectors equipped with FM Basis X   radio modules. These components formed the foundation of the reverse-engineered communication protocol.</p> <p>Compatibility with FM Pro X</p> <p>The Hekatron radio module FM Pro X  has not been tested, and its specific behaviour and features remain unexplored. The project currently targets the most common FM Basis X configuration.</p>"},{"location":"background/#hardware-platform","title":"Hardware Platform","text":"<p>The following hardware was used for analyzing the smoke detector system and implementing the Genius Gateway.</p>"},{"location":"background/#rf-module","title":"RF Module","text":"<p>EBYTE E07-900MBL-01 </p> <ul> <li>Sub-GHz transceiver module</li> <li>868 MHz operation compatible with Hekatron devices</li> <li>Integrated antenna and RF matching</li> <li>SPI interface for microcontroller communication</li> </ul>"},{"location":"background/#microcontroller","title":"Microcontroller","text":"<p>ESP32-S3-DevKitC-1-N8R2 </p> <ul> <li>Dual-core Xtensa LX7 processor</li> <li>Built-in WiFi for network connectivity</li> <li>Sufficient memory and processing power (PSRAM not required)</li> </ul>"},{"location":"background/#software-architecture","title":"Software Architecture","text":"<p>The later Genius Gateway software builds upon the ESP32SvelteKit  framework, which provides a robust foundation for IoT applications.</p> <ul> <li>Beautiful UI powered by DaisyUI  and TailwindCSS </li> <li>Low Memory Footprint and Easy Customization by Courtesy of SvelteKit </li> <li>Rich Communication Interfaces (like MQTT client, HTTP RESTful API, a WebSocket based Event Socket and a classic WebSocket Server)</li> <li>WiFi Provisioning and Management</li> <li>Secured API and User Management</li> <li>OTA Upgrade Service</li> <li>Automated Build Chain</li> <li>Compatible with all ESP32 Flavours</li> </ul>"},{"location":"hardware/","title":"Hardware","text":""},{"location":"hardware/#hardware","title":"Hardware","text":""},{"location":"hardware/#licensing","title":"Licensing","text":"<p>For legal aspects and licensing information, please refer to the License page.</p>"},{"location":"hardware/#experimental-setup","title":"Experimental setup","text":"<p>As part of the reverse engineering and for testing purposes, a test setup was used with the following components:</p> <ol> <li>ESP32 Microcontroller<ul> <li>Espressif ESP32S3-DevKit-C-1-N8R2 </li> <li>SEED XIAO ESP32-S3 </li> </ul> </li> <li>CC1101 RF Transceiver<ul> <li>EBYTE E07-900MBL-01 </li> </ul> </li> <li>Wiring<ul> <li>A few jumper cables to connect the two development boards</li> <li>Micro-USB and USB-C cables for power supply and UART access (flashing, device output)</li> </ul> </li> </ol> <p>All components are available online from leading electronics retailers at low prices.</p>"},{"location":"hardware/#final-hardware","title":"Final hardware","text":"<p>To achieve a robust setup, and since manufacturing PCBs is now possible at very low cost, it was a logical decision to design a custom PCB and integrate it into a suitable enclosure.</p> <p></p> <p>Schematics and PCB layout were created using the free EasyEDA Editor . PCB manufacturing and assembly were performed by JLCPCB .</p>"},{"location":"hardware/#schematics","title":"Schematics","text":"<ul> <li> <p>Schematics Overall Genius Gateway schematics</p> </li> </ul> <p>Download the schematic as a PDF:  gg-schematic-main-v1.1.pdf</p> <p>Schematics are also available in various formats as part of the Design Files section below.</p>"},{"location":"hardware/#pcb-layout","title":"PCB Layout","text":"<ul> <li> <p>PCB Layout Top Side</p> </li> <li> <p></p> <p>PCB Layout Bottom Side</p> </li> </ul> <p>PCB layout files are available in various formats as part of the Design Files section below.</p>"},{"location":"hardware/#manufacturing","title":"Manufacturing","text":"<p>Download Gerber file bundle:  gg-gerber-v1.1.zip</p> <p>PCB design-related files are available in various formats as part of the Design Files section below.</p>"},{"location":"hardware/#bom","title":"BOM","text":""},{"location":"hardware/#electronic-parts","title":"Electronic parts","text":"<ol> <li> <p>PCB Assembly     Download the detailed EasyEDA BOM as an Excel file:  gg-pcb-bom-v1.1.xlsx</p> </li> <li> <p>SEED XIAO ESP32-S3  with soldered pin headers as plug-in module</p> </li> <li> <p>CC1101 RF transceiver module EBYTE E07-900M10S  to be soldered to the PCB</p> </li> <li> <p>Antenna pigtail cables   </p> <ul> <li>1x male SMA  IPX, delivered with 2.4 GHz rod antenna  (for WiFi network)</li> <li>1x female SMA  IPX, 10cm, e.g.  this (for Hekatron Genius Plus X  network)</li> </ul> </li> </ol>"},{"location":"hardware/#other-parts","title":"Other parts","text":"<ol> <li>Case<ul> <li>Option 1: BOPLA XM 130804 G 7035 (Order no. 07413084) </li> <li>Option 2: BOX4U 6U07130804437 (fully compatible to BOPLA case), e.g. at Reichelt Elektronik </li> <li>4 pcs. of PCB mounting screws for direct fastening into plastic material</li> </ul> </li> <li>External antennas<ul> <li>2.4 GHz rod antenna  (for WiFi network)</li> <li>868 MHz antenna TX868-JKD-20  (for Hekatron Genius Plus X  network)</li> </ul> </li> <li>External power supply (12 VDC) with 5,5 mm x 2,1 mm DC plug</li> </ol>"},{"location":"hardware/#design-files","title":"Design Files","text":"<p>Visit the project in OSHWLab  or download design files directly:</p> File Format Comment  gg-easyeda-pro-v1.1.epro EasyEDA Pro  gg-altium-designer-v1.1.zip Altium Designer  Untested  gg-mentor-pads-v1.1.zip Mentor Graphics PADS  Untested"},{"location":"hardware/#cad","title":"CAD","text":"File Size Format Comment  gg-3d-pcb-v1.1.step 19.2 MB STEP (AP214) PCB  gg.f3d 10.7 MB AUTODESK Fusion Genius Gateway(no external antennas)"},{"location":"license/","title":"License","text":""},{"location":"license/#genius-gateway-license","title":"Genius Gateway - License","text":"<p>The Genius Gateway project uses different licenses for different components to ensure open sharing for personal and educational purposes while prohibiting commercial use.</p>"},{"location":"license/#license-overview","title":"License Overview","text":"Component License Applies To Details Hardware Design CC BY-NC-SA 4.0 PCB designs, schematics, CAD files, mechanical drawings Hardware Design Software AGPL-3.0 + Commons Clause ESP32 firmware, protocol implementation, backend services, web interface Software Documentation CC BY-NC-SA 4.0 All documentation, guides, images, traces, downloadable content Documentation and Assets Third-Party Components Various (LGPL, MIT, etc.) ESP32 SvelteKit, Arduino libraries, PsychicHttp, other dependencies Third-Party Components <p>Commercial Use Prohibited</p> <p>All Genius Gateway components (hardware, software, documentation) prohibit commercial use without explicit permission. See Commercial Use for details.</p>"},{"location":"license/#hardware-design","title":"Hardware Design","text":"<p>Applies to: PCB designs, schematics, CAD files, mechanical drawings</p> <p>Files: <code>docs/assets/downloads/cae/*</code>, <code>docs/assets/downloads/cad/*</code></p> <p>License: Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</p> <p>License URL: https://creativecommons.org/licenses/by-nc-sa/4.0/</p> <p>You are free to:</p> <ul> <li>Share: Copy and redistribute the material in any medium or format for non-commercial purposes</li> <li>Adapt: Remix, transform, and build upon the material for non-commercial purposes</li> </ul> <p>Under the following terms:</p> <ul> <li>Attribution: You must give appropriate credit and indicate if changes were made</li> <li>NonCommercial: You may not use the material for commercial purposes</li> <li>ShareAlike: If you remix or transform the material, you must distribute under the same license</li> </ul> <p>This license allows private and educational use while prohibiting commercial use without permission.</p>"},{"location":"license/#software","title":"Software","text":"<p>Applies to: ESP32 firmware, protocol implementation, reverse engineering code, backend services, web interface</p> <p>Files: <code>src/*</code></p> <p>License: GNU Affero General Public License v3.0 with Commons Clause (AGPL-3.0 + Commons Clause)</p> <p>License URL: https://www.gnu.org/licenses/agpl-3.0.en.html</p> <p>Copyright (C) 2024-2025 Genius Gateway Project</p> <p>You are free to:</p> <ul> <li>Use: Run the software for personal and educational purposes</li> <li>Study: Access and study the source code</li> <li>Modify: Create modified versions for personal and educational use</li> <li>Share: Distribute the original or modified versions for non-commercial purposes</li> </ul> <p>Under the following terms:</p> <ul> <li>Source Code: Modified versions must be made available under the same license</li> <li>NonCommercial: You may not sell, rent, lease, or otherwise use the software for commercial purposes</li> <li>Attribution: You must give appropriate credit</li> </ul>"},{"location":"license/#agpl-30-license-text","title":"AGPL-3.0 License Text","text":"<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p> <p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.</p> <p>You should have received a copy of the GNU Affero General Public License along with this program. If not, see https://www.gnu.org/licenses/.</p>"},{"location":"license/#commons-clause-license-condition-v10","title":"Commons Clause License Condition v1.0","text":"<p>The Software is provided to you by the Licensor under the License, as defined below, subject to the following condition:</p> <p>Without limiting other conditions in the License, the grant of rights under the License will not include, and the License does not grant to you, the right to Sell the Software.</p> <p>For purposes of the foregoing, \"Sell\" means practicing any or all of the rights granted to you under the License to provide to third parties, for a fee or other consideration (including without limitation fees for hosting or consulting/support services related to the Software), a product or service whose value derives, entirely or substantially, from the functionality of the Software.</p> <p>Note: Third-party frameworks and libraries (ESP32SvelteKit, Arduino, etc.) retain their original licenses. Please refer to their respective license files in the source code.</p> <p>Rationale: The AGPL-3.0 with Commons Clause ensures that improvements to the reverse-engineered protocol implementation remain open source while prohibiting commercial use without permission.</p>"},{"location":"license/#documentation-and-assets","title":"Documentation and Assets","text":"<p>Applies to: All documentation, guides, images, traces, and downloadable content</p> <p>Files: <code>docs/*</code>, <code>README.md</code>, <code>CHANGELOG.md</code></p> <p>License: Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</p> <p>License URL: https://creativecommons.org/licenses/by-nc-sa/4.0/</p> <p>You are free to:</p> <ul> <li>Share: Copy and redistribute the material in any medium or format for non-commercial purposes</li> <li>Adapt: Remix, transform, and build upon the material for non-commercial purposes</li> </ul> <p>Under the following terms:</p> <ul> <li>Attribution: You must give appropriate credit and indicate if changes were made</li> <li>NonCommercial: You may not use the material for commercial purposes</li> <li>ShareAlike: If you remix or transform the material, you must distribute under the same license</li> </ul> <p>This license allows private and educational use while prohibiting commercial use without permission.</p> <p>Attribution: \"Genius Gateway Documentation by hmbacher (https://github.com/hmbacher/genius-gateway) is licensed under CC BY-NC-SA 4.0\"</p>"},{"location":"license/#third-party-components","title":"Third-Party Components","text":"<p>This project builds upon and includes components from other open source projects. These third-party components retain their original licenses:</p>"},{"location":"license/#esp32-sveltekit-framework","title":"ESP32 SvelteKit Framework","text":"<ul> <li>License: LGPL v3 (backend), MIT (frontend)</li> <li>Author: theelims</li> <li>URL: https://github.com/theelims/ESP32-sveltekit</li> <li>Usage: Base framework for ESP32 web applications</li> <li>Note: The ESP32 SvelteKit framework retains its original licenses. Genius Gateway modifications and additions to the framework are licensed under AGPL-3.0 + Commons Clause.</li> </ul>"},{"location":"license/#arduino-libraries","title":"Arduino Libraries","text":"<p>Various Arduino libraries used are subject to their respective licenses. See individual library documentation for details.</p>"},{"location":"license/#psychichttp","title":"PsychicHttp","text":"<ul> <li>License: LGPL v2.1</li> <li>URL: https://github.com/hoeken/PsychicHttp</li> <li>Usage: HTTP server library for ESP32</li> </ul>"},{"location":"license/#license-compatibility-and-important-notes","title":"License Compatibility and Important Notes","text":""},{"location":"license/#third-party-dependencies","title":"Third-Party Dependencies","text":"<p>This project uses third-party libraries and frameworks that retain their original licenses:</p> <ul> <li>ESP32 SvelteKit: LGPL v3 (backend), MIT (frontend)</li> <li>PsychicHttp: LGPL v2.1</li> <li>Arduino libraries: Various licenses (see respective library documentation)</li> <li>Other dependencies: See individual library documentation for license details</li> </ul>"},{"location":"license/#license-interaction","title":"License Interaction","text":"<ul> <li>Genius Gateway code is licensed under AGPL-3.0 + Commons Clause (more restrictive than underlying frameworks)</li> <li>Third-party components retain their original licenses (LGPL, MIT, etc.)</li> <li>Hardware designs (CC BY-NC-SA 4.0) and Documentation (CC BY-NC-SA 4.0) are independent of software licenses</li> </ul>"},{"location":"license/#important-legal-considerations","title":"Important Legal Considerations","text":"<ol> <li> <p>AGPL-3.0 Network Requirement: If you provide the software as a network service (e.g., hosting it on a server accessible to users), you must make the complete source code available to those users.</p> </li> <li> <p>Commons Clause Restriction: The Commons Clause prohibits selling the software or offering it as a paid service. This means:</p> </li> <li>\u274c You cannot sell the software itself</li> <li>\u274c You cannot offer it as a hosted/SaaS service for a fee</li> <li>\u274c You cannot provide consulting/support services where the value primarily comes from the software</li> <li>\u2705 You can use it personally or for educational purposes</li> <li> <p>\u2705 You can modify and share it non-commercially</p> </li> <li> <p>Hardware &amp; Documentation: Both use CC BY-NC-SA 4.0, which prohibits commercial use without permission.</p> </li> </ol>"},{"location":"license/#commercial-use","title":"Commercial Use","text":"<p>All components (hardware, software, documentation) prohibit commercial use without explicit permission.</p> <p>For commercial licensing inquiries or questions about licensing, please open an issue in the GitHub repository or contact the project maintainer.</p>"},{"location":"license/#contact","title":"Contact","text":"<p>For licensing questions, commercial use requests, or general inquiries:</p> <ul> <li>GitHub Issues: https://github.com/hmbacher/genius-gateway/issues</li> <li>Project Maintainer: hmbacher</li> </ul>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#api-reference","title":"API Reference","text":"<p>Complete API documentation for the Genius Gateway.</p>"},{"location":"api/#overview","title":"Overview","text":"<p>The Genius Gateway provides multiple APIs for integration and automation:</p> <ul> <li>REST API - Standard HTTP endpoints for device management and configuration</li> <li>WebSocket API - Real-time events and packet streaming</li> <li>MQTT Topics - Home automation integration and status publishing</li> </ul>"},{"location":"api/#api-categories","title":"API Categories","text":""},{"location":"api/#device-management","title":"Device Management","text":"<ul> <li>Device discovery and registration</li> <li>Status monitoring and alarm management  </li> <li>Configuration and settings updates</li> </ul>"},{"location":"api/#system-administration","title":"System Administration","text":"<ul> <li>Gateway settings and network configuration</li> <li>User management and authentication</li> <li>System monitoring and diagnostics</li> </ul>"},{"location":"api/#real-time-communication","title":"Real-time Communication","text":"<ul> <li>WebSocket events for live updates</li> <li>Packet visualization and protocol analysis</li> <li>MQTT publishing for home automation</li> </ul>"},{"location":"api/#getting-started","title":"Getting Started","text":"<ol> <li>Authentication - Obtain API credentials through the web interface</li> <li>Base URL - All REST endpoints use <code>http://[gateway-ip]/rest/</code></li> <li>WebSocket - Connect to <code>ws://[gateway-ip]/ws/</code> for real-time events</li> <li>MQTT - Subscribe to <code>genius-gateway/+/+</code> topic patterns</li> </ol>"},{"location":"api/#complete-api-documentation","title":"Complete API Documentation","text":"<ul> <li>REST Endpoints - Complete REST API reference (coming soon)</li> <li>WebSocket Events - Real-time event documentation  </li> <li>MQTT Topics - MQTT integration guide</li> </ul>"},{"location":"api/#examples-and-libraries","title":"Examples and Libraries","text":"<p>Code examples and client libraries are available in the GitHub repository under the <code>examples/</code> directory.</p>"},{"location":"api/http-api/","title":"HTTP API","text":""},{"location":"api/http-api/#http-api-documentation","title":"HTTP API Documentation","text":""},{"location":"api/http-api/#introduction","title":"Introduction","text":""},{"location":"api/http-api/#common-response-codes","title":"Common Response Codes","text":"<ul> <li>200 OK - Request successful</li> <li>400 Bad Request - Invalid JSON or missing required fields</li> <li>401 Unauthorized - Authentication required or token invalid</li> <li>403 Forbidden - Insufficient permissions (admin required)</li> <li>500 Internal Server Error - Server-side error</li> </ul>"},{"location":"api/http-api/#authorization-levels","title":"Authorization Levels","text":"<ul> <li>\u2705 Public - No authentication required (public endpoints like <code>/rest/signIn</code>)</li> <li>\ud83d\udd12 User - Requires valid JWT token (most read operations)</li> <li>\ud83d\udee1\ufe0f Admin - Requires valid JWT token with admin privileges (configuration changes, system operations)</li> </ul>"},{"location":"api/http-api/#authentication-header-format","title":"Authentication Header Format","text":"<p>For authenticated endpoints, include JWT token: </p><pre><code>Authorization: Bearer &lt;token&gt;\n</code></pre><p></p>"},{"location":"api/http-api/#genius-gateway-endpoints","title":"Genius Gateway Endpoints","text":""},{"location":"api/http-api/#overview","title":"Overview","text":"Endpoint Method Auth Description <code>/rest/gateway-devices</code> GET, POST \ud83d\udee1\ufe0f Manage smoke detector devices <code>/rest/alarm-lines</code> GET, POST \ud83d\udee1\ufe0f Manage alarm lines (RF groups) <code>/rest/alarm-lines/do</code> POST \ud83d\udee1\ufe0f Execute alarm line actions <code>/rest/gateway-settings</code> GET, POST \ud83d\udee1\ufe0f Configure gateway behavior <code>/rest/mqtt-settings</code> GET, POST \ud83d\udee1\ufe0f Configure Home Assistant MQTT <code>/rest/end-alarms</code> POST \ud83d\udee1\ufe0f End all alarms and block new ones <code>/rest/end-alarmblocking</code> POST \ud83d\udee1\ufe0f End alarm blocking period <code>/rest/cc1101/state</code> GET \ud83d\udd12 Get radio transceiver status <code>/rest/cc1101/rx</code> POST \ud83d\udee1\ufe0f Force radio into RX state <code>/rest/wslogger</code> GET, POST \ud83d\udee1\ufe0f Configure WebSocket logger <code>/rest/packet-visualizer</code> GET, POST \ud83d\udee1\ufe0f Configure packet visualizer"},{"location":"api/http-api/#device-management","title":"Device Management","text":""},{"location":"api/http-api/#restgateway-devices","title":"<code>/rest/gateway-devices</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Manage registered smoke detector devices</li> </ul> <p>GET Response: </p><pre><code>{\n  \"devices\": [\n    {\n      \"id\": 1,\n      \"smokeDetector\": {\n        \"sn\": 12345678,\n        \"productionDate\": \"2024-01-15T00:00:00Z\",\n        \"model\": 0\n      },\n      \"radioModule\": {\n        \"sn\": 87654321,\n        \"productionDate\": \"2024-01-15T00:00:00Z\",\n        \"model\": 0\n      },\n      \"location\": \"Living Room\",\n      \"isAlarming\": false,\n      \"registration\": 1,\n      \"alarms\": [\n        {\n          \"startTime\": \"2025-01-15T10:30:00Z\",\n          \"endTime\": \"2025-01-15T10:35:00Z\",\n          \"endingReason\": 0\n        }\n      ]\n    }\n  ]\n}\n</code></pre><p></p> <p>Device Fields:</p> <ul> <li><code>id</code> - Unique device identifier (auto-generated)</li> <li><code>smokeDetector.sn</code> - Smoke detector serial number</li> <li><code>radioModule.sn</code> - Radio module serial number  </li> <li><code>location</code> - Human-readable location string</li> <li><code>isAlarming</code> - Current alarm state</li> <li><code>registration</code> - How device was added (0=built-in, 1=packet, 2=manual)</li> <li><code>alarms</code> - History of alarm events</li> <li><code>endingReason</code> - How alarm ended (-1=active, 0=detector, 1=manual)</li> </ul> <p>POST Request: Same format as GET response</p> <p>POST Response: 200 OK with updated device list</p>"},{"location":"api/http-api/#alarm-line-management","title":"Alarm Line Management","text":""},{"location":"api/http-api/#restalarm-lines","title":"<code>/rest/alarm-lines</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Manage configured alarm lines (RF communication groups)</li> </ul> <p>GET Response: </p><pre><code>{\n  \"lines\": [\n    {\n      \"id\": 123456789,\n      \"name\": \"Building A\",\n      \"created\": \"2025-01-15T10:00:00Z\",\n      \"acquisition\": 1\n    }\n  ]\n}\n</code></pre><p></p> <p>Alarm Line Fields:</p> <ul> <li><code>id</code> - Unique 32-bit alarm line ID (0xFFFFFFFF = broadcast)</li> <li><code>name</code> - Human-readable alarm line name</li> <li><code>created</code> - Creation timestamp</li> <li><code>acquisition</code> - How line was discovered (0=built-in, 1=packet, 2=manual)</li> </ul> <p>POST Request: Same format as GET response</p> <p>POST Response: 200 OK with updated alarm line list</p>"},{"location":"api/http-api/#restalarm-linesdo","title":"<code>/rest/alarm-lines/do</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Execute alarm line action (line test or fire alarm)</li> <li>Request: <pre><code>{\n  \"action\": \"linetest\",\n  \"alarmLineId\": 123456789,\n  \"duration\": 10\n}\n</code></pre></li> </ul> <p>Actions:</p> <ul> <li><code>linetest</code> - Trigger RF line test transmission</li> <li><code>firealarm</code> - Trigger RF fire alarm transmission</li> <li><code>duration</code> - Duration in seconds</li> </ul> <p>Response: </p><pre><code>{\n  \"success\": true\n}\n</code></pre><p></p>"},{"location":"api/http-api/#gateway-settings","title":"Gateway Settings","text":""},{"location":"api/http-api/#restgateway-settings","title":"<code>/rest/gateway-settings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Configure gateway behavior and alerts</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"alert_on_unknown_detectors\": true,\n  \"add_alarm_line_from_commissioning_packet\": true,\n  \"add_alarm_line_from_alarm_packet\": false,\n  \"add_alarm_line_from_line_test_packet\": false\n}\n</code></pre><p></p> <p>Settings:</p> <ul> <li><code>alert_on_unknown_detectors</code> - Generate alerts for unregistered devices</li> <li><code>add_alarm_line_from_commissioning_packet</code> - Auto-add lines from commissioning</li> <li><code>add_alarm_line_from_alarm_packet</code> - Auto-add lines from alarm packets</li> <li><code>add_alarm_line_from_line_test_packet</code> - Auto-add lines from line tests</li> </ul> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#gateway-mqtt-settings","title":"Gateway MQTT Settings","text":""},{"location":"api/http-api/#restmqtt-settings","title":"<code>/rest/mqtt-settings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Configure Home Assistant MQTT integration</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"haMQTTEnabled\": true,\n  \"haMQTTTopicPrefix\": \"homeassistant/binary_sensor/genius-\",\n  \"alarmEnabled\": true,\n  \"alarmTopic\": \"smarthome/genius-gateway/alarm\"\n}\n</code></pre><p></p> <p>Settings:</p> <ul> <li><code>haMQTTEnabled</code> - Enable Home Assistant MQTT auto-discovery</li> <li><code>haMQTTTopicPrefix</code> - Topic prefix for HA device publishing</li> <li><code>alarmEnabled</code> - Enable alarm state publishing</li> <li><code>alarmTopic</code> - MQTT topic for global alarm state</li> </ul> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#alarm-control","title":"Alarm Control","text":""},{"location":"api/http-api/#restend-alarms","title":"<code>/rest/end-alarms</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: End all active alarms and optionally block new alarms</li> <li>Request: <pre><code>{\n  \"alarmBlockingTime\": 300\n}\n</code></pre></li> <li><code>alarmBlockingTime</code> - Seconds to block new alarms (0 = no blocking)</li> </ul> <p>Response: </p><pre><code>{\n  \"success\": true\n}\n</code></pre><p></p>"},{"location":"api/http-api/#restend-alarmblocking","title":"<code>/rest/end-alarmblocking</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Immediately end alarm blocking period</li> </ul> <p>Request: Empty body or <code>{}</code></p> <p>Response: </p><pre><code>{\n  \"success\": true\n}\n</code></pre><p></p>"},{"location":"api/http-api/#cc1101-radio-controller","title":"CC1101 Radio Controller","text":""},{"location":"api/http-api/#restcc1101state","title":"<code>/rest/cc1101/state</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get CC1101 radio transceiver status</li> <li> <p>Response: </p><pre><code>{\n  \"success\": true,\n  \"action\": false,\n  \"state\": 1,\n  \"rxMonitorEnabled\": true\n}\n</code></pre><p></p> </li> <li> <p><code>action</code> - True if currently receiving/transmitting (GDO0 high)</p> </li> <li><code>state</code> - Radio state (0=IDLE, 1=RX, 2=TX, etc.)</li> <li><code>rxMonitorEnabled</code> - RX monitoring enabled flag</li> </ul>"},{"location":"api/http-api/#restcc1101rx","title":"<code>/rest/cc1101/rx</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Force CC1101 into RX (receive) state</li> <li>Response: <pre><code>{\n  \"success\": true\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#websocket-logger","title":"WebSocket Logger","text":""},{"location":"api/http-api/#restwslogger","title":"<code>/rest/wslogger</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Configure WebSocket logger settings</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"enabled\": true\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#packet-visualizer","title":"Packet Visualizer","text":""},{"location":"api/http-api/#restpacket-visualizer","title":"<code>/rest/packet-visualizer</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Configure packet visualizer display settings</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"showDetails\": true,\n  \"showMetadata\": true\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#framework-endpoints-esp32-sveltekit","title":"Framework Endpoints (ESP32 SvelteKit)","text":""},{"location":"api/http-api/#overview_1","title":"Overview","text":"Endpoint Method Auth Description <code>/rest/wifiStatus</code> GET \ud83d\udd12 Get WiFi connection status <code>/rest/wifiSettings</code> GET, POST \ud83d\udd12 Get/update WiFi configuration <code>/rest/scanNetworks</code> GET \ud83d\udd12 Trigger WiFi network scan <code>/rest/listNetworks</code> GET \ud83d\udd12 Get network scan results <code>/rest/apStatus</code> GET \ud83d\udd12 Get Access Point status <code>/rest/apSettings</code> GET, POST \ud83d\udee1\ufe0f Get/update AP configuration <code>/rest/ntpStatus</code> GET \ud83d\udd12 Get NTP sync status <code>/rest/ntpSettings</code> GET, POST \ud83d\udee1\ufe0f Get/update NTP settings <code>/rest/time</code> GET, POST \ud83d\udee1\ufe0f Get/set system time <code>/rest/mqttStatus</code> GET \ud83d\udd12 Get MQTT connection status <code>/rest/mqttSettings</code> GET, POST \ud83d\udee1\ufe0f Get/update MQTT settings <code>/rest/systemStatus</code> GET \ud83d\udd12 Get system information <code>/rest/restart</code> POST \ud83d\udee1\ufe0f Restart device <code>/rest/sleep</code> POST \ud83d\udd12 Put device in deep sleep <code>/rest/factoryReset</code> POST \ud83d\udee1\ufe0f Reset to factory defaults <code>/rest/health</code> GET \u2705 Health check <code>/rest/features</code> GET \ud83d\udd12 Get enabled feature flags <code>/rest/coreDump</code> GET \ud83d\udee1\ufe0f Get core dump info <code>/rest/signIn</code> POST \u2705 Authenticate user <code>/rest/verifyAuthorization</code> GET \ud83d\udd12 Verify JWT token <code>/rest/securitySettings</code> GET, POST \ud83d\udee1\ufe0f Get/update security settings <code>/rest/generateToken</code> GET \ud83d\udee1\ufe0f Generate JWT secret <code>/rest/uploadFirmware</code> POST \ud83d\udee1\ufe0f Upload firmware binary <code>/rest/downloadUpdate</code> POST \ud83d\udee1\ufe0f Download firmware update"},{"location":"api/http-api/#wifi-management","title":"WiFi Management","text":""},{"location":"api/http-api/#restwifistatus","title":"<code>/rest/wifiStatus</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get current WiFi connection status</li> <li>Response: <pre><code>{\n  \"status\": 0-5,\n  \"local_ip\": \"192.168.1.100\",\n  \"mac_address\": \"AA:BB:CC:DD:EE:FF\",\n  \"rssi\": -45,\n  \"ssid\": \"MyNetwork\",\n  \"bssid\": \"AA:BB:CC:DD:EE:FF\",\n  \"channel\": 6,\n  \"subnet_mask\": \"255.255.255.0\",\n  \"gateway_ip\": \"192.168.1.1\",\n  \"dns_ip_1\": \"8.8.8.8\",\n  \"dns_ip_2\": \"8.8.4.4\"\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restwifisettings","title":"<code>/rest/wifiSettings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get or update WiFi configuration</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"wifi_networks\": [\n    {\n      \"ssid\": \"NetworkName\",\n      \"password\": \"password123\",\n      \"static_ip_config\": false,\n      \"local_ip\": \"192.168.1.100\",\n      \"gateway_ip\": \"192.168.1.1\", \n      \"subnet_mask\": \"255.255.255.0\",\n      \"dns_ip_1\": \"8.8.8.8\",\n      \"dns_ip_2\": \"8.8.4.4\"\n    }\n  ],\n  \"hostname\": \"genius-gateway\",\n  \"connection_mode\": 0\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#restscannetworks","title":"<code>/rest/scanNetworks</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Trigger WiFi network scan</li> </ul> <p>Response: </p><pre><code>{\n  \"networks\": [\n    {\n      \"rssi\": -45,\n      \"ssid\": \"NetworkName\",\n      \"bssid\": \"AA:BB:CC:DD:EE:FF\",\n      \"channel\": 6,\n      \"encryption_type\": 3\n    }\n  ]\n}\n</code></pre><p></p>"},{"location":"api/http-api/#restlistnetworks","title":"<code>/rest/listNetworks</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get results from last network scan</li> </ul> <p>Response: Same format as <code>/rest/scanNetworks</code></p>"},{"location":"api/http-api/#access-point-management","title":"Access Point Management","text":""},{"location":"api/http-api/#restapstatus","title":"<code>/rest/apStatus</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get Access Point status</li> <li>Response: <pre><code>{\n  \"status\": 0-1,\n  \"ip_address\": \"192.168.4.1\",\n  \"mac_address\": \"AA:BB:CC:DD:EE:FF\",\n  \"station_num\": 2\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restapsettings","title":"<code>/rest/apSettings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Get or update Access Point configuration</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"provision_mode\": 0-2,\n  \"ssid\": \"Genius-Gateway-AP\",\n  \"password\": \"password123\",\n  \"channel\": 1,\n  \"ssid_hidden\": false,\n  \"max_clients\": 4,\n  \"local_ip\": \"192.168.4.1\",\n  \"gateway_ip\": \"192.168.4.1\",\n  \"subnet_mask\": \"255.255.255.0\"\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#ntp-time-management","title":"NTP (Time) Management","text":""},{"location":"api/http-api/#restntpstatus","title":"<code>/rest/ntpStatus</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get NTP synchronization status</li> <li>Response: <pre><code>{\n  \"status\": 0-2,\n  \"time\": \"2025-01-15T10:30:00Z\",\n  \"uptime\": 3600\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restntpsettings","title":"<code>/rest/ntpSettings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Get or update NTP settings</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"enabled\": true,\n  \"server\": \"pool.ntp.org\",\n  \"tz_label\": \"Europe/Berlin\",\n  \"tz_format\": \"CET-1CEST,M3.5.0,M10.5.0/3\"\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#resttime","title":"<code>/rest/time</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Get or manually set system time</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"time\": \"2025-01-15T10:30:00Z\"\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated time</p>"},{"location":"api/http-api/#mqtt-management","title":"MQTT Management","text":""},{"location":"api/http-api/#restmqttstatus","title":"<code>/rest/mqttStatus</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get MQTT client connection status</li> <li>Response: <pre><code>{\n  \"enabled\": true,\n  \"connected\": true,\n  \"client_id\": \"genius-gateway\",\n  \"disconnect_reason\": 0\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restmqttsettings","title":"<code>/rest/mqttSettings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Get or update MQTT client settings</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"enabled\": true,\n  \"host\": \"192.168.1.10\",\n  \"port\": 1883,\n  \"username\": \"mqtt_user\",\n  \"password\": \"mqtt_pass\",\n  \"client_id\": \"genius-gateway\",\n  \"keep_alive\": 60,\n  \"clean_session\": true,\n  \"max_topic_length\": 128,\n  \"uri\": \"mqtt://192.168.1.10:1883\"\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#system-management","title":"System Management","text":""},{"location":"api/http-api/#restsystemstatus","title":"<code>/rest/systemStatus</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get system information</li> <li>Response: <pre><code>{\n  \"esp_platform\": \"ESP32-S3\",\n  \"max_alloc_heap\": 4194304,\n  \"psram_size\": 8388608,\n  \"free_psram\": 6000000,\n  \"cpu_freq_mhz\": 240,\n  \"free_heap\": 200000,\n  \"sketch_size\": 1500000,\n  \"free_sketch_space\": 2500000,\n  \"flash_chip_size\": 4194304,\n  \"sdk_version\": \"v4.4.6\",\n  \"core_version\": \"2.0.14\"\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restrestart","title":"<code>/rest/restart</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Restart the ESP32 device</li> </ul> <p>Request: Empty body or <code>{}</code></p> <p>Response: 200 OK (device restarts immediately)</p>"},{"location":"api/http-api/#restsleep","title":"<code>/rest/sleep</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Put device into deep sleep mode</li> <li>Request: <pre><code>{\n  \"duration\": 3600,\n  \"wakeup_pin\": 0,\n  \"wakeup_signal\": 1\n}\n</code></pre></li> </ul> <p>Response: 200 OK (device enters sleep mode)</p>"},{"location":"api/http-api/#restfactoryreset","title":"<code>/rest/factoryReset</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Reset all settings to factory defaults</li> </ul> <p>Request: Empty body or <code>{}</code></p> <p>Response: 200 OK (device resets)</p>"},{"location":"api/http-api/#resthealth","title":"<code>/rest/health</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \u2705 Public</li> <li>Description: Health check endpoint for monitoring</li> </ul> <p>Response: </p><pre><code>{\n  \"status\": \"pass\"\n}\n</code></pre><p></p>"},{"location":"api/http-api/#restfeatures","title":"<code>/rest/features</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Get enabled feature flags</li> <li>Response: <pre><code>{\n  \"features\": {\n    \"allow_broadcast\": true,\n    \"cc1101_controller\": true\n  }\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restcoredump","title":"<code>/rest/coreDump</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Retrieve core dump information from last crash</li> </ul> <p>Response: Binary core dump data or JSON with error if no dump available</p>"},{"location":"api/http-api/#security-authentication","title":"Security &amp; Authentication","text":""},{"location":"api/http-api/#restsignin","title":"<code>/rest/signIn</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \u2705 Public</li> <li>Description: Authenticate and receive JWT token</li> <li>Request: <pre><code>{\n  \"username\": \"admin\",\n  \"password\": \"admin_password\"\n}\n</code></pre></li> <li>Response: <pre><code>{\n  \"access_token\": \"eyJhbGc...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre></li> </ul>"},{"location":"api/http-api/#restverifyauthorization","title":"<code>/rest/verifyAuthorization</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Verify current JWT token is valid</li> </ul> <p>Response: </p><pre><code>{\n  \"valid\": true\n}\n</code></pre> or 401 Unauthorized if invalid<p></p>"},{"location":"api/http-api/#restsecuritysettings","title":"<code>/rest/securitySettings</code>","text":"<ul> <li>Methods: GET, POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Get or update security settings (users, JWT secret)</li> </ul> <p>GET Response / POST Request: </p><pre><code>{\n  \"users\": [\n    {\n      \"username\": \"admin\",\n      \"password\": \"hashed_password\",\n      \"admin\": true\n    }\n  ],\n  \"jwt_secret\": \"random_secret_key\"\n}\n</code></pre><p></p> <p>POST Response: 200 OK with updated settings</p>"},{"location":"api/http-api/#restgeneratetoken","title":"<code>/rest/generateToken</code>","text":"<ul> <li>Method: GET</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Generate a new JWT secret token</li> </ul> <p>Response: </p><pre><code>{\n  \"token\": \"newly_generated_token_string\"\n}\n</code></pre><p></p>"},{"location":"api/http-api/#firmware-management","title":"Firmware Management","text":""},{"location":"api/http-api/#restuploadfirmware","title":"<code>/rest/uploadFirmware</code>","text":"<ul> <li>Method: POST (multipart/form-data)</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Upload new firmware binary for OTA update</li> </ul> <p>Request: Multipart form-data with firmware file in <code>firmware</code> field</p> <p>Response: </p><pre><code>{\n  \"success\": true\n}\n</code></pre><p></p>"},{"location":"api/http-api/#restdownloadupdate","title":"<code>/rest/downloadUpdate</code>","text":"<ul> <li>Method: POST</li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Download and install firmware update from URL</li> </ul> <p>Request: </p><pre><code>{\n  \"url\": \"https://example.com/firmware.bin\",\n  \"md5\": \"abc123...\"\n}\n</code></pre><p></p> <p>Response: </p><pre><code>{\n  \"success\": true\n}\n</code></pre><p></p>"},{"location":"api/mqtt-topics/","title":"MQTT Topics","text":""},{"location":"api/mqtt-topics/#mqtt-topics-documentation","title":"MQTT Topics Documentation","text":""},{"location":"api/mqtt-topics/#introduction","title":"Introduction","text":"<p>This document describes the MQTT topics published by the Genius Gateway. The gateway supports both Home Assistant auto-discovery  and custom MQTT topics for integration with other home automation systems connecting to a MQTT broker.</p>"},{"location":"api/mqtt-topics/#mqtt-configuration","title":"MQTT Configuration","text":"<p>MQTT functionality is mainly configured via web frontend or HTTP API endpoints:</p> <ul> <li>Framework MQTT Settings: <code>/rest/mqttSettings</code> - Basic MQTT connection settings</li> <li>Gateway MQTT Settings: <code>/rest/mqtt-settings</code> - Genius Gateway specific publishing options</li> </ul>"},{"location":"api/mqtt-topics/#framework-mqtt-topics-esp32-sveltekit","title":"Framework MQTT Topics (ESP32 SvelteKit)","text":""},{"location":"api/mqtt-topics/#device-status-topic-lwt","title":"Device Status Topic (LWT)","text":"<p> Topic </p><pre><code>genius-gateway/{device-mac}/status\n</code></pre><p></p> <p><code>device-mac</code> format</p> <p><code>device-mac</code> is the device's MAC address with lowercase hex digits and without any delimiters. E.g.: <code>1A:2B:3C:4D:5E:6F</code> <code>1a2b3c4d5e6f</code></p> <p> Description: Framework device online/offline status using MQTT Last Will and Testament (LWT)</p> <p> QoS: 1</p> <p> Retain: true</p> <p> Payloads</p> <p>Published when device connects to MQTT broker: </p><pre><code>\"online\"\n</code></pre><p></p> <p>Published automatically by broker when device disconnects (LWT message): </p><pre><code>\"offline\"\n</code></pre><p></p>"},{"location":"api/mqtt-topics/#genius-gateway-mqtt-topics","title":"Genius Gateway MQTT Topics","text":""},{"location":"api/mqtt-topics/#home-assistant-auto-discovery","title":"Home Assistant Auto-Discovery","text":"<p>The gateway supports Home Assistant's MQTT Discovery protocol  for automatic device integration.</p>"},{"location":"api/mqtt-topics/#configuration-topic","title":"Configuration Topic","text":"<p> Topic (Default) </p><pre><code>homeassistant/binary_sensor/genius-{smoke_detector_sn}/config\n</code></pre><p></p> <p> Description: Device configuration for Home Assistant auto-discovery</p> <p> QoS: 0</p> <p> Retain: true</p> <p> Payload </p><pre><code>{\n  \"~\": \"homeassistant/binary_sensor/genius-12345678\",\n  \"name\": \"Genius Plus X\",\n  \"unique_id\": \"12345678\",\n  \"device_class\": \"smoke\",\n  \"state_topic\": \"~/state\",\n  \"schema\": \"json\",\n  \"value_template\": \"{{value_json.state}}\",\n  \"entity_picture\": \"http://192.168.1.100/hekatron-genius-plus-x.png\",\n  \"device\": {\n    \"identifiers\": \"12345678\",\n    \"manufacturer\": \"Hekatron Vertriebs GmbH\",\n    \"model\": \"Genius Plus X\",\n    \"name\": \"Rauchmelder\",\n    \"serial_number\": \"12345678\",\n    \"suggested_area\": \"Living Room\"\n  }\n}\n</code></pre><p></p> <p> Payload Fields</p> <ul> <li><code>~</code> - Topic prefix (base path for relative references)</li> <li><code>name</code> - Entity name shown in Home Assistant</li> <li><code>unique_id</code> - Unique identifier (smoke detector serial number)</li> <li><code>device_class</code> - Device class (<code>smoke</code> for smoke detectors)</li> <li><code>state_topic</code> - Relative path to state topic (expands to <code>{prefix}{sn}/state</code>)</li> <li><code>schema</code> - Payload format (<code>json</code>)</li> <li><code>value_template</code> - Jinja2 template to extract state from JSON</li> <li><code>entity_picture</code> - URL to device icon (only included if gateway has valid IP)</li> <li><code>device</code> - Device information object</li> <li><code>identifiers</code> - Device identifier for grouping entities</li> <li><code>manufacturer</code> - Device manufacturer</li> <li><code>model</code> - Device model name</li> <li><code>name</code> - Device name</li> <li><code>serial_number</code> - Serial number</li> <li><code>suggested_area</code> - Suggested Home Assistant area/room</li> </ul> <p> Publishing Behavior</p> <ul> <li>Published when smoke detector is first created or imported</li> <li>Re-published when MQTT connection is established</li> <li>Re-published when MQTT settings change</li> <li>Published only if device publishing is enabled</li> </ul> <p> Home Assistant Integration</p> <ul> <li>Automatically creates binary sensor entity</li> <li>Adds icon and plenty of metadata (manufacturer, model, serial number, etc.)</li> <li>Can be used in automations and scenes</li> </ul>"},{"location":"api/mqtt-topics/#state-topic","title":"State Topic","text":"<p> Topic (Default) </p><pre><code>homeassistant/binary_sensor/genius-{smoke_detector_sn}/state\n</code></pre><p></p> <p> Description: Current alarm state of individual smoke detector</p> <p> QoS: 0</p> <p> Retain: true</p> <p> Payload</p> <p>Published when device is not alarming: </p><pre><code>{\n  \"state\": \"OFF\"\n}\n</code></pre> Published when device is alarming: <pre><code>{\n  \"state\": \"ON\"\n}\n</code></pre><p></p> <p> Payload Fields</p> <ul> <li><code>state</code> - Alarm state<ul> <li><code>\"OFF\"</code> - Smoke detector not alarming</li> <li><code>\"ON\"</code> - Smoke detector actively alarming</li> </ul> </li> </ul> <p> Publishing Behavior</p> <ul> <li>Published when device alarm state changes</li> <li>Re-published when MQTT connection is established</li> <li>Re-published when device configuration changes (location, etc.)</li> <li>Published only if device publishing is enabled</li> </ul> <p> Home Assistant Integration</p> <ul> <li>Automatically updates binary sensor entity</li> <li>Entity shows as \"Clear\" (OFF) or \"Smoke detected\" (ON)</li> <li>Can be used in automations and scenes</li> </ul>"},{"location":"api/mqtt-topics/#global-alarm-state-topic","title":"Global Alarm State Topic","text":"<p> Topic (Default) </p><pre><code>smarthome/genius-gateway/alarm\n</code></pre><p></p> <p> Description: Global alarm state aggregated from all smoke detectors</p> <p> QoS: 0</p> <p> Retain: true</p> <p> Payload:</p> <p>Published if all devices are in standby: </p><pre><code>{\n  \"isAlarming\": false,\n  \"numAlarmingDevices\": 0\n}\n</code></pre><p></p> <p>Published when two smoke detectors are alarming (example): </p><pre><code>{\n  \"isAlarming\": true,\n  \"numAlarmingDevices\": 2\n}\n</code></pre><p></p> <p> Payload Fields</p> <ul> <li><code>isAlarming</code> - Global alarm state (boolean)<ul> <li><code>true</code> - At least one smoke detector is alarming</li> <li><code>false</code> - No smoke detectors alarming</li> </ul> </li> <li><code>numAlarmingDevices</code> - Number of smoke detectors currently in alarm state (integer)</li> </ul> <p> Publishing Behavior</p> <ul> <li>Published whenever any device alarm state changes</li> <li>Re-published when MQTT connection is established</li> <li>Published only if simple alarm publishing is enabled</li> </ul> <p> Integration</p> <p>This topic enables integration with all smart home systems that support MQTT.</p>"},{"location":"api/websocket-api/","title":"WebSocket API","text":""},{"location":"api/websocket-api/#websocket-api-documentation","title":"WebSocket API Documentation","text":""},{"location":"api/websocket-api/#introduction","title":"Introduction","text":"<p>This document describes the WebSocket endpoints for the Genius Gateway. The gateway provides real-time bidirectional communication through WebSocket connections for event streaming and packet logging.</p>"},{"location":"api/websocket-api/#common-connection-requirements","title":"Common Connection Requirements","text":"<ul> <li>Protocol: WebSocket (ws:// or wss://)</li> <li>Authentication: Via JWT token (see Authorization Levels below)</li> </ul>"},{"location":"api/websocket-api/#authorization-levels","title":"Authorization Levels","text":"<ul> <li>\ud83d\udd12 User - Requires valid JWT token (event subscriptions, read operations)</li> <li>\ud83d\udee1\ufe0f Admin - Requires valid JWT token with admin privileges (system logs, configuration)</li> </ul>"},{"location":"api/websocket-api/#authentication","title":"Authentication","text":"<p>WebSocket connections can be authenticated by including the JWT token in:</p> <ol> <li>Query parameter: <code>?access_token=&lt;token&gt;</code></li> <li>WebSocket subprotocol: Send token in <code>Sec-WebSocket-Protocol</code> header</li> </ol>"},{"location":"api/websocket-api/#websocket-endpoints","title":"WebSocket Endpoints","text":""},{"location":"api/websocket-api/#overview","title":"Overview","text":"Endpoint Auth Description <code>/ws/events</code> \ud83d\udd12 Real-time event stream for system and application events <code>/ws/logger</code> \ud83d\udee1\ufe0f Real-time RF packet stream from CC1101 radio"},{"location":"api/websocket-api/#wsevents-event-stream","title":"<code>/ws/events</code> - Event Stream","text":""},{"location":"api/websocket-api/#connection-details","title":"Connection Details","text":"<ul> <li>URL: <code>/ws/events</code></li> <li>Auth: \ud83d\udd12 User</li> <li>Description: Subscribe to real-time system and application events. Clients can subscribe to specific event types and receive JSON-formatted event notifications.</li> </ul>"},{"location":"api/websocket-api/#connection-flow","title":"Connection Flow","text":"<ol> <li>Connect - Establish WebSocket connection with authentication</li> <li>Subscribe - Send subscription message for desired events</li> <li>Receive - Get real-time event notifications as JSON</li> <li>Unsubscribe - Optionally unsubscribe from events</li> <li>Disconnect - Close connection when done</li> </ol>"},{"location":"api/websocket-api/#message-format","title":"Message Format","text":""},{"location":"api/websocket-api/#subscribe-to-event","title":"Subscribe to Event","text":"<pre><code>{\n  \"event\": \"subscribe\",\n  \"data\": {\n    \"id\": \"event-name\"\n  }\n}\n</code></pre>"},{"location":"api/websocket-api/#unsubscribe-from-event","title":"Unsubscribe from Event","text":"<pre><code>{\n  \"event\": \"unsubscribe\",\n  \"data\": {\n    \"id\": \"event-name\"\n  }\n}\n</code></pre>"},{"location":"api/websocket-api/#event-notification-server-client","title":"Event Notification (Server \u2192 Client)","text":"<pre><code>{\n  \"event\": \"event-name\",\n  \"data\": {\n    // Event-specific data\n  }\n}\n</code></pre>"},{"location":"api/websocket-api/#framework-events-esp32-sveltekit","title":"Framework Events (ESP32 SvelteKit)","text":""},{"location":"api/websocket-api/#rssi","title":"<code>rssi</code>","text":"<p>WiFi signal strength updates</p> <p>Update Frequency: Every 500ms when connected</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"rssi\",\n  \"data\": {\n    \"rssi\": -45\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>rssi</code> - Signal strength in dBm (negative integer)</li> </ul>"},{"location":"api/websocket-api/#reconnect","title":"<code>reconnect</code>","text":"<p>WiFi reconnection notifications</p> <p>Trigger: WiFi connection attempt</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"reconnect\",\n  \"data\": {}\n}\n</code></pre><p></p>"},{"location":"api/websocket-api/#system_health","title":"<code>system_health</code>","text":"<p>System health metrics and resource usage</p> <p>Update Frequency: Every 5 seconds</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"system_health\",\n  \"data\": {\n    \"free_heap\": 200000,\n    \"max_alloc_heap\": 150000,\n    \"min_free_heap\": 180000,\n    \"psram_size\": 8388608,\n    \"free_psram\": 6000000,\n    \"cpu_temp\": 45.2,\n    \"uptime\": 3600\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>free_heap</code> - Current free heap memory (bytes)</li> <li><code>max_alloc_heap</code> - Largest allocatable block (bytes)</li> <li><code>min_free_heap</code> - Minimum free heap since boot (bytes)</li> <li><code>psram_size</code> - Total PSRAM size (bytes)</li> <li><code>free_psram</code> - Available PSRAM (bytes)</li> <li><code>cpu_temp</code> - CPU temperature (\u00b0C, if available)</li> <li><code>uptime</code> - System uptime (seconds)</li> </ul>"},{"location":"api/websocket-api/#notification","title":"<code>notification</code>","text":"<p>System notifications and alerts</p> <p>Trigger: Various system events</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"notification\",\n  \"data\": {\n    \"type\": \"info\",\n    \"message\": \"Notification message\",\n    \"timestamp\": \"2025-01-15T10:30:00Z\"\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>type</code> - Notification type: <code>info</code>, <code>warning</code>, <code>error</code>, <code>success</code></li> <li><code>message</code> - Notification text</li> <li><code>timestamp</code> - ISO 8601 timestamp</li> </ul>"},{"location":"api/websocket-api/#features","title":"<code>features</code>","text":"<p>Feature flag updates</p> <p>Trigger: Feature configuration changes</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"features\",\n  \"data\": {\n    \"features\": {\n      \"allow_broadcast\": true,\n      \"cc1101_controller\": true,\n      \"battery_monitoring\": false\n    }\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>features</code> - Object containing feature name/enabled pairs</li> </ul>"},{"location":"api/websocket-api/#otastatus","title":"<code>otastatus</code>","text":"<p>OTA firmware update progress</p> <p>Trigger: During firmware download and installation</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"otastatus\",\n  \"data\": {\n    \"status\": \"downloading\",\n    \"progress\": 45,\n    \"message\": \"Downloading firmware...\"\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>status</code> - Update status: <code>idle</code>, <code>downloading</code>, <code>installing</code>, <code>success</code>, <code>error</code></li> <li><code>progress</code> - Progress percentage (0-100)</li> <li><code>message</code> - Human-readable status message</li> </ul>"},{"location":"api/websocket-api/#battery","title":"<code>battery</code>","text":"<p>Battery status updates (if battery monitoring enabled)</p> <p>Update Frequency: Variable based on configuration</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"battery\",\n  \"data\": {\n    \"voltage\": 3.7,\n    \"percentage\": 85,\n    \"charging\": false\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>voltage</code> - Battery voltage (V)</li> <li><code>percentage</code> - Battery level (0-100)</li> <li><code>charging</code> - Charging status (boolean)</li> </ul>"},{"location":"api/websocket-api/#analytics","title":"<code>analytics</code>","text":"<p>System analytics data (if analytics enabled)</p> <p>Update Frequency: Periodic based on configuration</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"analytics\",\n  \"data\": {\n    // Analytics-specific data\n  }\n}\n</code></pre><p></p>"},{"location":"api/websocket-api/#genius-gateway-events","title":"Genius Gateway Events","text":""},{"location":"api/websocket-api/#alarm","title":"<code>alarm</code>","text":"<p>Global alarm state notifications</p> <p>Trigger: Any smoke detector enters or exits alarm state</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"alarm\",\n  \"data\": {\n    \"isAlarming\": true,\n    \"numAlarmingDevices\": 2,\n    \"alarmingDevices\": [\n      {\n        \"smokeDetectorSN\": 12345678,\n        \"location\": \"Living Room\",\n        \"startTime\": \"2025-01-15T10:30:00Z\"\n      }\n    ]\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>isAlarming</code> - Global alarm state (boolean)</li> <li><code>numAlarmingDevices</code> - Number of devices currently alarming</li> <li><code>alarmingDevices</code> - Array of alarming device details</li> <li><code>smokeDetectorSN</code> - Smoke detector serial number</li> <li><code>location</code> - Device location string</li> <li><code>startTime</code> - Alarm start timestamp (ISO 8601)</li> </ul>"},{"location":"api/websocket-api/#alarm-state-change","title":"<code>alarm-state-change</code>","text":"<p>Individual device alarm state changes</p> <p>Trigger: Specific smoke detector alarm state changes</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"alarm-state-change\",\n  \"data\": {\n    \"smokeDetectorSN\": 12345678,\n    \"isAlarming\": true,\n    \"location\": \"Living Room\",\n    \"startTime\": \"2025-01-15T10:30:00Z\"\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>smokeDetectorSN</code> - Smoke detector serial number</li> <li><code>isAlarming</code> - Current alarm state (boolean)</li> <li><code>location</code> - Device location</li> <li><code>startTime</code> - Alarm start time (ISO 8601, if alarming)</li> <li><code>endTime</code> - Alarm end time (ISO 8601, if ended)</li> <li><code>endingReason</code> - How alarm ended (0=detector, 1=manual)</li> </ul>"},{"location":"api/websocket-api/#genius-device-added-from-packet","title":"<code>genius-device-added-from-packet</code>","text":"<p>New smoke detector auto-discovered</p> <p>Trigger: New device detected from RF packet</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"genius-device-added-from-packet\",\n  \"data\": {\n    \"smokeDetectorSN\": 12345678,\n    \"radioModuleSN\": 87654321,\n    \"location\": \"Unknown location\"\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>smokeDetectorSN</code> - Smoke detector serial number</li> <li><code>radioModuleSN</code> - Radio module serial number</li> <li><code>location</code> - Initial location (typically \"Unknown location\")</li> </ul>"},{"location":"api/websocket-api/#new-alarm-line","title":"<code>new-alarm-line</code>","text":"<p>New alarm line discovered</p> <p>Trigger: New alarm line detected from RF communication</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"new-alarm-line\",\n  \"data\": {\n    \"id\": 123456789,\n    \"name\": \"Alarm Line 123456789\",\n    \"created\": \"2025-01-15T10:30:00Z\",\n    \"acquisition\": 1\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>id</code> - Unique 32-bit alarm line ID</li> <li><code>name</code> - Auto-generated or user-defined name</li> <li><code>created</code> - Discovery timestamp (ISO 8601)</li> <li><code>acquisition</code> - How line was added (0=built-in, 1=packet, 2=manual)</li> </ul>"},{"location":"api/websocket-api/#alarm-line-action-finished","title":"<code>alarm-line-action-finished</code>","text":"<p>Alarm line action completion</p> <p>Trigger: Line test or fire alarm transmission completed</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"alarm-line-action-finished\",\n  \"data\": {\n    \"alarmLineId\": 123456789,\n    \"action\": \"linetest\",\n    \"success\": true,\n    \"transmissionTime\": 10.5\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>alarmLineId</code> - Alarm line ID</li> <li><code>action</code> - Action type: <code>linetest</code>, <code>firealarm</code></li> <li><code>success</code> - Action completion status (boolean)</li> <li><code>transmissionTime</code> - Duration in seconds</li> </ul>"},{"location":"api/websocket-api/#rem-alarm-block-time","title":"<code>rem-alarm-block-time</code>","text":"<p>Remaining alarm blocking time updates</p> <p>Trigger: Alarm blocking active, updates every second</p> <p>Data Format: </p><pre><code>{\n  \"event\": \"rem-alarm-block-time\",\n  \"data\": {\n    \"isBlocked\": true,\n    \"remainingBlockingTimeS\": 285\n  }\n}\n</code></pre><p></p> <p>Fields:</p> <ul> <li><code>isBlocked</code> - Current blocking state (boolean)</li> <li><code>remainingBlockingTimeS</code> - Seconds remaining until blocking ends</li> </ul>"},{"location":"api/websocket-api/#error-handling","title":"Error Handling","text":"<p>Connection Errors: - 401 Unauthorized - Invalid or missing JWT token - 403 Forbidden - Insufficient user privileges</p> <p>Event Subscription Errors: - Invalid event names are silently ignored - Invalid subscription message format is silently ignored - Subscribe only to valid event names listed in the Framework Events and Genius Gateway Events sections</p>"},{"location":"api/websocket-api/#best-practices","title":"Best Practices","text":"<ol> <li>Selective Subscription - Subscribe only to events you need to minimize bandwidth usage</li> <li>High-Frequency Events - Be prepared to handle frequent updates from <code>rssi</code> (every 500ms) and <code>system_health</code> (every 5s)</li> <li>Reconnection Strategy - Implement automatic reconnection with exponential backoff (start at 1s, max 30s)</li> <li>Resubscribe on Reconnect - Store subscriptions and resubscribe after reconnection</li> <li>Message Buffering - Consider buffering rapid events like <code>rssi</code> for display updates</li> <li>Resource Cleanup - Unsubscribe from events before closing connection</li> <li>Error Recovery - Handle JSON parse errors gracefully in case of malformed messages</li> </ol>"},{"location":"api/websocket-api/#connection-examples","title":"Connection Examples","text":""},{"location":"api/websocket-api/#javascript-browser","title":"JavaScript (Browser)","text":"<pre><code>const eventsWs = new WebSocket('ws://gateway.local/ws/events?access_token=' + token);\n\neventsWs.onopen = () =&gt; {\n  console.log('Connected to events stream');\n\n  // Subscribe to multiple events\n  ['alarm', 'alarm-state-change', 'system_health'].forEach(eventName =&gt; {\n    eventsWs.send(JSON.stringify({\n      event: 'subscribe',\n      data: { id: eventName }\n    }));\n  });\n};\n\neventsWs.onmessage = (event) =&gt; {\n  const msg = JSON.parse(event.data);\n  console.log('Event:', msg.event, 'Data:', msg.data);\n\n  // Handle specific events\n  switch(msg.event) {\n    case 'alarm':\n      handleAlarm(msg.data);\n      break;\n    case 'system_health':\n      updateHealthDisplay(msg.data);\n      break;\n  }\n};\n\neventsWs.onerror = (error) =&gt; {\n  console.error('WebSocket error:', error);\n};\n\neventsWs.onclose = () =&gt; {\n  console.log('Disconnected, reconnecting...');\n  setTimeout(() =&gt; connectEvents(), 5000);\n};\n</code></pre>"},{"location":"api/websocket-api/#python","title":"Python","text":"<pre><code>import websocket\nimport json\nimport time\n\nclass EventsClient:\n    def __init__(self, token):\n        self.token = token\n        self.subscriptions = ['alarm', 'alarm-state-change', 'system_health']\n        self.ws = None\n\n    def on_open(self, ws):\n        print('Connected to events stream')\n        # Subscribe to events\n        for event_name in self.subscriptions:\n            ws.send(json.dumps({\n                'event': 'subscribe',\n                'data': {'id': event_name}\n            }))\n\n    def on_message(self, ws, message):\n        msg = json.loads(message)\n        print(f\"Event: {msg['event']}, Data: {msg['data']}\")\n\n        # Handle specific events\n        if msg['event'] == 'alarm':\n            self.handle_alarm(msg['data'])\n        elif msg['event'] == 'system_health':\n            self.update_health(msg['data'])\n\n    def on_error(self, ws, error):\n        print(f'Error: {error}')\n\n    def on_close(self, ws, close_status_code, close_msg):\n        print('Disconnected, reconnecting...')\n        time.sleep(5)\n        self.connect()\n\n    def connect(self):\n        self.ws = websocket.WebSocketApp(\n            f\"ws://gateway.local/ws/events?access_token={self.token}\",\n            on_open=self.on_open,\n            on_message=self.on_message,\n            on_error=self.on_error,\n            on_close=self.on_close\n        )\n        self.ws.run_forever()\n\n    def handle_alarm(self, data):\n        if data.get('isAlarming'):\n            print(f\"ALARM! {data['numAlarmingDevices']} device(s) alarming\")\n\n    def update_health(self, data):\n        print(f\"Free heap: {data['free_heap']} bytes\")\n\n# Usage\nclient = EventsClient(token='your_jwt_token')\nclient.connect()\n</code></pre>"},{"location":"api/websocket-api/#nodejs","title":"Node.js","text":"<pre><code>const WebSocket = require('ws');\n\nclass EventsClient {\n  constructor(token) {\n    this.token = token;\n    this.subscriptions = ['alarm', 'alarm-state-change', 'system_health'];\n    this.reconnectDelay = 1000;\n    this.maxReconnectDelay = 30000;\n  }\n\n  connect() {\n    this.ws = new WebSocket(`ws://gateway.local/ws/events?access_token=${this.token}`);\n\n    this.ws.on('open', () =&gt; {\n      console.log('Connected to events stream');\n      this.reconnectDelay = 1000; // Reset backoff\n\n      // Subscribe to events\n      this.subscriptions.forEach(eventName =&gt; {\n        this.ws.send(JSON.stringify({\n          event: 'subscribe',\n          data: { id: eventName }\n        }));\n      });\n    });\n\n    this.ws.on('message', (data) =&gt; {\n      const msg = JSON.parse(data);\n      console.log('Event:', msg.event, 'Data:', msg.data);\n    });\n\n    this.ws.on('close', () =&gt; {\n      console.log(`Disconnected, reconnecting in ${this.reconnectDelay}ms...`);\n      setTimeout(() =&gt; this.connect(), this.reconnectDelay);\n      this.reconnectDelay = Math.min(this.reconnectDelay * 2, this.maxReconnectDelay);\n    });\n\n    this.ws.on('error', (error) =&gt; {\n      console.error('WebSocket error:', error);\n    });\n  }\n}\n\nconst client = new EventsClient('your_jwt_token');\nclient.connect();\n</code></pre>"},{"location":"api/websocket-api/#wslogger-packet-stream","title":"<code>/ws/logger</code> - Packet Stream","text":""},{"location":"api/websocket-api/#connection-details_1","title":"Connection Details","text":"<ul> <li>URL: <code>/ws/logger</code></li> <li>Auth: \ud83d\udee1\ufe0f Admin</li> <li>Description: Real-time binary stream of RF packets received by the CC1101 radio transceiver. Provides raw packet data for debugging, analysis, and visualization.</li> </ul>"},{"location":"api/websocket-api/#connection-flow_1","title":"Connection Flow","text":"<ol> <li>Connect - Establish WebSocket connection with admin authentication</li> <li>Receive ID - Server sends unique client ID</li> <li>Stream - Receive binary packet data continuously</li> <li>Disconnect - Close connection when done</li> </ol>"},{"location":"api/websocket-api/#message-format_1","title":"Message Format","text":""},{"location":"api/websocket-api/#client-id-server-client-on-connect","title":"Client ID (Server \u2192 Client, on connect)","text":"<pre><code>{\n  \"clientId\": \"wslogger:12345\"\n}\n</code></pre>"},{"location":"api/websocket-api/#packet-data-server-client-binary","title":"Packet Data (Server \u2192 Client, binary)","text":"<p>Format: Binary data structure (<code>cc1101_packet_t</code>)</p> <p>Structure: </p><pre><code>struct cc1101_packet {\n    uint64_t timestamp;           // Packet reception timestamp (\u00b5s since boot)\n    uint8_t buffer[64];           // Raw CC1101 RX FIFO content\n    uint8_t* data;                // Pointer to actual packet data\n    size_t length;                // Packet data length (bytes)\n}\n</code></pre><p></p> <p>Buffer Contents:</p> <ul> <li>First byte: Packet length</li> <li>Next N (Packt length) bytes: Packet data</li> <li>Last 2 bytes: Status (RSSI, LQI / CRC)</li> </ul> <p>Binary Stream Details:</p> <ul> <li>Type: <code>HTTPD_WS_TYPE_BINARY</code></li> <li>Size: 80 bytes per packet (fixed structure size)</li> <li>Frequency: Real-time as packets are received</li> </ul> <p>For further details, also see WebSocket Logging Interface.</p>"},{"location":"api/websocket-api/#usage-notes","title":"Usage Notes","text":"<ul> <li>Only available when WebSocket logger is enabled (via <code>/rest/wslogger</code> or web frontend)</li> <li>Connection filter checks admin authentication</li> <li>Multiple clients can connect simultaneously</li> <li>Each client receives all packets (broadcast)</li> <li>Binary format requires client-side parsing</li> <li>Timestamp is in microseconds since device boot</li> </ul>"},{"location":"api/websocket-api/#error-handling_1","title":"Error Handling","text":"<p>Connection Errors: - 401 Unauthorized - Invalid or missing JWT token - 403 Forbidden - Insufficient admin privileges - 503 Service Unavailable - WebSocket logger disabled via <code>/rest/wslogger</code> settings</p> <p>Stream Errors: - Connection drops if logger is disabled during active session - Binary data parsing errors if client expects wrong packet format - Verify logger is enabled before connecting: <code>GET /rest/wslogger</code></p>"},{"location":"api/websocket-api/#best-practices_1","title":"Best Practices","text":"<ol> <li>Check Logger Status - Verify logger is enabled via <code>/rest/wslogger</code> before connecting</li> <li>Binary Type Setting - Always set <code>ws.binaryType = 'arraybuffer'</code> or <code>'blob'</code> for proper binary handling</li> <li>Efficient Parsing - Use DataView for efficient binary data access</li> <li>High Data Rate - Prepare for high packet rates during active RF communication</li> <li>Buffer Management - Implement packet buffering if processing is slower than arrival rate</li> <li>Reconnection Strategy - Implement exponential backoff reconnection (start at 1s, max 30s)</li> <li>Resource Management - Close connection when not actively monitoring to reduce server load</li> <li>Timestamp Handling - Timestamps are microseconds since boot, convert to absolute time if needed</li> </ol>"},{"location":"api/websocket-api/#connection-examples_1","title":"Connection Examples","text":""},{"location":"api/websocket-api/#javascript-browser_1","title":"JavaScript (Browser)","text":"<pre><code>const loggerWs = new WebSocket('ws://gateway.local/ws/logger?access_token=' + token);\nloggerWs.binaryType = 'arraybuffer';\n\nloggerWs.onopen = () =&gt; {\n  console.log('Connected to packet logger');\n};\n\nloggerWs.onmessage = (event) =&gt; {\n  if (typeof event.data === 'string') {\n    // Client ID message\n    const msg = JSON.parse(event.data);\n    console.log('Client ID:', msg.clientId);\n  } else {\n    // Binary packet data (cc1101_packet_t structure)\n    const view = new DataView(event.data);\n\n    // Parse structure fields\n    const timestamp = view.getBigUint64(0, true); // Little endian\n\n    // Buffer starts at offset 8, first byte is length\n    const length = view.getUint8(8);\n\n    // Extract packet data (starts at buffer[1])\n    const packetData = new Uint8Array(event.data, 9, length);\n\n    // Last 2 bytes of buffer are RSSI and LQI\n    const rssi = view.getInt8(8 + length + 1);\n    const lqi = view.getUint8(8 + length + 2);\n\n    console.log('Packet:', {\n      timestamp: timestamp,\n      length: length,\n      data: Array.from(packetData).map(b =&gt; b.toString(16).padStart(2, '0')).join(' '),\n      rssi: rssi,\n      lqi: lqi &amp; 0x7F,\n      crc_ok: (lqi &amp; 0x80) !== 0\n    });\n  }\n};\n\nloggerWs.onerror = (error) =&gt; {\n  console.error('WebSocket error:', error);\n};\n\nloggerWs.onclose = () =&gt; {\n  console.log('Logger disconnected');\n};\n</code></pre>"},{"location":"api/websocket-api/#python_1","title":"Python","text":"<pre><code>import websocket\nimport struct\nimport json\n\nclass PacketLoggerClient:\n    def __init__(self, token):\n        self.token = token\n        self.ws = None\n\n    def on_open(self, ws):\n        print('Connected to packet logger')\n\n    def on_message(self, ws, message):\n        if isinstance(message, str):\n            # Client ID message\n            msg = json.loads(message)\n            print(f\"Client ID: {msg['clientId']}\")\n        else:\n            # Binary packet data\n            # Parse cc1101_packet_t structure\n            timestamp = struct.unpack('&lt;Q', message[0:8])[0]  # uint64_t little endian\n\n            # Buffer starts at offset 8\n            length = message[8]  # First byte is length\n            packet_data = message[9:9+length]\n\n            # RSSI and LQI are last 2 bytes\n            rssi = struct.unpack('b', bytes([message[8 + length + 1]]))[0]  # signed\n            lqi_byte = message[8 + length + 2]\n            lqi = lqi_byte &amp; 0x7F\n            crc_ok = (lqi_byte &amp; 0x80) != 0\n\n            print(f\"Packet: timestamp={timestamp}\u00b5s, len={length}, \"\n                  f\"data={packet_data.hex()}, rssi={rssi}dBm, \"\n                  f\"lqi={lqi}, crc={crc_ok}\")\n\n    def on_error(self, ws, error):\n        print(f'Error: {error}')\n\n    def on_close(self, ws, close_status_code, close_msg):\n        print('Logger disconnected')\n\n    def connect(self):\n        self.ws = websocket.WebSocketApp(\n            f\"ws://gateway.local/ws/logger?access_token={self.token}\",\n            on_open=self.on_open,\n            on_message=self.on_message,\n            on_error=self.on_error,\n            on_close=self.on_close\n        )\n        self.ws.run_forever()\n\n# Usage\nclient = PacketLoggerClient(token='your_jwt_token')\nclient.connect()\n</code></pre>"},{"location":"api/websocket-api/#nodejs_1","title":"Node.js","text":"<pre><code>const WebSocket = require('ws');\n\nclass PacketLoggerClient {\n  constructor(token) {\n    this.token = token;\n  }\n\n  connect() {\n    this.ws = new WebSocket(`ws://gateway.local/ws/logger?access_token=${this.token}`);\n    this.ws.binaryType = 'arraybuffer';\n\n    this.ws.on('open', () =&gt; {\n      console.log('Connected to packet logger');\n    });\n\n    this.ws.on('message', (data) =&gt; {\n      if (typeof data === 'string') {\n        // Client ID message\n        const msg = JSON.parse(data);\n        console.log('Client ID:', msg.clientId);\n      } else {\n        // Binary packet data\n        const buffer = Buffer.from(data);\n\n        // Parse cc1101_packet_t structure\n        const timestamp = buffer.readBigUInt64LE(0);\n        const length = buffer.readUInt8(8);\n        const packetData = buffer.slice(9, 9 + length);\n        const rssi = buffer.readInt8(8 + length + 1);\n        const lqiByte = buffer.readUInt8(8 + length + 2);\n        const lqi = lqiByte &amp; 0x7F;\n        const crcOk = (lqiByte &amp; 0x80) !== 0;\n\n        console.log('Packet:', {\n          timestamp: timestamp.toString(),\n          length: length,\n          data: packetData.toString('hex'),\n          rssi: rssi,\n          lqi: lqi,\n          crc_ok: crcOk\n        });\n      }\n    });\n\n    this.ws.on('error', (error) =&gt; {\n      console.error('WebSocket error:', error);\n    });\n\n    this.ws.on('close', () =&gt; {\n      console.log('Logger disconnected');\n    });\n  }\n}\n\nconst client = new PacketLoggerClient('your_jwt_token');\nclient.connect();\n</code></pre>"},{"location":"features/","title":"Gateway Features","text":""},{"location":"features/#gateway-features","title":"Gateway Features","text":"<p>This section covers all operational features of Genius Gateway, from basic monitoring and device management to advanced protocol analysis and smart home integration.</p> Feature Description System Overview Main monitoring interface with visual status cards for all registered smoke detectors Gateway Settings Control automatic detection and processing of unknown devices and alarm lines Device Management Configure and monitor smoke detectors with location assignment and alarm history Packet Visualizer Real-time RF packet monitoring with decoding and filtering for protocol analysis Alarm Lines Management Configure alarm lines and trigger remote line tests and fire alarm tests WebSocket Logging Interface External logging interface for development and debugging via WebSocket connection Smart Home Integration Simple alarm notifications or full Home Assistant integration capabilities"},{"location":"features/alarm-lines-management/","title":"Alarm Lines Management","text":""},{"location":"features/alarm-lines-management/#alarm-lines-management","title":"Alarm Lines Management","text":"<p>The Alarm Lines Management page provides a centralized interface for configuring and managing alarm lines in your Genius system. Alarm lines represent logical groupings of smoke detectors that communicate using the same radio ID, enabling coordinated alarm behavior across connected devices. This page allows you to add, edit, delete, and test alarm lines, as well as manage configurations via export/import functionality.</p> <p></p> <p>Access Requirements</p> <p>Alarm Lines Management is only accessible to users with administrator privileges.</p>"},{"location":"features/alarm-lines-management/#understanding-alarm-lines","title":"Understanding Alarm Lines","text":"<p>In Genius smoke detector systems, an alarm line is a communication channel identified by a unique numeric ID (<code>1</code> to <code>4294967294</code>). All smoke detectors configured for the same alarm line ID will:</p> <ul> <li>Receive and relay alarm signals from any detector on that line</li> <li>Trigger coordinated alarm responses (sirens activate simultaneously)</li> <li>Participate in line tests and system diagnostics</li> </ul> <p>Each alarm line in your system must be registered in the gateway to enable proper monitoring and control.</p>"},{"location":"features/alarm-lines-management/#alarm-lines-list-overview","title":"Alarm Lines List Overview","text":"<p>The alarm lines table displays all registered alarm lines with the following columns:</p>"},{"location":"features/alarm-lines-management/#id","title":"ID","text":"<p>The unique numeric identifier for the alarm line (1-4294967294). This ID must match the configuration in your smoke detectors for proper communication.</p>"},{"location":"features/alarm-lines-management/#name","title":"Name","text":"<p>A descriptive label for the alarm line (e.g., \"First Floor\", \"Building A\"). This helps identify the line in the interface and notifications.</p>"},{"location":"features/alarm-lines-management/#registered","title":"Registered","text":"<p>The date and time when the alarm line was first added to the gateway, displayed in DD.MM.YYYY HH:MM:SS format.</p>"},{"location":"features/alarm-lines-management/#acquisition","title":"Acquisition","text":"<p>Indicates how the alarm line was added to the system:</p> <ul> <li> Manual: Alarm line was manually configured by an administrator</li> <li> Automatic: Alarm line was automatically registered when the gateway received a Genius packet with a new alarm line ID</li> </ul>"},{"location":"features/alarm-lines-management/#manage","title":"Manage","text":"<p>Action buttons for alarm line operations (described in detail below).</p>"},{"location":"features/alarm-lines-management/#initial-setup","title":"Initial Setup","text":"<p>When you first access the Alarm Lines Management page with no alarm lines configured, you'll see a helpful message:</p> <p>No alarm lines registered yet.</p> <p>Click the \"+\" button to manually add an alarm line or start the commissioning procedure of your smoke detectors.</p> <p>You can proceed to add a new alarm line by either:</p> <ol> <li>Manual Registration: Explicitly add alarm line IDs you've configured in your smoke detectors (recommended for planned installations)</li> <li>Automatic Discovery: Enable automatic alarm line registration in Gateway Settings, then trigger any smoke detector\u2014the gateway will automatically register the alarm line when it receives the packet</li> </ol>"},{"location":"features/alarm-lines-management/#adding-a-new-alarm-line","title":"Adding a New Alarm Line","text":""},{"location":"features/alarm-lines-management/#manually-registering-a-new-alarm-line","title":"Manually Registering a New Alarm Line","text":"<p>For Advanced Users Only</p> <p>Manual alarm line registration is only recommended for experienced and knowledgeable users and should only be performed for testing and development purposes. The alarm line ID must be known or determined beforehand.</p> <p>When using Genius Gateway to integrate an existing Genius smoke detector network into a home automation system, packet-based automatic discovery of existing alarm lines should always be preferred.</p> <p>To manually register a new alarm line:</p> <ol> <li>Click the  Add alarm line button in the top-right corner</li> <li> <p>The \"Add alarm line\" dialog opens with empty fields</p> <p></p> </li> <li> <p>Configure the alarm line as follows:</p> <p>ID Enter the alarm line ID (<code>1 - 4294967294</code>) that matches the configuration in your smoke detectors. This ID must be unique\u2014the gateway will display an error if you attempt to register an ID that already exists.</p> <p>ID Validation</p> <ul> <li>The ID must be between <code>1</code> and <code>4294967294</code></li> <li>The ID must not already exist in your alarm lines list</li> <li>The ID must match the alarm line configuration in your physical smoke detectors</li> </ul> <p>Name Enter a descriptive name (1-100 characters) to identify this alarm line. Use meaningful names like \"First Floor\", \"East Wing\", or \"Building A - Zone 1\" to help distinguish between multiple alarm lines.</p> </li> <li> <p>Click Save to register the alarm line</p> </li> </ol> <p>The new alarm line will immediately appear in the table and is ready to receive and process alarm packets.</p>"},{"location":"features/alarm-lines-management/#automatic-alarm-line-discovery","title":"Automatic Alarm Line Discovery","text":"<p>When automatic alarm line registration is enabled in Gateway Settings, the gateway will automatically create new alarm line entries when it receives Genius packets with previously unknown alarm line IDs.</p> <p>Discovery Process:</p> <ol> <li>A smoke detector transmits a packet (alarm, line test, or status)</li> <li>The gateway extracts the alarm line ID from the received packet</li> <li>If the ID is not registered, the gateway automatically creates a new entry with:<ul> <li>ID: Extracted from the packet</li> <li>Name: Auto-generated as \"Alarm Line [ID]\"</li> <li>Acquisition: Marked as \"Automatic\" ()</li> </ul> </li> <li>A success notification appears: \"New alarm line detected.\"</li> </ol> <p>You can later edit automatically discovered alarm lines to assign meaningful names.</p> <p>Discover during Commissioning</p> <p>Enable automatic registration during smoke detector commissioning to quickly discover the alarm line that is currently set up in a commissioning process. After commissioning, assign meaningful names to each discovered line.</p>"},{"location":"features/alarm-lines-management/#editing-an-alarm-line","title":"Editing an Alarm Line","text":"<p>To modify an existing alarm line:</p> <ol> <li>Click the  Edit alarm line button in the alarm line's row</li> <li> <p>The \"Edit alarm line\" dialog opens with current values</p> <p></p> </li> <li> <p>Modify the ID and/or Name fields as needed</p> <p>Changing the ID</p> <p>If you change an alarm line's ID, ensure your physical smoke detectors are reconfigured to match. Mismatched IDs will prevent proper alarm communication.</p> </li> <li> <p>Click Save to apply changes</p> </li> </ol>"},{"location":"features/alarm-lines-management/#deleting-an-alarm-line","title":"Deleting an Alarm Line","text":"<p>To remove an alarm line from the system:</p> <ol> <li>Click the  Delete alarm line button in the alarm line's row</li> <li>A confirmation dialog appears asking you to verify the deletion</li> <li>Click Yes to permanently remove the alarm line</li> </ol> <p>Consequences</p> <p>Deleting an alarm line does not affect the physical smoke detector configuration \u2014 devices will continue operating on their configured alarm line ID.</p>"},{"location":"features/alarm-lines-management/#import-and-export","title":"Import and Export","text":""},{"location":"features/alarm-lines-management/#exporting-alarm-lines-to-file","title":"Exporting Alarm Lines to File","text":"<p>To save your current alarm lines configuration:</p> <ol> <li>Click the  Save alarm lines to file button in the top-right corner</li> <li>Rename and save the file to the desired location</li> </ol> <p>This file contains all alarm line configurations and can be used for backup or migration to another gateway.</p>"},{"location":"features/alarm-lines-management/#importing-alarm-lines-from-file","title":"Importing Alarm Lines from File","text":"<p>Import Replaces All Alarm Lines</p> <p>Importing alarm lines replaces the current configuration entirely. All existing alarm lines will be overwritten with the imported data.</p> <p>To restore alarm lines from a previously exported file:</p> <ol> <li>Click the  Load alarm lines from file button in the top-right corner</li> <li>Select a valid alarm lines file from your computer</li> <li>The gateway validates and imports the configuration</li> <li>All existing alarm lines are replaced with the imported ones</li> </ol>"},{"location":"features/alarm-lines-management/#alarm-line-actions","title":"Alarm Line Actions","text":"<p>Each alarm line supports several test and diagnostic actions. These actions transmit RF commands to all smoke detectors configured for that alarm line.</p> <p>Action Behavior</p> <ul> <li>Only one action can be triggered at a time across all alarm lines</li> <li>While the Genius Gateway is actively transmitting RF packets for the triggered action, a spinner icon is shown </li> </ul>"},{"location":"features/alarm-lines-management/#start-line-test","title":"Start Line Test","text":"<p>Initiates a line test on the selected alarm line. This command triggers all smoke detectors on the line to perform a coordinated test sequence.</p> <ol> <li>Click the  Start line test button</li> <li>A confirmation dialog appears</li> <li>Click Yes to proceed</li> <li>The gateway transmits the appropriate commands repetitively via RF</li> <li>The button displays a spinner while RF transmission is in progress</li> </ol>"},{"location":"features/alarm-lines-management/#stop-line-test","title":"Stop Line Test","text":"<p>Stops an active line test on the selected alarm line.</p> <ol> <li>Click the  Stop line test button</li> <li>The gateway immediately transmits the appropriate commands repetitively via RF</li> <li>The button displays a spinner while RF transmission is in progress</li> </ol>"},{"location":"features/alarm-lines-management/#trigger-fire-alarm","title":"Trigger Fire Alarm","text":"<p>Manually triggers a fire alarm on the selected alarm line. This activates all smoke detectors on the line as if smoke were detected.</p> <p>Fire Alarm Warning</p> <p>Triggering a fire alarm will activate sirens on all connected smoke detectors (i.e., all smoke detectors belonging to the corresponding alarm line).</p> <p>Only use this feature for testing purposes in controlled conditions.</p> <p>Fire Alarm Detection</p> <p>Self-triggered fire alarms are ignored by the gateway.</p> <ol> <li>Click the  Trigger fire alarm button</li> <li>A confirmation dialog appears</li> <li>Click Yes to proceed</li> <li>The gateway transmits the appropriate commands repetitively via RF</li> <li>The button displays a spinner while RF transmission is in progress</li> </ol>"},{"location":"features/alarm-lines-management/#stop-fire-alarm","title":"Stop Fire Alarm","text":"<p>Stops an active fire alarm on the selected alarm line.</p> <ol> <li>Click the  Stop fire alarm button</li> <li>The gateway immediately transmits the appropriate commands repetitively via RF</li> <li>The button displays a spinner while RF transmission is in progress</li> </ol>"},{"location":"features/alarm-lines-management/#action-notifications","title":"Action Notifications","text":"<p>When an action is triggered, an initial notification confirms the action was sent. The gateway then monitors for completion and displays one of two notifications:</p> <ul> <li>Success: \"The triggered action finished successfully.\" (action completed normally)</li> <li>Timeout: \"The triggered action timed out.\" (no response received from Genius Gateway within timeout period)</li> </ul>"},{"location":"features/alarm-lines-management/#related-documentation","title":"Related Documentation","text":"<ul> <li>Gateway Settings - Configure automatic alarm line registration and packet processing behavior</li> <li>Overview - View real-time alarm status across all alarm lines and devices</li> <li>Device Management - Configure individual smoke detector devices</li> </ul>"},{"location":"features/device-management/","title":"Device Management","text":""},{"location":"features/device-management/#device-management","title":"Device Management","text":"<p>The Device Management page provides a centralized interface for configuring and monitoring all Genius smoke detector devices connected to your gateway. This page allows you to add, edit, and delete smoke detectors, view their alarm history, organize them through drag-and-drop, and manage device configurations via export/import functionality.</p> <p></p> <p>Access Requirements</p> <p>Device Management is only accessible to users with administrator privileges. The gateway must be connected to at least one Genius smoke detector to display device information.</p>"},{"location":"features/device-management/#device-list-overview","title":"Device List Overview","text":"<p>The device list displays all registered Genius smoke detectors in a structured table format with the following columns:</p>"},{"location":"features/device-management/#location","title":"Location","text":"<p>The assigned location name for each detector (e.g., \"Living Room\", \"Bedroom\"). If no location has been assigned, the device shows \"Unknown location\" in italicized gray text.</p>"},{"location":"features/device-management/#smoke-detector","title":"Smoke Detector","text":"<p>Information about the smoke detector component:</p> <ul> <li> Serial Number: The unique identifier of the smoke detector unit</li> <li> Production Date: Manufacturing date displayed in DD.MM.YYYY format, or \"Unknown\" if not available</li> </ul>"},{"location":"features/device-management/#radio-module","title":"Radio Module","text":"<p>Information about the radio communication module:</p> <ul> <li> Serial Number: The unique identifier of the radio module</li> <li> Production Date: Manufacturing date displayed in DD.MM.YYYY format, or \"Unknown\" if not available</li> </ul>"},{"location":"features/device-management/#alarms","title":"Alarms","text":"<p>Alarm statistics for the device:</p> <ul> <li>Count: Total number of recorded alarms</li> <li>Last Alarm: Date of the most recent alarm event (displayed if any alarms exist)</li> </ul>"},{"location":"features/device-management/#registration","title":"Registration","text":"<p>Indicates how the device was added to the system:</p> <ul> <li> Manual: Device was manually configured by an administrator</li> <li> Automatic: Device was automatically registered after receiving an alert packet</li> </ul>"},{"location":"features/device-management/#manage","title":"Manage","text":"<p>Action buttons for device operations:</p> <ul> <li> Alarm Log: View detailed alarm history (only visible if alarms exist)</li> <li> Edit: Modify device configuration</li> <li> Delete: Remove device from the system</li> </ul>"},{"location":"features/device-management/#initial-setup","title":"Initial Setup","text":"<p>When you first access the Device Management page with no smoke detectors configured, you'll see a helpful message:</p> <p>No smoke detectors configured yet.</p> <p>Click the \"+\" button to add your first smoke detector.</p> <p>You can proceed to add a new smoke detector by either:</p> <ol> <li>Manual Registration: Explicitly add smoke detectors you've configured (recommended for planned installations)</li> <li>Automatic Discovery: Enable automatic device registration in Gateway Settings, then trigger any smoke detector\u2014the gateway will automatically register the device when it receives an alarm packet</li> </ol>"},{"location":"features/device-management/#reordering-devices","title":"Reordering Devices","text":"<p>You can change the display order of devices using drag-and-drop functionality:</p> <ol> <li>Click and hold the grip icon () on the left side of any device row</li> <li>Drag the device to the desired position in the list</li> <li>Release to drop the device in its new position</li> <li>The new order is automatically saved to the gateway</li> </ol> <p>This feature is useful for organizing devices by floor level, room priority, or any custom arrangement that suits your needs.</p>"},{"location":"features/device-management/#viewing-alarm-history","title":"Viewing Alarm History","text":"<p>Each device maintains a log of all alarm events. To view the alarm history:</p> <ol> <li>Click the  Alarm Log button in the device's row</li> <li> <p>The Alarm Log dialog displays a table with the following information for each alarm:</p> <p></p> <ul> <li> Start: Date and time when the alarm was triggered</li> <li> End: Date and time when the alarm ended (only for resolved alarms)</li> <li>Ending Reason: How the alarm was resolved:<ul> <li> Automatic: Smoke detector no longer detected smoke</li> <li> Manual: User manually stopped the alarm</li> </ul> </li> </ul> </li> </ol> <p>Active alarms show \"No data\" for the end time and no ending reason icon.</p>"},{"location":"features/device-management/#adding-a-new-detector","title":"Adding a New Detector","text":""},{"location":"features/device-management/#manually-adding-a-new-detector","title":"Manually adding a new Detector","text":"<p>To register a new Genius smoke detector:</p> <ol> <li>Click the  Add smoke detector button in the top-right corner</li> <li> <p>The \"Add smoke detector\" dialog opens with empty fields</p> <p></p> </li> <li> <p>Fill in the required information as follows:</p> <p>Location Enter a descriptive name for the detector's location (1-40 characters). This helps identify the device in the list and alarm notifications.</p> <p>Smoke Detector Component</p> <ul> <li>Model: Select the smoke detector model (currently Genius Plus X)</li> <li>Serial Number: Enter the unique serial number (<code>1 - 4294967294</code>)</li> <li>Production Date: Select the manufacturing date from the date picker</li> </ul> <p>Radio Module Component</p> <ul> <li>Model: Select the radio module model (currently FM Basis X)</li> <li>Serial Number: Enter the unique serial number (<code>1 - 4294967294</code>)</li> <li>Production Date: Select the manufacturing date from the date picker</li> </ul> </li> <li> <p>Click  Save to add the device</p> </li> </ol> <p>The system validates all inputs and prevents duplicate serial numbers for both smoke detectors and radio modules.</p>"},{"location":"features/device-management/#automatic-device-discovery","title":"Automatic Device Discovery","text":"<p>In addition to manually adding devices, the Genius Gateway can automatically discover and register smoke detectors when they trigger an alarm. This feature requires the \"Process alerts from unknown smoke detectors\" setting to be enabled in Gateway Settings.</p>"},{"location":"features/device-management/#how-automatic-discovery-works","title":"How Automatic Discovery Works","text":"<p>When an unknown smoke detector triggers an alarm:</p> <ol> <li>The gateway receives the alarm packet containing the detector's serial number and radio module serial number</li> <li>If automatic discovery is enabled, the gateway creates a new device entry with:<ul> <li>Smoke detector serial number from the alarm packet</li> <li>Radio module serial number from the alarm packet</li> <li>Location set to \"Unknown location\"</li> <li>Model type set to \"Unknown\" for both components</li> <li>Production dates unset (shown as \"Unknown\")</li> <li>Registration type marked as  Automatic</li> </ul> </li> <li>The alarm is immediately processed and displayed in the system</li> <li>MQTT notifications are published for the new device (if MQTT is enabled)</li> </ol>"},{"location":"features/device-management/#updating-automatically-discovered-devices","title":"Updating Automatically Discovered Devices","text":"<p>Automatically discovered devices appear in the device list with \"Unknown location\" and can be edited like any other device (see Editing a Detector). When editing these devices:</p> <ul> <li>Location: Replace \"Unknown location\" with a descriptive name for proper alarm identification</li> <li>Model Types: Will be automatically set to the default models (Genius Plus X and FM Basis X) when opening the edit dialog</li> <li>Production Dates: Add the actual manufacturing dates if known</li> <li>Serial Numbers: Verify the automatically captured values are correct (if possible)</li> </ul> <p>Best Practice</p> <p>Review and update automatically discovered devices promptly to ensure proper identification during future alarms. A descriptive location name is especially important for alarm notifications.</p> <p>Device Registration Type</p> <p>The registration type indicator ( Manual vs  Automatic) shows how each device was originally added and persists even after editing the device details.</p>"},{"location":"features/device-management/#editing-a-detector","title":"Editing a Detector","text":"<p>To modify an existing detector's configuration:</p> <ol> <li>Click the  Edit smoke detector button in the device's row</li> <li> <p>The \"Edit smoke detector\" dialog opens with the current device information</p> <p></p> </li> <li> <p>Modify any fields as needed:</p> <ul> <li>Location name</li> <li>Smoke detector serial number or production date</li> <li>Radio module serial number or production date</li> </ul> </li> <li>Click  Save to apply changes</li> </ol> <p>Unique Serial Numbers</p> <p>The system ensures that modified serial numbers remain unique across all devices.</p>"},{"location":"features/device-management/#deleting-a-detector","title":"Deleting a Detector","text":"<p>To remove a detector from the system:</p> <ol> <li>Click the  Delete smoke detector button in the device's row</li> <li>A confirmation dialog appears showing the device's serial number and location</li> <li>Click Yes to confirm deletion, or Abort to cancel</li> </ol> <p>Deletion is Permanent</p> <p>Deleting a device removes all associated data including alarm history. This action cannot be undone. Consider exporting your configuration before deleting devices.</p>"},{"location":"features/device-management/#exporting-configuration","title":"Exporting Configuration","text":"<p>You can export your complete device configuration to a JSON file:</p> <ol> <li>Click the  Save smoke detector configuration to file button in the top-right corner</li> <li>Rename and save the file to the desired location</li> </ol> <p>The export includes all device information and alarm history. This feature is useful for:</p> <ul> <li>Creating backups before making configuration changes</li> <li>Migrating device configurations to a new gateway</li> <li>Archiving alarm history for documentation purposes</li> </ul>"},{"location":"features/device-management/#importing-configuration","title":"Importing Configuration","text":"<p>Import Replaces All Devices</p> <p>Importing a configuration file completely replaces your current device list. Export your current configuration before importing if you want to preserve it.</p> <p>You can import a previously exported device configuration:</p> <ol> <li>Click the  Load smoke detector configuration from file button in the top-right corner</li> <li>Select a valid configuration file from your computer</li> <li>The system validates the file format and imports all devices</li> <li>All existing devices are replaced with the imported configuration</li> </ol>"},{"location":"features/device-management/#related-documentation","title":"Related Documentation","text":"<ul> <li>Gateway Settings - Configure alarming behavior and alarm line topology</li> <li>MQTT Integration - Monitor device status and alarms via MQTT</li> <li>System Status - View overall gateway health and connectivity</li> </ul>"},{"location":"features/gateway-settings/","title":"Gateway Settings","text":""},{"location":"features/gateway-settings/#gateway-settings","title":"Gateway Settings","text":"<p>This page describes the gateway-specific settings that control how the Genius Gateway processes incoming radio packets and manages smoke detector devices.</p> <p>Access Required</p> <p>Gateway settings require administrator privileges to view and modify.</p>"},{"location":"features/gateway-settings/#overview","title":"Overview","text":"<p>The Gateway Settings allow you to configure the automatic behavior of the Genius Gateway when processing radio communications from Hekatron Genius Plus X smoke detectors. These settings determine how the gateway responds to different types of packets and whether it automatically adds newly discovered devices or alarm line IDs.</p> <p></p>"},{"location":"features/gateway-settings/#settings-categories","title":"Settings Categories","text":""},{"location":"features/gateway-settings/#alarming","title":"Alarming","text":""},{"location":"features/gateway-settings/#process-alerts-from-unknown-smoke-detectors","title":"Process alerts from unknown smoke detectors","text":"<p>Default: Enabled (recommended)</p> <p>When enabled, the gateway will automatically add smoke detectors to your device list when they trigger an alarm, even if you haven't manually added them before. This ensures that alarm notifications are never missed from detectors in your wireless network.</p> <p>When enabled:</p> <ul> <li>Unknown detectors triggering an alarm are automatically added to the device list</li> <li>Alarm states from these newly-added detectors are immediately processed and displayed</li> <li>MQTT notifications are published for the new devices (if MQTT is enabled)</li> <li>You'll be notified of fire alarms from all detectors in range, even newly installed ones</li> </ul> <p>When disabled:</p> <ul> <li>Only pre-configured smoke detectors in your device list can trigger alarms</li> <li>Alarm packets from unknown detectors are ignored</li> <li>You must manually add detectors before they can send alarm notifications</li> <li>Useful for strictly controlled environments where only specific detectors should be monitored</li> </ul> <p>Recommended Setting</p> <p>Keep this enabled for maximum safety. It ensures you never miss an alarm from a smoke detector in your network, even if you forgot to add it to the gateway.</p> <p>Security Consideration</p> <p>When enabled, any Genius Plus X detector in radio range can be automatically added during an alarm. If you need strict control over which detectors are monitored, disable this setting and manually add only authorized devices.</p>"},{"location":"features/gateway-settings/#alarm-lines","title":"Alarm Lines","text":"<p>Alarm line IDs are unique identifiers that group smoke detectors into logical networks. These IDs are essential for alarm line management functions such as line tests and test alarms. The gateway can automatically learn and store these IDs from various types of radio packets.</p> <p>For detailed information about alarm line IDs and their role in the Hekatron Genius system, see Protocol Analysis - Base Packet Structure.</p>"},{"location":"features/gateway-settings/#add-alarm-line-id-of-received-commissioning-packets-automatically","title":"Add alarm line ID of received commissioning packets automatically","text":"<p>Default: Enabled (recommended)</p> <p>When enabled, the gateway automatically extracts and stores alarm line IDs from commissioning packets. Commissioning packets are sent when smoke detectors are initially set up or when new detectors are added to an existing alarm line.</p> <p>When enabled:</p> <ul> <li>New alarm line IDs are discovered during detector commissioning</li> <li>Existing alarm line IDs are updated when detectors join a line</li> <li>Your alarm line list stays synchronized with your detector network</li> <li>No manual entry of alarm line IDs required after commissioning</li> </ul> <p>When disabled:</p> <ul> <li>Alarm line IDs must be manually added via the alarm lines interface</li> <li>Commissioning activities won't update your alarm line list</li> </ul> <p>Learn more: Alarm Line Commissioning Packets</p>"},{"location":"features/gateway-settings/#add-alarm-line-id-of-received-alarmingsilencing-packets-automatically","title":"Add alarm line ID of received alarming/silencing packets automatically","text":"<p>Default: Enabled (recommended)</p> <p>When enabled, the gateway automatically extracts and stores alarm line IDs from alarm start and alarm stop (silencing) packets. These packets are transmitted when a smoke detector triggers an alarm or when an alarm is silenced.</p> <p>When enabled:</p> <ul> <li>Alarm line IDs are learned during actual fire alarm events</li> <li>Your alarm line list is updated when alarms occur</li> <li>Useful for discovering alarm lines in active environments</li> </ul> <p>When disabled:</p> <ul> <li>Alarm packets don't update your alarm line list</li> <li>Alarm line IDs must be added through other means</li> </ul> <p>Learn more: Alarm Packets</p>"},{"location":"features/gateway-settings/#add-alarm-line-id-of-received-line-test-packets-automatically","title":"Add alarm line ID of received line test packets automatically","text":"<p>Default: Enabled (recommended)</p> <p>When enabled, the gateway automatically extracts and stores alarm line IDs from line test packets. Line test packets are sent when the line test function is activated on a smoke detector to verify communication between all detectors on that alarm line.</p> <p>When enabled:</p> <ul> <li>Alarm line IDs are learned during line tests</li> <li>Your alarm line list updates when detectors perform line tests</li> <li>Convenient discovery method without triggering actual alarms</li> </ul> <p>When disabled:</p> <ul> <li>Line test packets don't update your alarm line list</li> <li>Alarm line IDs must be added manually</li> </ul> <p>Learn more: Line Test Packets</p>"},{"location":"features/gateway-settings/#related-documentation","title":"Related Documentation","text":"<ul> <li>Device Management - Managing smoke detectors</li> <li>Alarm Lines Management - Managing alarm line IDs and functions</li> <li>Protocol Analysis - Technical details about packet types</li> </ul>"},{"location":"features/overview/","title":"System Overview","text":""},{"location":"features/overview/#overview","title":"Overview","text":"<p>The Overview page serves as the main dashboard of the Genius Gateway web interface, providing an at-a-glance view of all registered smoke detectors and their current status. This page is the default landing page after login and offers quick access to alarm management functions.</p> <p></p>"},{"location":"features/overview/#device-status-grid","title":"Device Status Grid","text":"<p>The Overview page displays all registered smoke detectors in a responsive grid layout. Each device is represented by a status card showing:</p>"},{"location":"features/overview/#device-information","title":"Device Information","text":"<ul> <li>Location: The assigned location name for easy identification</li> <li> Smoke Detector Serial Number: Unique identifier of the smoke detector unit</li> <li>:tabler-buildung-factory-2: Production Date: Manufacturing date (if configured)</li> <li> Alarm Counter and Last Alarm Date: Total number of recorded alarms and date of the most recent alarm event (if any alarms exist)</li> </ul>"},{"location":"features/overview/#visual-states","title":"Visual States","text":"<p>Status cards change appearance based on the device state:</p> <ul> <li> <p> Normal Mode: Blue/primary color scheme indicating standby operation</p> <p></p> </li> <li> <p>:tabler-flame: Alarm Mode: Red/error color scheme with fire icon for active alarms</p> <p></p> </li> <li> <p> Foreign Detector: External link icon for detectors from other alarm lines</p> <p> </p> </li> </ul> <p>Foreign Detectors</p> <p>Devices marked as \"foreign\" are smoke detectors from neighboring alarm lines that are received by your gateway but not part of your currently configured system. To process alarms from foreign \"Process alerts from unknown smoke detectors\" setting to be enabled in Gateway Settings. </p>"},{"location":"features/overview/#alarm-management","title":"Alarm Management","text":"<p>When one or more smoke detectors are actively alarming, the Overview page displays an alarm management section at the top of the device grid.</p> <p></p>"},{"location":"features/overview/#end-all-active-alarms","title":"End All Active Alarms","text":"<p>The End all active alarms button () becomes visible when any device is in alarm state.</p> <p></p> <p>Clicking this button opens a dialog where you can:</p> <p></p> <ol> <li>Specify an alarm blocking time (0-600 seconds)</li> <li>Confirm the action to end all active alarms</li> <li>Temporarily prevent new alarms during the blocking period</li> </ol>"},{"location":"features/overview/#alarm-blocking-counter","title":"Alarm Blocking Counter","text":"<p>When an alarm blocking time is active, a countdown is displayed showing the remaining seconds:</p> <p></p> <p>You can press the counter button to immediately end the blocking period and resume normal alarm processing:</p> <p></p> <p>A confirmation dialog will appear to verify the action:</p> <p></p> <p>This feature is useful for:</p> <ul> <li>Silencing false alarms after investigation</li> <li>Stopping alarm propagation during testing</li> <li>Managing nuisance alarms while addressing the root cause</li> </ul> <p>Alarm Blocking Time</p> <p>Setting a blocking time prevents the gateway from processing new alarm signals during the specified period. Use this feature carefully to avoid missing genuine fire alerts.</p>"},{"location":"features/overview/#empty-state","title":"Empty State","text":"<p>If no smoke detectors are configured, the Overview page displays an informational message with a link to the Device Management page, guiding users to add their first devices.</p>"},{"location":"features/overview/#related-documentation","title":"Related Documentation","text":"<ul> <li>Device Management - Add, edit, and configure smoke detectors</li> <li>Gateway Settings - Configure alarming behavior and system settings</li> <li>Alarm Lines - Manage alarm line topology and foreign detector behavior</li> </ul>"},{"location":"features/packet-visualizer/","title":"Packet Visualizer","text":""},{"location":"features/packet-visualizer/#packet-visualizer","title":"Packet Visualizer","text":"<p>The Packet Visualizer provides real-time monitoring and analysis of RF communication packets from Hekatron Genius Plus X smoke detectors. This powerful diagnostic tool allows you to observe the wireless communication in your smoke detector network, helping with troubleshooting, protocol analysis, and system verification.</p> <p></p> <p>WebSocket Logger Required</p> <p>The Packet Visualizer requires the WebSocket Logger to be enabled. If disabled, you'll see an informational message with a link to enable it in the WebSocket Logger Settings.</p>"},{"location":"features/packet-visualizer/#overview","title":"Overview","text":"<p>The Packet Visualizer displays captured RF packets in real-time with intelligent deduplication, detailed interpretation, and visual highlighting. Each packet type is automatically identified and decoded to show meaningful information about detector communication, alarms, commissioning activities, and network topology.</p>"},{"location":"features/packet-visualizer/#visualizer-settings","title":"Visualizer Settings","text":"<p>The Visualizer Settings card allows you to customize how packets are displayed:</p>"},{"location":"features/packet-visualizer/#show-packet-details-data-interpretation-and-highlighting","title":"Show packet details (data interpretation and highlighting)","text":"<p>Default: Enabled</p> <p>When enabled, the visualizer interprets packet data and highlights important fields with color coding and labels:</p> <ul> <li>Packet type identification: Automatic detection of packet types (alarm, commissioning, discovery, etc.)</li> <li>Field highlighting: Important bytes are color-coded and labeled</li> <li>Data interpretation: Serial numbers, line IDs, timestamps, and other fields are decoded</li> <li>Location mapping: Serial numbers are matched to configured device locations</li> </ul> <p>When disabled, packets are shown in raw hexadecimal format without interpretation.</p> <p></p>"},{"location":"features/packet-visualizer/#show-meta-data-of-packets","title":"Show meta data of packets","text":"<p>Default: Enabled</p> <p>When enabled, displays metadata information for each packet:</p> <ul> <li>Packet number: Sequential ID for tracking packet order</li> <li> <p>Receive timestamps: System time (microseconds) of first and last repetition of this packet  </p> <p>Timestamp Behavior</p> <p>Timestamps represent system time in microseconds with the following behavior:</p> <ul> <li>With NTP configured: Actual Unix epoch timestamps (microseconds since January 1, 1970 UTC)</li> <li>Without NTP: Time since gateway boot in microseconds</li> </ul> <p>Timestamps are consistent and monotonically increasing within a session, making them suitable for packet timing analysis regardless of NTP availability.</p> </li> <li> <p>Repetition counter: Number of times an identical packet was received</p> </li> <li>Packet length: How many data bytes the packet contains</li> </ul> <p>When disabled, only the packet data itself is shown without metadata headers.</p>"},{"location":"features/packet-visualizer/#genius-packets-display","title":"Genius Packets Display","text":"<p>The main packet display area shows all captured RF packets with real-time updates. Packets are automatically deduplicated using hash-based detection - identical packets increment a counter instead of creating duplicate entries.</p>"},{"location":"features/packet-visualizer/#packet-information","title":"Packet Information","text":"<p>Each displayed packet shows general information and packet-specific details based on the packet type. For complete field descriptions and packet structure details, see the Protocol Analysis documentation.</p>"},{"location":"features/packet-visualizer/#packet-actions","title":"Packet Actions","text":"<p>The toolbar provides several actions for managing captured packets:</p>"},{"location":"features/packet-visualizer/#copy-packet-data-to-clipboard","title":"Copy packet data to clipboard","text":"<p>Copies all captured packet data to the system clipboard in JSON format. Useful for:</p> <ul> <li>Sharing packet logs for troubleshooting</li> <li>External analysis with other tools</li> <li>Documentation and reporting</li> </ul>"},{"location":"features/packet-visualizer/#clear-packet-logs","title":"Clear packet logs","text":"<p>Clears all captured packets from the display. A confirmation dialog appears to prevent accidental deletion.</p>"},{"location":"features/packet-visualizer/#load-packets-log-from-file","title":"Load packets log from file","text":"<p>Imports previously saved packet logs from a file.</p> <p>Re-analyzing Imported Packets</p> <p>After loading a file, you'll be prompted whether to re-analyze the packets using your current device and alarm line configurations. Choosing \"No\" displays the originally saved interpreted information, while \"Yes\" re-interprets the packets based on your current configuration.</p> <p>This is useful for:</p> <ul> <li>Reviewing historical packet captures</li> <li>Analyzing packets offline</li> <li>Comparing packet behavior across different time periods</li> </ul>"},{"location":"features/packet-visualizer/#save-packet-logs-to-file","title":"Save packet logs to file","text":"<p>Exports all captured packets to a file. The file includes:</p> <ul> <li>Complete packet data in serialized format</li> <li>Timestamps and metadata</li> <li>All interpreted information</li> </ul>"},{"location":"features/packet-visualizer/#packet-deduplication","title":"Packet Deduplication","text":"<p>The visualizer uses intelligent hash-based deduplication to prevent display clutter from repeated packet transmissions. When an identical packet is received:</p> <ul> <li>The repetition counter increments</li> <li>The \"last seen\" timestamp updates</li> <li>No new packet entry is created</li> </ul> <p>This is essential because smoke detectors transmit important packets multiple times to ensure reliable delivery across the mesh network.</p>"},{"location":"features/packet-visualizer/#related-documentation","title":"Related Documentation","text":"<ul> <li>WebSocket Logger - Enable real-time packet streaming</li> <li>Protocol Analysis - Detailed packet structure documentation</li> <li>Device Management - Configure detector locations for packet interpretation</li> <li>Alarm Lines - Configure alarm line names for better packet labeling</li> </ul>"},{"location":"features/smart-home-integration/","title":"Smart Home Integration","text":""},{"location":"features/smart-home-integration/#smart-home-integration","title":"Smart Home Integration","text":"<p>Genius Gateway offers two levels of smart home integration via MQTT, allowing you to choose between simple alarm notifications and full Home Assistant device integration with comprehensive automation capabilities.</p> Approach Description Best for Simple Alarm Publishing Basic fire alarm notifications forwarded to your smart home system without individual device tracking. Quick setup, simple alarm notifications for all smart home systems with MQTT interface Home Assistant Integration Full device integration with automatic discovery, individual detector tracking, and rich automation possibilities. Home Assistant users, detailed monitoring, advanced automation scenarios Feature Simple Alarm Publishing Home Assistant Integration Setup Complexity Minimal - one topic Moderate - add detectors Detector Configuration Not required Required Device Tracking Individual Entities Location Information Customizable Automation Capabilities Basic - single trigger Advanced - per detector Platform Support Any MQTT platform Home Assistant optimized Unknown Detectors Supported Supported Historical Data(besides Genius Gateway) Limited Full Home Assistant history"},{"location":"features/smart-home-integration/#simple-alarm-publishing","title":"Simple Alarm Publishing","text":""},{"location":"features/smart-home-integration/#overview","title":"Overview","text":"<p>Simple alarm publishing provides a straightforward way to integrate fire alarm detection into your smart home system. When any smoke detector in range triggers an alarm, Genius Gateway publishes a message to a central MQTT topic.</p> <p>Key Characteristics:</p> <ul> <li>Single topic for all alarm events</li> <li>No device configuration required in Genius Gateway</li> <li>Detects unknown detectors within radio range (if enabled)</li> <li>System agnostic - compatible with any MQTT-capable smart home platform</li> </ul>"},{"location":"features/smart-home-integration/#how-it-works","title":"How It Works","text":"<ol> <li>Detection: Genius Gateway continuously monitors 868 MHz radio traffic for Genius Plus X alarm signals</li> <li>Processing: When an alarm packet is detected, the gateway processes the alarm state</li> <li>Publishing: Alarm information is published to the configured MQTT topic</li> <li>Counter: The message includes how many detectors are currently in alarm state</li> </ol> <p>See the MQTT API - Global Alarm State Topic for detailed payload format and examples.</p>"},{"location":"features/smart-home-integration/#configuration-requirements","title":"Configuration Requirements","text":"<p>To enable simple alarm publishing:</p> <ol> <li>Configure MQTT broker connection - Set up connection to your MQTT broker</li> <li>Enable Simple Alarm Publishing - Configure the alarm topic and enable publishing</li> <li>(Optional) Enable unknown detector processing - Allow detection of detectors not explicitly configured</li> </ol> <p>Works with Known and Unknown Detectors</p> <p>Simple Alarm Publishing works with or without smoke detectors configured in Genius Gateway. However, if no smoke detectors are configured, processing alarms from unknown smoke detectors must be enabled for Genius Gateway to detect and forward fire alarms.</p>"},{"location":"features/smart-home-integration/#home-assistant-integration","title":"Home Assistant Integration","text":""},{"location":"features/smart-home-integration/#home-assistants-mqtt-discovery","title":"Home Assistant's MQTT Discovery","text":"<p>The Home Assistant integration leverages MQTT Discovery  to automatically register each smoke detector as an individual device in Home Assistant. This provides rich functionality including:</p> <ul> <li>Automatic device discovery - No manual configuration in Home Assistant</li> <li>Individual detector tracking - Monitor each detector's state separately</li> <li>Rich device information - Model, manufacturer, serial numbers, location</li> <li>Automation capabilities - Create detector-specific automations</li> <li>Historical data - Track alarm history per detector</li> <li>Dashboard integration - Visual representation of detector network</li> </ul> <p>Home Assistant's MQTT Discovery allows devices to automatically register themselves by publishing configuration messages to specific topics. When Genius Gateway publishes a discovery message:</p> <ol> <li>Home Assistant detects the configuration message,</li> <li>automatically creates a binary sensor entity for the smoke detector,</li> <li>updates state in real-time when detector status changes and</li> <li>syncs configuration when location or settings change in Genius Gateway</li> </ol>"},{"location":"features/smart-home-integration/#benefits-for-home-assistant-users","title":"Benefits for Home Assistant Users","text":"<p>Automatic Setup:</p> <ul> <li>Zero manual configuration in Home Assistant required </li> <li>Devices appear instantly in Home Assistant</li> <li>Updates propagate automatically</li> </ul> <p>Rich Entity Information:</p> <ul> <li>Device class (Smoke detector)</li> <li>Manufacturer: (Hekatron)</li> <li>Model (Genius Plus X)</li> <li>Serial number</li> <li>Configurable location names</li> </ul> <p>Advanced Automations:</p> <ul> <li>Detector-specific triggers</li> <li>Location-based actions</li> <li>Group multiple detectors</li> </ul>"},{"location":"features/smart-home-integration/#visual-integration","title":"Visual Integration","text":"<p>Overview Dashboard:</p> <p> Multiple Genius Plus X smoke detectors automatically discovered and displayed with their configured locations</p> <p>Detector Detail View:</p> <p> Detailed view of a single detector showing real-time alarm state, manufacturer information, model, and serial number</p> <p>Device Information:</p> <p> Complete device information with manufacturer details, model identification, and assigned area for automation purposes</p>"},{"location":"features/smart-home-integration/#configuration-requirements_1","title":"Configuration Requirements","text":"<p>To enable Home Assistant MQTT Discovery integration in Genius Gateway:</p> <ol> <li>Add smoke detectors to Genius Gateway - Register detectors with serial numbers and locations</li> <li>Configure MQTT broker connection - Set up connection (must be same broker as Home Assistant)</li> <li>Enable Device Publishing - Enable Home Assistant MQTT Discovery and adjust the topic prefix if your Home Assistant uses a non-default discovery prefix</li> </ol> <p>Ensure MQTT Discovery is enabled in your Home Assistant configuration:</p> <pre><code># configuration.yaml\nmqtt:\n  broker: YOUR_BROKER_IP\n  discovery: true  # This is usually enabled by default\n  discovery_prefix: homeassistant  # Must match Genius Gateway prefix\n</code></pre>"},{"location":"features/smart-home-integration/#configuration-synchronization","title":"Configuration Synchronization","text":"<p>Changes made in Genius Gateway automatically synchronize to Home Assistant:</p> <ul> <li>Location Updates: When you edit a detector's location in Genius Gateway, the change is published via MQTT Discovery and updates the device name in Home Assistant.</li> <li>Detector Addition: New detectors added to Genius Gateway automatically appear in Home Assistant within seconds.</li> </ul>"},{"location":"features/smart-home-integration/#related-documentation","title":"Related Documentation","text":"<ul> <li>Configure Gateway - Step-by-step setup guide for both integration types</li> <li>Connections - MQTT - Detailed MQTT configuration including broker setup and authentication</li> <li>Gateway Settings - Enable unknown detector processing and automatic alarm line discovery</li> <li>MQTT API - Complete MQTT topic structure and payload documentation</li> <li>Device Management - Adding and managing smoke detectors in Genius Gateway</li> </ul>"},{"location":"features/websocket-interface/","title":"WebSocket Logging Interface","text":""},{"location":"features/websocket-interface/#websocket-logging-interface","title":"WebSocket Logging Interface","text":"<p>The WebSocket Logger provides real-time streaming of RF packets from the CC1101 radio to connected clients via WebSocket protocol. This enables external tools and the built-in Packet Visualizer to receive and analyze packets as they are captured.</p> <p>Access Required</p> <p>WebSocket Logger settings require administrator privileges to view and modify.</p>"},{"location":"features/websocket-interface/#overview","title":"Overview","text":"<p>The WebSocket Logger acts as a bridge between the gateway's RF packet reception and client applications that need real-time packet data. When enabled, all received packets are immediately streamed to connected WebSocket clients, providing live monitoring and analysis capabilities.</p> <p></p>"},{"location":"features/websocket-interface/#websocket-logger-settings","title":"WebSocket Logger Settings","text":""},{"location":"features/websocket-interface/#enable-websocket-logger","title":"Enable WebSocket Logger","text":"<p>Default: Disabled</p> <p>Controls whether the WebSocket logging service is active and accepting client connections.</p> <p>When enabled:</p> <ul> <li>The WebSocket server accepts connections at <code>ws://[gateway-ip]/ws/logger</code></li> <li>All received RF packets are streamed in real-time to connected clients</li> <li>The Packet Visualizer can display live packet data</li> <li>External tools can connect to receive raw packet streams</li> <li>An informational message displays the WebSocket connection URL</li> </ul> <p>When disabled:</p> <ul> <li>The WebSocket server rejects all connection attempts</li> <li>No packet data is transmitted over WebSocket</li> <li>The Packet Visualizer cannot receive live packets (file import still works)</li> <li>Reduces system load when real-time monitoring is not needed</li> </ul> <p>Performance Impact</p> <p>Packets are sent to connected clients synchronously during packet reception. A slow network connection or multiple connected clients can significantly impact packet processing performance and may lead to packet loss. For best results, use a fast local network connection and limit the number of simultaneous clients. See Performance Considerations for details.</p>"},{"location":"features/websocket-interface/#websocket-connection","title":"WebSocket Connection","text":"<p>When the logger is enabled, clients can connect using:</p> <pre><code>ws://[gateway-ip-address]/ws/logger\n</code></pre>"},{"location":"features/websocket-interface/#connection-details","title":"Connection Details","text":"<ul> <li>Protocol: WebSocket (RFC 6455)</li> <li>Data Format: Binary (raw packet data structure)</li> <li>Authentication: Follows gateway security settings</li> <li>Path: <code>/ws/logger</code></li> </ul>"},{"location":"features/websocket-interface/#data-structure","title":"Data Structure","text":"<p>Each WebSocket message contains the complete <code>cc1101_packet_t</code> structure (80 bytes total):</p> Offset Size(incl. padding) Type Description 0 8 bytes uint64_t Packet reception timestamp (microseconds) 8 64 bytes uint8_t[64] RX FIFO bufferByte 8+ 0: Packet length byte from CC1101 (number of bytes following, including status bytes)Byte 8+ 1 to byte 8+ length: Actual packet data, see Genius Plus X PacketsByte 8+ length+1: RSSIByte 8+ length+2: LQI/CRC 72 4 bytes uint8_t* Pointer to packet data within buffer (client-side: ignore/treat as reserved) 76 4 bytes size_t Packet data length (number of data bytes, excluding status bytes)"},{"location":"features/websocket-interface/#use-cases","title":"Use Cases","text":""},{"location":"features/websocket-interface/#built-in-packet-visualizer","title":"Built-in Packet Visualizer","text":"<p>The Packet Visualizer uses the WebSocket Logger internally to display live packet data with interpretation and highlighting. This is the primary use case for most users.</p>"},{"location":"features/websocket-interface/#external-analysis-tools","title":"External Analysis Tools","text":"<p>Developers and researchers can create custom tools that connect to the WebSocket to:</p> <ul> <li>Capture packet streams for offline analysis</li> <li>Implement custom packet filtering or alerting</li> <li>Integrate with other monitoring systems</li> <li>Perform protocol research and reverse engineering</li> </ul>"},{"location":"features/websocket-interface/#api-integration","title":"API Integration","text":"<p>For detailed information about WebSocket API usage and integration, see WebSocket API.</p>"},{"location":"features/websocket-interface/#performance-considerations","title":"Performance Considerations","text":"<p>The WebSocket Logger is designed for diagnostic and development purposes. Consider the following when enabling it:</p> <ol> <li>Packet Processing Overhead: Each received packet triggers a synchronous WebSocket send operation to all connected clients</li> <li>Network Latency: Slow clients can block packet processing, causing the RX FIFO to overflow</li> <li>Multiple Clients: Each additional client multiplies the synchronous send overhead</li> <li>Continuous Operation: Consider disabling the logger when real-time monitoring is not needed</li> </ol> <p>Optimal Usage</p> <p>Enable the WebSocket Logger only when actively using the Packet Visualizer or external monitoring tools. Disable it during normal gateway operation to ensure optimal packet reception performance.</p>"},{"location":"features/websocket-interface/#related-documentation","title":"Related Documentation","text":"<ul> <li>Packet Visualizer - Built-in tool for real-time packet analysis</li> <li>MQTT Topics - MQTT integration and message formats</li> <li>Protocol Analysis - Packet structure and field definitions</li> <li>Gateway Settings - Configure packet processing behavior</li> </ul>"},{"location":"reverse-engineering/","title":"Reverse Engineering","text":""},{"location":"reverse-engineering/#reverse-engineering","title":"Reverse Engineering","text":"<p>Disclaimer</p> <p>All results documented in this section do not claim to be factually accurate. They are observations and conclusions drawn from them and may contradict the actual implementation.</p> <p>Any use of this information is at your own risk and responsibility.</p>"},{"location":"reverse-engineering/#equipment","title":"Equipment","text":"<p>For the analysis, I used the following equipment:</p> <ul> <li>Microscope</li> <li>Digital oscilloscope</li> <li>Logic analyzer</li> </ul>"},{"location":"reverse-engineering/#components","title":"Components","text":"<p>The analysis primarily focused on the FM Basis X  radio module.</p>"},{"location":"reverse-engineering/#results","title":"Results","text":"<p>The analysis was carried out in the following steps:</p> <ul> <li>Investigation of the PCB (documentation coming soon)</li> <li>Determination of the  RF configuration</li> <li>Investigation of the  communication protocol</li> </ul>"},{"location":"reverse-engineering/eeprom-analysis/","title":"EEPROM Analysis","text":""},{"location":"reverse-engineering/eeprom-analysis/#eeprom-analysis","title":"EEPROM Analysis","text":"<p>Warning</p> <p>The analysis of the EEPROM and the SPI communication between MSP430 and EEPROM has only been rudimentary so far. It is neither complete, nor in-depth, nor verified in any way. All the following information is merely a superficial snapshot.</p>"},{"location":"reverse-engineering/eeprom-analysis/#recorded-communication","title":"Recorded Communication","text":""},{"location":"reverse-engineering/eeprom-analysis/#interpretation","title":"Interpretation","text":"<p>The interpretation of the EEPROM commands was done using the Datasheet . It explains read and write sequences, so that an interpretation of the raw data could be done from the recorded UART traffic with the help of Protocol Decoders.</p>"},{"location":"reverse-engineering/eeprom-analysis/#data","title":"Data","text":"<p>The following shows and evaluates 2 traces. Further EEPROM traces are part of the Trace Files.</p> <p>The Memory Map shows the memory areas referenced in the traces (Section column).</p> <p>The traces and the memory map can also be downloaded as  Excel detail.</p>"},{"location":"reverse-engineering/eeprom-analysis/#trace-1","title":"Trace 1","text":""},{"location":"reverse-engineering/eeprom-analysis/#summary","title":"Summary","text":"<pre><code> 1. Write  1 byte  to   address 0x07FF\n 2. Read   1 byte  from address 0x07FF\n 3. Write  1 byte  to   address 0x07FF\n 4. Read   1 byte  from address 0x07FF\n 5. Read   4 bytes from address 0x0052\n 6. Read   8 bytes from address 0x0010\n 7. Read  10 bytes from address 0x0000 / incl. serial no. of radio module\n 8. Read  24 bytes from address 0x0030\n 9. Read  10 bytes from address 0x0048\n10. Read  10 bytes from address 0x0000 / incl. serial no. of radio module\n11. Read  10 bytes from address 0x0000 / incl. serial no. of radio module\n12. Read  16 bytes from address 0x0018\n</code></pre>"},{"location":"reverse-engineering/eeprom-analysis/#details","title":"Details","text":""},{"location":"reverse-engineering/eeprom-analysis/#trace-2","title":"Trace 2","text":""},{"location":"reverse-engineering/eeprom-analysis/#summary_1","title":"Summary","text":"<pre><code> 1. Write 22 bytes to address 0x169C / incl. serial no. of smoke detector,\n                                       date, time, unknown UART data\n 2. Write  4 bytes to address 0x0052\n 3. Write 10 bytes to address 0x0080\n 4. Write 10 bytes to address 0x008A\n 5. Write 10 bytes to address 0x0094\n 6. Write 10 bytes to address 0x009E\n 7. Write 10 bytes to address 0x00A8\n 8. Write 10 bytes to address 0x00B2\n 9. Write 10 bytes to address 0x00BC\n10. Write 10 bytes to address 0x00C6\n11. Write 10 bytes to address 0x00D0\n12. Write 10 bytes to address 0x00DA\n13. Write 10 bytes to address 0x00E4\n14. Write 10 bytes to address 0x00EE\n15. Write  8 bytes to address 0x00F8\n16. Write  2 bytes to address 0x0100\n17. Write 10 bytes to address 0x0102\n18. Write 10 bytes to address 0x010C\n19. Write 10 bytes to address 0x0116\n20. Write 10 bytes to address 0x0120\n21. Write 10 bytes to address 0x012A\n22. Write 10 bytes to address 0x0134\n</code></pre>"},{"location":"reverse-engineering/eeprom-analysis/#details_1","title":"Details","text":""},{"location":"reverse-engineering/eeprom-analysis/#findings","title":"Findings","text":"<ol> <li> <p>Every write access to the EEPROM follows this sequence:</p> <ul> <li>WREN - Write Enable (preparation for writing)</li> <li>WRITE - Write the data</li> <li>RDSR - Read Status Register (verify the write operation)</li> </ul> </li> <li> <p>Only a more comprehensive analysis, particularly the interplay between EEPROM accesses, RF transceiver communication (via SPI), and smoke detector communication (via UART), can provide insights into the data stored in the EEPROM.</p> </li> </ol>"},{"location":"reverse-engineering/eeprom-analysis/#memory-map","title":"Memory Map","text":"<p>The analysis of the communication with the EEPROM so far has resulted in the following memory map: </p> <p></p>"},{"location":"reverse-engineering/fm-basis-x-pcb/","title":"FM Basis X - PCB","text":""},{"location":"reverse-engineering/fm-basis-x-pcb/#fm-basis-x-pcb","title":"FM Basis X - PCB","text":"<p>The FM Basis X PCB is plugged onto the smoke detector. A 6-pin header connects the PCB to the smoke detector.</p>"},{"location":"reverse-engineering/fm-basis-x-pcb/#pcb-images","title":"PCB Images","text":"<ul> <li> <p>RF Transceiver Texas Instruments CC1101 with 26 MHz crystal and antenna frontend</p> </li> <li> <p></p> <p>Push button Push button for regular functions like line test, commissioning and others</p> </li> <li> <p></p> <p>RF Section, EEPROM and pin header RF transceiver and antenna area, serial EEPROM and 6-pin header (board-to-board connector to smoke detector)</p> </li> <li> <p></p> <p>RF Transceiver &amp; pin header Pin and signal names for CC1101 and the 6-pin board-to-board connector</p> </li> <li> <p></p> <p>Microcontroller Texas instruments MSP430 low-power microcontroller with decoupling capacitors and crystal</p> </li> <li> <p></p> <p>Microcontroller &amp; EEPROM signals Most relevant pin and signal names for MCU, EEPROM and interconnection (SPI, UART)</p> </li> <li> <p></p> <p>JTAG Connection SMD and TH pads with JTAG signals for programming</p> </li> <li> <p></p> <p>JTAG Signals JTAG related signal names and pin assignments</p> </li> </ul>"},{"location":"reverse-engineering/fm-basis-x-pcb/#components","title":"Components","text":""},{"location":"reverse-engineering/fm-basis-x-pcb/#microcontroller","title":"Microcontroller","text":"<p>The PCB is equipped with a Texas Instruments MSP430F2272   ultra-low-power microcontroller.</p> <p></p>"},{"location":"reverse-engineering/fm-basis-x-pcb/#key-features","title":"Key features","text":"Feature Specification Frequency 16 MHz Flash Memory 32KB + 256B RAM 1KB Supply Voltage 1.8V - 3.6V Active Power 270 \u00b5A @ 1MHz Standby Power 0.7 \u00b5A Off Mode 0.1 \u00b5A Wake-up Time &lt; 1 \u00b5s Package 40-pin VQFN <p>JTAG Access Limitation</p> <p>The microcontroller offers a JTAG interface for programming and debugging.</p> <p>Unfortunately I could not access the microcontroller via JTAG connection. Very likely the JTAG fuse was blown after flashing the device by the manufacturer.</p>"},{"location":"reverse-engineering/fm-basis-x-pcb/#links","title":"Links","text":"<ul> <li>Product page </li> <li>Datasheet </li> <li>User guide </li> </ul>"},{"location":"reverse-engineering/fm-basis-x-pcb/#rf-transceiver","title":"RF Transceiver","text":"<p>The PCB is equipped with a Texas Instruments CC1101   low-power Sub-1 GHz wireless transceiver.</p> <p></p>"},{"location":"reverse-engineering/fm-basis-x-pcb/#key-features_1","title":"Key features","text":"Feature Specification Protocols Proprietary, Wireless M-Bus Modulation scheme (G)MSK, 2(G)FSK, 4(G)FSK, ASK, OOK Frequency bands 300-348, 387-464, 779-928 MHz TX power (max) 12 dBm Sensitivity (best) -116 dBm RX current (lowest) 14.3 mA Data rate (max) 0.6 Mbps Package 20-pin VQFN <p>RF Configuration Details</p> <p>The specific CC1101 configuration for the Genius Plus X smoke detector network are described under  FM Basis X - RF.</p>"},{"location":"reverse-engineering/fm-basis-x-pcb/#links_1","title":"Links","text":"<ul> <li>Product page </li> <li>Datasheet </li> </ul>"},{"location":"reverse-engineering/fm-basis-x-pcb/#eeprom","title":"EEPROM","text":"<p>The PCB is equipped with a STMicroelectronics M95512  512 Kbit SPI bus EEPROM.</p> <p></p>"},{"location":"reverse-engineering/fm-basis-x-pcb/#key-features_2","title":"Key features","text":"Feature Specification Interface SPI bus compatible Memory array 512-Kbit (64-Kbyte) Page size 128 bytes Write time Byte/Page Write within 5 ms Write protect quarter array, half array, whole memory array High-speed clock 16 MHz Write cycles more than 4 million Data retention more than 200-year Package 8-pin TSSOP8"},{"location":"reverse-engineering/fm-basis-x-pcb/#links_2","title":"Links","text":"<ul> <li>Product page </li> <li>Datasheet </li> </ul>"},{"location":"reverse-engineering/fm-basis-x-pcb/#board-to-board-connection","title":"Board-to-board connection","text":"<p>The PCB is equipped with a standard 6-pin header (2x3) through which the connection to the smoke detector is established.</p> <p></p> Pin-# Purpose 1 GNDGround 2 3V33.3 VDC power supply 3 UART-RXReceive signal line (Radio module \u2190 Smoke detector) 4 UART-TXTransmit signal line (Radio module \u2192 Smoke detector) 5 UnknownThis line is connected to MSP430's pin no. 8, which is a multipurpose pin (GPIO, Analog Input, Timer related function). Its exact function is unknown, but it may possibly be used to signal a fire alarm to the radio module (in addition to or instead of via UART). 6 N.C.No connection could be found."},{"location":"reverse-engineering/fm-basis-x-rf/","title":"FM Basis X - RF","text":""},{"location":"reverse-engineering/fm-basis-x-rf/#rf-configuration","title":"RF Configuration","text":"<p>This section describes the radio frequency settings and configuration parameters used by the Hekatron Genius Plus X communication system.</p>"},{"location":"reverse-engineering/fm-basis-x-rf/#analysis-method","title":"Analysis Method","text":"<p>The CC1101 RF transceiver is connected to the microcontroller via SPI. Consequently, configuration and control are primarily based on this connection.</p> <p>To determine the specific CC1101 parameters, it was necessary to analyze the SPI communication using a digital oscilloscope. Built-in analysis functions (for serial interfaces like SPI or UART) facilitate the analysis work. However, the most comfortable evaluation is with a logic analyzer, which is specialized for this type of analysis.</p> <p>The CC1101 transceiver datasheet describes commands for writing and reading configuration and status registers. This allows identification of read and write actions within the recorded communication. Furthermore, using the information in the CC1101 datasheet, one can determine which registers are written or read and what data is written or read.</p> <p>Once the individual configuration registers and the data being written are identified, the datasheet information can be used to determine their meaning and effect.</p>"},{"location":"reverse-engineering/fm-basis-x-rf/#startup-sequence","title":"Startup Sequence","text":"<p>When the radio module is plugged into the smoke detector, it receives power. Unlike the smoke detectors, which have permanent power supply (batteries cannot be removed), the radio modules have no internal power supply. Consequently, all necessary configurations occur after plugging in the radio module.</p> <p>Immediately after the CC1101 chip reset, a series of individual registers are written and read. Immediately thereafter, the decisive configuration is performed using burst write.</p> <p></p> <p>Figure 1: Logic analyzer capture showing CC1101 burst write initialization sequence</p>"},{"location":"reverse-engineering/fm-basis-x-rf/#initial-burst-write","title":"Initial Burst Write","text":"<p>The following table shows the complete register initialization sequence captured from the SPI communication:</p> Register Address Value Purpose IOCFG2 0x00 0x0E GDO2 Pin Configuration: <code>0x0E</code> = RX FIFO threshold signal. Pin asserts when RX FIFO is filled at or above threshold (32 bytes). Pin goes high when data available for reading. IOCFG1 0x01 0x2E GDO1 Pin Configuration: <code>0x2E</code> = High impedance (3-state). Pin is disabled and presents high impedance to external circuits. Not used in this application. IOCFG0 0x02 0x24 GDO0 Pin Configuration: <code>0x24</code> = WOR_EVNT0 signal. Pin pulses high when Wake-on-Radio EVENT0 timeout occurs, enabling low-power periodic wake-up functionality. FIFOTHR 0x03 0x47 FIFO Thresholds: <code>0x47</code> = Bits[7]=0 (ADC retention disabled), Bits[5:4]=01 (Close in RX timeout), Bits[3:0]=0111 = TX threshold: 33 bytes free, RX threshold: 32 bytes filled. SYNC1 0x04 0xD3 Sync Word High Byte: <code>0xD3</code> = Upper 8 bits of 16-bit sync word (0xD391). Used for packet detection and synchronization. SYNC0 0x05 0x91 Sync Word Low Byte: <code>0x91</code> = Lower 8 bits of 16-bit sync word (0xD391). Combined with SYNC1 forms unique packet identifier. PKTLEN 0x06 0xFF Fixed Packet Length: <code>0xFF</code> = 255 bytes maximum packet length. Only used in fixed packet length mode (not active here due to variable length mode). PKTCTRL1 0x07 0x04 Packet Control 1: <code>0x04</code> = Bits[7:5]=000 (PQT=0), Bit[3]=0 (no address check), Bit[2]=1 (append status bytes), Bits[1:0]=00 (no address check). Status bytes (RSSI, LQI, CRC) appended to received packets. PKTCTRL0 0x08 0x45 Packet Control 0: <code>0x45</code> = Bit[6]=1 (data whitening ON), Bit[4]=0 (normal packet format), Bit[2]=1 (CRC calculation/check ON), Bits[1:0]=01 (variable packet length mode). First byte indicates packet length. ADDR 0x09 0x00 Device Address: <code>0x00</code> = Node address 0. Not used since address checking is disabled in PKTCTRL1. CHANNR 0x0A 0x00 Channel Number: <code>0x00</code> = Channel 0. Base frequency used without channel spacing offset. FSCTRL1 0x0B 0x06 Frequency Synthesizer Control: <code>0x06</code> = IF frequency = (26MHz/1024) \u00d7 6 = 152.34 kHz. Sets intermediate frequency for receiver. FSCTRL0 0x0C 0x00 Frequency Offset: <code>0x00</code> = No frequency offset. Base frequency used without additional offset. FREQ2 0x0D 0x21 Frequency Control High: <code>0x21</code> = FREQ[23:16] bits. Combined frequency word = 0x21656A = 2188650\u2081\u2080 \u2192 f = (26MHz/65536) \u00d7 2188650 = 868.035 MHz FREQ1 0x0E 0x65 Frequency Control Middle: <code>0x65</code> = FREQ[15:8] bits. Part of 24-bit frequency control word for 868.035 MHz carrier frequency. FREQ0 0x0F 0x6A Frequency Control Low: <code>0x6A</code> = FREQ[7:0] bits. Completes 24-bit frequency word: 0x21656A \u2192 868.035 MHz carrier frequency. MDMCFG4 0x10 0xCA Modem Config 4: <code>0xCA</code> = Bits[7:6]=11 (CHANBW_E=3), Bits[5:4]=00 (CHANBW_M=0) \u2192 BW = 26MHz/(8\u00d7(4+0)\u00d72\u00b3) = 101.56 kHz, Bits[3:0]=1010 (DRATE_E=10) MDMCFG3 0x11 0x83 Modem Config 3: <code>0x83</code> = DRATE_M = 131\u2081\u2080. Data rate = ((256+131)\u00d72\u00b9\u2070\u00d726MHz)/(2\u00b2\u2078) = 38.383 kBaud. Combined with MDMCFG4 for complete data rate calculation. MDMCFG2 0x12 0x13 Modem Config 2: <code>0x13</code> = Bit[7]=0 (DEM_DCFILT_OFF), Bits[6:4]=001 (MOD_FORMAT=GFSK), Bit[3]=0 (Manchester disabled), Bits[2:0]=011 (SYNC_MODE=30/32 sync word bits detected). MDMCFG1 0x13 0x23 Modem Config 1: <code>0x23</code> = Bit[7]=0 (FEC disabled), Bits[6:4]=010 (NUM_PREAMBLE=4 bytes), Bits[1:0]=11 (CHANSPC_E=3). Channel spacing exponent for frequency hopping. MDMCFG0 0x14 0x99 Modem Config 0: <code>0x99</code> = CHANSPC_M = 153\u2081\u2080. Channel spacing = ((256+153)\u00d72\u00b3\u00d726MHz)/(2\u00b9\u2078) = 199.95 kHz. Used for multi-channel operation. DEVIATN 0x15 0x35 Frequency Deviation: <code>0x35</code> = Bits[6:4]=011 (DEVIATION_E=3), Bits[2:0]=101 (DEVIATION_M=5). Deviation = (8+5)\u00d72\u00b3\u00d726MHz/2\u00b9\u2077 = 47.61 kHz for GFSK modulation. MCSM2 0x16 0x11 Main Radio Control 2: <code>0x11</code> = Bits[4:3]=10 (RX_TIME_RSSI), Bits[2:0]=001 (RX_TIME=1). Timeout for RX termination based on RSSI, carrier sense timeout = 1 \u00d7 0.1803 ms. MCSM1 0x17 0x02 Main Radio Control 1: <code>0x02</code> = Bits[5:4]=00 (CCA_MODE=always), Bits[3:2]=00 (RXOFF_MODE=IDLE), Bits[1:0]=10 (TXOFF_MODE=RX). After TX, automatically go to RX mode. MCSM0 0x18 0x14 Main Radio Control 0: <code>0x14</code> = Bits[5:4]=01 (FS_AUTOCAL=from IDLE to RX/TX), Bits[3:2]=01 (PO_TIMEOUT=149-155 \u03bcs), Bits[1:0]=00 (PIN_CTRL disabled). Auto-calibration on state transitions. FOCCFG 0x19 0x16 Frequency Offset Compensation: <code>0x16</code> = Bits[5:3]=010 (FOC_PRE_K=3K), Bits[2]=1 (FOC_POST_K=K/2), Bits[1:0]=10 (FOC_LIMIT=\u00b1BW/8). Compensates \u00b112.7 kHz frequency offset with 3K pre-sync gain, K/2 post-sync gain. BSCFG 0x1A 0x6C Bit Synchronization Config: <code>0x6C</code> = Bits[7:6]=01 (BS_PRE_KI=2KI), Bits[5:4]=10 (BS_PRE_KP=3KP), Bits[3:2]=11 (BS_POST_KI=KI), Bits[1:0]=00 (BS_POST_KP=KP). Clock recovery with 2KI/3KP pre-sync, KI/KP post-sync gains. AGCCTRL2 0x1B 0x03 AGC Control 2: <code>0x03</code> = Bits[7:6]=00 (MAX_DVGA_GAIN=all gain settings), Bits[5:3]=000 (MAX_LNA_GAIN=maximum), Bits[2:0]=011 (MAGN_TARGET=33 dB). AGC targets 33 dB channel amplitude with full gain range. AGCCTRL1 0x1C 0x4A AGC Control 1: <code>0x4A</code> = Bit[6]=1 (AGC_LNA_PRIORITY=1), Bits[5:4]=00 (CARRIER_SENSE_REL_THR=disabled), Bits[3:0]=1010 (CARRIER_SENSE_ABS_THR=-6 dB). LNA gain adjusted first, carrier sense at -6 dBm absolute threshold. AGCCTRL0 0x1D 0x91 AGC Control 0: <code>0x91</code> = Bits[7:6]=10 (HYST_LEVEL=medium), Bits[5:4]=01 (WAIT_TIME=16 samples), Bits[3:2]=00 (AGC_FREEZE=never), Bits[1:0]=01 (FILTER_LENGTH=16 samples). Medium hysteresis, 16-sample averaging. WOREVT1 0x1E 0x0C WOR Event0 Timeout High: <code>0x0C</code> = EVENT0[15:8] = 12\u2081\u2080. Combined with WOREVT0: EVENT0 = 0x0CF3 = 3315\u2081\u2080. WOR period = 3315 \u00d7 2\u2075 \u00d7 0.9765 ms = 103.4 seconds between wake-ups. WOREVT0 0x1F 0xF3 WOR Event0 Timeout Low: <code>0xF3</code> = EVENT0[7:0] = 243\u2081\u2080. Completes 16-bit timeout: 0x0CF3 = 3315\u2081\u2080 \u00d7 32 \u00d7 0.9765 ms = 103.4 second sleep periods for power saving. WORCTRL 0x20 0x49 WOR Control: <code>0x49</code> = Bit[7]=0 (RC_PD=normal), Bits[6:4]=100 (EVENT1=16), Bit[3]=1 (RC_CAL=enabled), Bits[2:0]=001 (WOR_RES=2\u2075 periods). RC oscillator calibration enabled, 32-period resolution, EVENT1 timeout. FREND1 0x21 0x56 Frontend RX Config: <code>0x56</code> = Bits[7:6]=01 (LNA_CURRENT), Bits[5:4]=01 (LNA2MIX_CURRENT), Bits[3:2]=01 (LODIV_BUF_CURRENT_RX), Bits[1:0]=10 (MIX_CURRENT). Optimized RX frontend current settings for sensitivity/power balance. FREND0 0x22 0x10 Frontend TX Config: <code>0x10</code> = Bits[7:4]=0001 (LODIV_BUF_CURRENT_TX), Bits[2:0]=000 (PA_POWER=0). PA power table index 0, optimized TX LO buffer current for power efficiency. FSCAL3 0x23 0xE9 Frequency Synthesizer Cal 3: <code>0xE9</code> = Bits[7:6]=11 (FSCAL3[7:6]), Bits[5:4]=10 (CHP_CURR_CAL_EN), Bits[3:0]=1001 (FSCAL3[3:0]). VCO calibration values for 868 MHz operation, charge pump current enabled. FSCAL2 0x24 0x2A Frequency Synthesizer Cal 2: <code>0x2A</code> = Bit[5]=1 (VCO_CORE_H_EN=high performance VCO), Bits[4:0]=01010 (FSCAL2[4:0]=10). High VCO current for stable 868 MHz synthesis with calibration value 10. FSCAL1 0x25 0x00 Frequency Synthesizer Cal 1: <code>0x00</code> = Bits[5:0]=000000 (FSCAL1[5:0]=0). Frequency synthesizer calibration result value 0, indicates optimal VCO calibration for target frequency. FSCAL0 0x26 0x1F Frequency Synthesizer Cal 0: <code>0x1F</code> = Bits[6:0]=0011111 (FSCAL0[6:0]=31). Frequency synthesizer calibration result value 31, fine-tunes VCO for precise 868.035 MHz operation. <p>Dynamic Configuration Changes</p> <p>While the burst write establishes the base configuration, some registers may be modified during runtime based on operational requirements. Parameters like power levels (PATABLE), WOR settings (WORCTRL), and calibration values (FSCAL registers) can be dynamically adjusted by the firmware to optimize performance or adapt to changing conditions.</p>"},{"location":"reverse-engineering/fm-basis-x-rf/#configuration","title":"Configuration","text":""},{"location":"reverse-engineering/fm-basis-x-rf/#key-rf-parameters","title":"Key RF Parameters","text":"<p>Based on the register analysis, the following key parameters were determined:</p> Parameter Value Calculation/Source Carrier Frequency 868.035400390625 MHz FREQ = 0x21656A = 2188650\u2081\u2080f = (26MHz/65536) \u00d7 2188650 Modulation GFSK MDMCFG2[6:4] = 001 Sync Word 0xD391 SYNC1=0xD3, SYNC0=0x91 Data Rate 38.383483886719 kBaud DRATE_E=10, DRATE_M=131Rate = ((256+131)\u00d72\u00b9\u2070\u00d726MHz)/(2\u00b2\u2078) Frequency Deviation \u00b147.607421875 kHz DEVIATION_E=3, DEVIATION_M=5Dev = (8+5)\u00d72\u00b3\u00d726MHz/2\u00b9\u2077 Channel Bandwidth 101.5625 kHz CHANBW_E=3, CHANBW_M=0BW = 26MHz/(8\u00d7(4+0)\u00d72\u00b3) Sync Mode 30/32 bits MDMCFG2[2:0] = 011 Preamble Length 4 bytes MDMCFG1[6:4] = 010 Packet Format Variable length PKTCTRL0[1:0] = 01 CRC Enable ON PKTCTRL0[2] = 1 Data Whitening ON PKTCTRL0[6] = 1 Address Check Disabled PKTCTRL1[1:0] = 00 Status Append Enabled PKTCTRL1[2] = 1 Channel Spacing 199.951171875 kHz CHANSPC_E=3, CHANSPC_M=153Spacing = ((256+153)\u00d72\u00b3\u00d726MHz)/(2\u00b9\u2078) Manchester Encoding Disabled MDMCFG2[3] = 0"},{"location":"reverse-engineering/fm-basis-x-rf/#power","title":"Power","text":"<p>The power amplifier (PA) configuration is set through the PATABLE and FREND0 registers:</p> Register Address Value Purpose PATABLE[0] 0x3E 0x03 PA Power Level 0: <code>0x03</code> = Minimum output power (~-30 dBm). Used for very short range communication or testing modes. PATABLE[1] 0x3E 0x0F PA Power Level 1: <code>0x0F</code> = Low output power (~-20 dBm). Used for close-proximity device communication within same room. PATABLE[2] 0x3E 0x1E PA Power Level 2: <code>0x1E</code> = Medium-low output power (~-15 dBm). Used for moderate range indoor communication. PATABLE[3] 0x3E 0x27 PA Power Level 3: <code>0x27</code> = Medium output power (~-10 dBm). Standard power level for normal indoor operation. PATABLE[4] 0x3E 0x50 PA Power Level 4: <code>0x50</code> = Medium-high output power (~-6 dBm). Used for extended indoor range or light outdoor use. PATABLE[5] 0x3E 0x81 PA Power Level 5: <code>0x81</code> = High output power (~0 dBm). Used for maximum indoor range or outdoor communication. PATABLE[6] 0x3E 0xCB PA Power Level 6: <code>0xCB</code> = Very high output power (~+5 dBm). Used for long-range outdoor communication. PATABLE[7] 0x3E 0xC2 PA Power Level 7: <code>0xC2</code> = Maximum output power (~+10 dBm). Highest power setting for maximum range, used sparingly to preserve battery. FREND0 0x22 0x17 Frontend TX Config: <code>0x17</code> = Bits[7:4]=0001 (LODIV_BUF_CURRENT_TX), Bits[2:0]=111 (PA_POWER=7). <p>Power Configuration</p> <p><code>FREND0</code> selects <code>PATABLE[7]</code> for maximum transmit power during normal operation.</p>"},{"location":"reverse-engineering/fm-basis-x-rf/#wake-on-radio-wor","title":"Wake-on-Radio (WOR)","text":"<p>The radio module uses Wake-on-Radio to minimize power consumption. The system alternates between active periods (<code>EVENT0</code>) and sleep periods, with automatic calibration during startup.</p> <p>Analysis Scope</p> <p>The parameters below are derived from the initial burst write configuration only. WOR functionality and operational behavior have not been extensively investigated since they are not utilized by the Genius Gateway implementation, which operates in continuous receive mode for real-time monitoring.</p> Parameter Value Behavior/Function Sleep Period (EVENT0) 103.376 seconds Device enters low-power sleep mode for ~1 minute 43 seconds between communication windows. Reduces average current consumption significantly. Wake Duration ~5-10 ms Active listening window where device monitors for incoming transmissions. Short duration minimizes power usage while maintaining responsiveness. Duty Cycle ~0.01% Extremely low duty cycle (active &lt;0.01% of time) enables months of battery operation while maintaining network connectivity. Calibration Mode Automatic RC oscillator automatically calibrates during startup and periodically during operation to maintain accurate timing despite temperature variations. Backup Timeout (EVENT1) 1654 seconds Secondary timeout (16\u00d7 EVENT0) provides backup wake-up mechanism if primary timer fails. Ensures device doesn't sleep indefinitely. RSSI Timeout 0.1803 ms Carrier sense timeout during wake periods. If signal detected, device stays active longer to receive complete packet transmission. RC Oscillator Mode Always Active RC oscillator remains powered during sleep (RC_PD=0) to maintain accurate WOR timing. Trades slight power increase for timing reliability. WOR Signal Output GDO0 Pin GDO0 configured as WOR_EVNT0 output (<code>0x24</code>) - pulses high when EVENT0 timeout occurs, can be used by microcontroller for wake-up coordination. Timing Resolution 32 Periods WOR_RES=001 sets 2\u2075 = 32 period resolution for wake-up timing, balancing power consumption with timing accuracy."},{"location":"reverse-engineering/protocol-analysis/","title":"Protocol Analysis","text":""},{"location":"reverse-engineering/protocol-analysis/#protocol-analysis","title":"Protocol Analysis","text":"<p>Deep dive into the Hekatron Genius Plus X communication protocol structure and behavior.</p>"},{"location":"reverse-engineering/protocol-analysis/#cc1101-packet-mode-structure","title":"CC1101 Packet Mode Structure","text":"<p>When the CC1101 operates in packet mode, all CC1101 packets are structured as follows. The packet format is determined by the configuration settings analyzed in the FM Basis X - RF section.</p>"},{"location":"reverse-engineering/protocol-analysis/#basic-packet-structure","title":"Basic Packet Structure","text":"<p>Based on the CC1101 configuration, each packet contains the following elements:</p> Field Byte Offset Size Content Description Configuration Source Preamble 0-3 4 bytes 0xAAAAAAAA Synchronization sequence for clock recovery MDMCFG1[6:4] = 010 Sync Word 4-5 2 bytes 0xD391 Packet detection pattern SYNC1=0xD3, SYNC0=0x91 Length 6 1 byte 0x01-0x3D Payload length (N bytes, max 59)<sup>1</sup> Variable length mode (PKTCTRL0[1:0]=01) Payload 7 to N+6 1-59<sup>1</sup> bytes Data (whitened) Application data with whitening applied. This section contains the Genius Plus X Packets Data whitening ON (PKTCTRL0[6]=1) CRC N+7 to N+8 2 bytes CRC-16 Error detection checksum over length + payload CRC enabled (PKTCTRL0[2]=1) Status N+9 to N+10 2 bytes RSSI + LQI Signal quality metrics appended by receiver Status append (PKTCTRL1[2]=1) <p>Where N = payload length (1-59 bytes in practice)</p>"},{"location":"reverse-engineering/protocol-analysis/#packet-fragmentation","title":"Packet Fragmentation","text":"<p>The Genius Plus X system does not utilize packet fragmentation. All communication fits within the 59-byte payload limit of a single physical packet, keeping the protocol simple and energy-efficient.</p> <p>Packet limit and fragmentation</p> <p>While the CC1101 supports variable packet lengths up to 255 bytes in theory, the physical packet size is limited to 64 bytes total, including length, payload, CRC, and status bytes (but excluding preamble and sync word).</p> <p>Max. application payload = 64 bytes (max. physical payload) - 1 byte (length) - 2 bytes (CRC) - 2 bytes (status) = 59 bytes</p>"},{"location":"reverse-engineering/protocol-analysis/#packet-timing","title":"Packet Timing","text":"<p>The CC1101 transmits at 38.383 kBaud with GFSK modulation:</p> <ul> <li>Bit duration: 26.045 \u03bcs per bit</li> <li>Byte duration: 208.36 \u03bcs per byte  </li> <li>Minimum physical packet: ~2.50 ms (12 bytes: 4+2+1+1+2+2 = preamble + sync + length + 1 byte payload + CRC + status)</li> <li>Maximum physical packet: ~14.58 ms (70 bytes: 4+2+1+59+2+2 = preamble + sync + length + 59 bytes payload + CRC + status)</li> <li>Typical Genius Plus packet: ~3-6 ms (15-30 total bytes including all overhead)</li> </ul>"},{"location":"reverse-engineering/protocol-analysis/#data-encoding","title":"Data Encoding","text":"<p>The payload undergoes several processing steps:</p> <ol> <li>Data Whitening: Applied to payload (not preamble/sync) for DC balance</li> <li>CRC Calculation: 16-bit CRC-CCITT over length + payload</li> <li>GFSK Modulation: \u00b147.6 kHz deviation around 868.035 MHz carrier</li> </ol>"},{"location":"reverse-engineering/protocol-analysis/#genius-plus-x-packets","title":"Genius Plus X Packets","text":"<p>Using the parameters described in FM Basis X - RF, it is possible to build a receiver that captures and stores packets from FM Basis X modules.</p> <p>The packets documented below were received during specific functional scenarios and can be categorized accordingly.</p> <p>No Encryption</p> <p>The Genius Plus communication appears to be unencrypted. This can be observed from the serial numbers that serve as identifiers within the packets and for packet routing.</p> <p>Although not all bytes of the packet payload have been identified and understood, the evidence suggests that communication is fundamentally unencrypted, which aligns with the goal of energy-efficient communication that minimizes processing overhead.</p>"},{"location":"reverse-engineering/protocol-analysis/#base-packet-structure","title":"Base Packet Structure","text":"<p>The following table shows the 27 bytes large part of a packet that was recognizable in all examined packets and appears to be part of all packets. Each packet begins with this common part, and depending on the packet type, additional information may be appended.</p>"},{"location":"reverse-engineering/protocol-analysis/#compact-view","title":"Compact view","text":"<pre><code>Byte offset |  0 |  1-2  |  3 |  4 |  5 |  6 |  7 |  8 |    9-12     | 13 |    14-17    |    18-21    |  22  | 23 | 24 | 25 | 26 |\nValue (hex) | 02 | XX XX | 00 | FF | FF | FF | FF | 00 | XX XX XX XX | 00 | XX XX XX XX | XX XX XX XX |  XX  | XX | XX | 00 | XX |\nField            | Pkt-# |                             |   Org-SN    |    |   Fwd-SN    |   Line-ID   | Hops |                   |\n</code></pre>"},{"location":"reverse-engineering/protocol-analysis/#detailed-explanation","title":"Detailed explanation","text":"Offset Length(bytes) Value Field Purpose/Description 0 1 <code>0x02</code> Unknown, seems to be constant 1-2 2 <code>CC18 - 0000</code>(<code>6.348 - 0</code>)little endian Pkt-# A packet repetition counter that decreases with each packet repetition. It is not entirely clear how the decrementation occurs (see Repetition for details). 3 1 <code>0x00</code> Unknown, seems to be constant 4 1 <code>0xFF</code> Unknown, seems to be constant 5 1 <code>0xFF</code> Unknown, seems to be constant 6 1 <code>0xFF</code> Unknown, seems to be constant 7 1 <code>0xFF</code> Unknown, seems to be constant 8 1 <code>0x00</code> Unknown, seems to be constant 9-12 4 <code>XX XX XX XX</code> Org-SN Serial number<sup>2</sup> of the FM Basis X radio module that originally sent this packetIt is assumed that this field does not change when the packet is forwarded, but this could not be confirmed as no multi-hop routing scenarios were observed. 13 1 <code>0x00</code> Unknown, seems to be constant 14-17 4 <code>XX XX XX XX</code>big endian Fwd-SN Serial number<sup>2</sup> of the FM Basis X radio module forwarding this packet.The first packet has identical Org-SN and Fwd-SN fields. If other FM Basis X radio modules forward the packet (acting as routers), they insert their own serial number. 18-21 4 <code>XX XX XX XX</code>big endian Line-ID The alarm line ID that this packet should affect.Special IDs:- <code>00 00 00 00 (0)</code>: The radio module is not (yet) assigned to any alarm line.- <code>FF FF FF FF</code> (4294967295): Broadcast (all alarm lines) 22 1 <code>0x0F - 0x00</code>(<code>15 - 0</code>) Hops This appears to be a hop counter for forwarded packets, tracking the number of times the packet has been retransmitted. The original packet always contains <code>0x0F</code>, which is reduced to <code>0x0E</code> after the first forwarding. This suggests that the field is decremented by one with each subsequent forwarding. 23 1 <code>XX</code> Unknown 24 1 <code>XX</code> Unknown 25 1 <code>0x00</code> Unknown, seems to be constant 26 1 <code>XX</code> Unknown"},{"location":"reverse-engineering/protocol-analysis/#repetition","title":"Repetition","text":"<p>All packets are transmitted multiple times by the radio module. The packets are sent with a period of approximately 10 ms. The repeated packets are identical except for the <code>Pkt-#</code> field (see Base Packet Structure). The <code>Pkt-#</code> field starts with an individual initial value in the first packet, which is decremented with each repetition.</p> <p>The number of repetitions, the exact period for packet repetitions, as well as the initial value and decrementation slightly differ depending on the packet type:</p> Packet Type Repetitions\\(N\\) Period Time\\(T\\) Initial Pkt-#\\(PC_{Start}\\) Pkt-# Decrement\\(\\Delta=\\frac{PC_{Start}}{N - 1}\\) Alarm Line Commissioning 309 x ~10.06 ms 6.348 (CC 18) ~20,6 Alarming (Start/Stop) 315 x ~9.85 ms 6.348 (CC 18) ~20,2 Line Test (Start/Stop) 370 x ~8,40 ms 6.348 (CC 18) ~17,2 Discovery Request 26 x ~8,19 ms 427 (AB 01) ~17,1 Discovery Response 24 x ~9,02 ms 427 (AB 01) ~18,6 <p>Pkt-# decrement</p> <p>It can be observed that the decrement is not constant across packet repetitions but exhibits a certain amount of jitter. This is likely caused by a higher-resolution underlying counter whose value may vary slightly with each iteration and is then rounded and stored as an unsigned integer in the <code>Pkt-#</code> field.</p> <p>Furthermore, it is notable that the average decrement approximately equals twice the period time \\(T\\), which corresponds to the count value of a 2 kHz clock. The initial value \\(PC_{Start}\\) thereby corresponds to twice the duration of the entire transmission process (across all repetitions) in milliseconds.</p>"},{"location":"reverse-engineering/protocol-analysis/#specific-packets","title":"Specific Packets","text":"<p>The following section describes the structure of specific packets that were received and analyzed in connection with various Genius Plus X functions.</p>"},{"location":"reverse-engineering/protocol-analysis/#alarm-line-commissioning","title":"Alarm Line Commissioning","text":"<p>The packet described here occurs when functions for commissioning or establishing an alarm line are used, such as initial commissioning, when devices are subsequently added to the alarm line, and possibly other scenarios.</p>"},{"location":"reverse-engineering/protocol-analysis/#observations","title":"Observations","text":"<p>When commissioning is initiated via the radio module of a smoke detector that is already part of an alarm line, the stored alarm line ID is used in both the <code>Line-ID</code> and <code>New Line-ID</code> fields. This method allows new smoke detectors (i.e., corresponding radio modules that have not yet stored an alarm line ID) to be added to the existing alarm line. For this purpose, commissioning packets are responded to by all radio modules without an assigned alarm line ID, as well as only by smoke detectors (i.e. their radio modules) that have the same alarm line ID stored (i.e., are part of the initiating alarm line).</p> <p>When commissioning is initiated via a new radio module (i.e., not yet assigned to an alarm line or assignment deleted), the <code>Line-ID</code> field contains the value <code>00 00 00 00</code> and a generated alarm line ID is entered in the <code>New Line-ID</code> field. All radio modules not yet assigned (i.e., radio modules without a stored alarm line ID) signal their readiness for commissioning and, upon confirmation, store the alarm line ID proposed in <code>New Line-ID</code>.</p> <p>The principle by which new alarm line IDs are generated is not fully understood.</p>"},{"location":"reverse-engineering/protocol-analysis/#basic-properties","title":"Basic properties","text":"<ul> <li>Overall packet length: 37 bytes</li> <li>Repititions: 309 </li> <li>Forwarded within network: yes</li> </ul>"},{"location":"reverse-engineering/protocol-analysis/#compact-view-complete","title":"Compact view (complete)","text":"<pre><code>Byte offset |  0 |  1-2  |  3 |  4 |  5 |  6 |  7 |  8 |    9-12     | 13 |    14-17    |    18-21    |  22  | 23 | 24 | 25 | 26 | 27 |    28-31    | 32 | 33 | 34 | 35 | 36 |\nValue (hex) | 02 | XX XX | 00 | FF | FF | FF | FF | 00 | XX XX XX XX | 00 | XX XX XX XX | XX XX XX XX |  XX  | XX | XX | 00 | XX | 03 | XX XX XX XX | XX | XX | XX | 00 | 00 |\nField            | Pkt-# |                             |   Org-SN    |    |   Fwd-SN    |   Line-ID   | Hops |                        | New Line-ID | Ho | Mi | Se |         |\n</code></pre>"},{"location":"reverse-engineering/protocol-analysis/#detailed-explanation-delta","title":"Detailed explanation (delta)","text":"Offset Length(bytes) Value Field Purpose/Description 0-26 27 See Base Packet Structure for details on the common packet part. 27 1 <code>0x03</code> Unknown, seems to be constant 28-31 4 <code>XX XX XX XX</code>big endian New Line-ID The alarm line ID to be assigned during commissioning.<ul><li>When initiated by an already commissioned device: Contains the existing alarm line ID (same as <code>Line-ID</code>).</li><li>When initiated by a new device: Contains a newly generated alarm line ID (while <code>Line-ID</code> is <code>00 00 00 00</code>).</li></ul>See Observations for more details. 32 1 <code>XX</code> Ho(urs) Hour of the smoke detector's current time in format <code>0-23</code>h 33 1 <code>XX</code> Mi(nutes) Minute of the smoke detector's current time in format <code>0-59</code>min 34 1 <code>XX</code> Se(conds) Second of the smoke detector's current time in format <code>0-59</code>s 35 1 <code>0x00</code> Unknown, seems to be constant 36 1 <code>0x00</code> Unknown, seems to be constant"},{"location":"reverse-engineering/protocol-analysis/#alarming-startstop","title":"Alarming (Start/Stop)","text":"<p>The packets described here serve to signal the detection of smoke by an individual smoke detector to all other smoke detectors of an alarm line, so that they also signal the detected smoke. The exact signaling behavior of the smoke detectors can be found in the operating instructions.</p>"},{"location":"reverse-engineering/protocol-analysis/#observations_1","title":"Observations","text":"<ul> <li> <p>Each smoke detector whose smoke sensor detects smoke sends a Start Alarming packet:</p> <ul> <li>The <code>Org-SN</code> and <code>Fwd-SN</code> fields contain the serial number of the radio module of the detecting smoke detector</li> <li>The <code>Start</code> field contains the value <code>0x01</code></li> <li>The <code>Stop</code> field contains the value <code>0x00</code></li> <li>The <code>Detector</code> field contains the serial number of the detecting smoke detector (not its radio module!)</li> </ul> </li> <li> <p>Each smoke detector that receives a Start Alarming packet signals the smoke itself (acoustically and optically) and forwards the Start Alarming packet as follows:</p> <ul> <li>The serial number of the forwarding radio module is entered in the <code>Fwd-SN</code> field</li> <li>The value of the <code>Hops</code> field is decremented by <code>1</code></li> </ul> </li> <li> <p>If the smoke sensor of a detecting smoke detector no longer detects smoke, it sends a Stop Alarming packet as follows:</p> <ul> <li>The <code>Org-SN</code> and <code>Fwd-SN</code> fields contain the serial number of the radio module of the no-longer-detecting smoke detector</li> <li>The <code>Stop</code> field contains the value <code>0x01</code></li> <li>The <code>Start</code> field contains the value <code>0x00</code></li> <li>The <code>Detector</code> field contains the serial number of the no-longer-detecting smoke detector (not its radio module!)</li> </ul> </li> <li> <p>Each smoke detector that receives a Stop Alarming packet stops its own signaling and forwards the Stop Alarming packet as follows:</p> <ul> <li>The serial number of the forwarding radio module is entered in the <code>Fwd-SN</code> field</li> <li> <p>The value of the <code>Hops</code> field is decremented by <code>1</code></p> <p>Question</p> <p>It is not known whether non-detecting but signaling smoke detectors individually store all detecting smoke detectors whose Start Alarming packets they have already received and forwarded, and only stop their own signaling when a Stop Alarming packet has been received from all detecting smoke detectors.</p> </li> </ul> </li> <li> <p>If the test button is pressed on a signaling but non-detecting smoke detector, the radio module generates a Stop Alarming packet that silences all non-detecting smoke detectors:</p> <ul> <li>The <code>Org-SN</code> and <code>Fwd-SN</code> fields contain the serial number of the radio module of the smoke detector on which the test button was pressed</li> <li>The <code>Stop</code> field contains the value <code>0x01</code></li> <li>The <code>Start</code> field contains the value <code>0x00</code></li> <li> <p>The <code>Detector</code> field contains the serial number of the smoke detector (not its radio module!) on which the test button was pressed</p> <p>Tip</p> <p>Because <code>Detector</code> does not contain the serial number of a detecting smoke detector, another radio module receiving the Stop Alarming packet could evaluate whether it originates from a detecting or \"merely\" signaling smoke detector.</p> </li> </ul> </li> <li> <p>If the test button is pressed on a detecting smoke detector, the radio module generates a Stop Alarming packet that silences all smoke detectors:</p> <ul> <li>The <code>Org-SN</code> and <code>Fwd-SN</code> fields contain the serial number of the radio module of the smoke detector on which the test button was pressed</li> <li>The <code>Stop</code> field contains the value <code>0x01</code></li> <li>The <code>Start</code> field contains the value <code>0x00</code></li> <li>The <code>Detector</code> field contains the serial number of the smoke detector ( not its radio module!) on which the test button was pressed</li> </ul> </li> </ul> <p>Start/Stop Mutual Exclusion</p> <p>The behavior of smoke detectors when both the <code>Start</code> field and the <code>Stop</code> field are set to <code>0x01</code> in a packet is not known.</p>"},{"location":"reverse-engineering/protocol-analysis/#basic-properties_1","title":"Basic properties","text":"<ul> <li>Overall packet length: 36 bytes</li> <li>Repititions: 315 </li> <li>Forwarded within network: yes</li> </ul>"},{"location":"reverse-engineering/protocol-analysis/#compact-view-complete_1","title":"Compact view (complete)","text":"<pre><code>Byte offset |  0 |  1-2  |  3 |  4 |  5 |  6 |  7 |  8 |    9-12     | 13 |    14-17    |    18-21    |  22  | 23 | 24 | 25 | 26 | 27 |   28  | 29 |  30  | 31 |    32-35    |\nValue (hex) | 02 | XX XX | 00 | FF | FF | FF | FF | 00 | XX XX XX XX | 00 | XX XX XX XX | XX XX XX XX |  XX  | XX | XX | 00 | 00 | 00 |   XX  | 00 |  XX  | 00 | XX XX XX XX |\nField            | Pkt-# |                             |   Org-SN    |    |   Fwd-SN    |   Line-ID   | Hops |                        | Start |    | Stop |    |  Detector   |\n</code></pre>"},{"location":"reverse-engineering/protocol-analysis/#detailed-explanation-delta_1","title":"Detailed explanation (delta)","text":"Offset Length(bytes) Value Field Purpose/Description 0-26 27 See Base Packet Structure for details on the common packet part. 27 1 <code>0x00</code> Unknown, seems to be constant 28 1 <code>XX</code> Start Start flag<code>0x01</code>: Starting fire alarm<code>0x00</code>: Otherwise 29 1 <code>0x00</code> Unknown, seems to be constant 30 1 <code>XX</code> Stop Stop flag<code>0x01</code>: Stopping or silencing alarming<code>0x00</code>: Otherwise 31 1 <code>0x00</code> Unknown, seems to be constant 32-35 4 <code>XX XX XX XX</code> little endian Detector Serial number of the smoke detector (not its radio module!) that (initially) detected smoke."},{"location":"reverse-engineering/protocol-analysis/#line-test-startstop","title":"Line Test (Start/Stop)","text":"<p>The line test function can be used to verify or confirm the membership of smoke detectors to an alarm line. When the line test is initiated, all smoke detectors on the same alarm line as the initiating smoke detector signal their presence. For more information on performing the line test, please refer to the smoke detector's operating instructions.</p> <p>The <code>Line-ID</code> field contains the ID of the alarm line for which the line test should be started or stopped.</p> <p>Line tests can be initiated or stopped from the Genius Gateway for known alarm lines. Further details can be found in Alarm Lines Management.</p>"},{"location":"reverse-engineering/protocol-analysis/#basic-properties_2","title":"Basic properties","text":"<ul> <li>Overall packet length: 29 bytes</li> <li>Repititions: 370 </li> <li>Forwarded within network: yes</li> </ul>"},{"location":"reverse-engineering/protocol-analysis/#compact-view-complete_2","title":"Compact view (complete)","text":"<pre><code>Byte offset |  0 |  1-2  |  3 |  4 |  5 |  6 |  7 |  8 |    9-12     | 13 |    14-17    |    18-21    |  22  | 23 | 24 | 25 | 26 | 27 |     28     |\nValue (hex) | 02 | XX XX | 00 | FF | FF | FF | FF | 00 | XX XX XX XX | 00 | XX XX XX XX | XX XX XX XX |  XX  | XX | XX | 00 | XX | 04 |     XX     |\nField            | Pkt-# |                             |   Org-SN    |    |   Fwd-SN    |   Line-ID   | Hops |                        | Start/Stop |\n</code></pre>"},{"location":"reverse-engineering/protocol-analysis/#detailed-explanation-delta_2","title":"Detailed explanation (delta)","text":"Offset Length(bytes) Value Field Purpose/Description 0-26 27 See Base Packet Structure for details on the common packet part. 27 1 <code>0x04</code> Unknown, seems to be constant 28 1 <code>XX</code> Start/Stop <code>0x06</code>: Start/Perform line test<code>0x00</code>: Stop line test"},{"location":"reverse-engineering/protocol-analysis/#discovery-request","title":"Discovery Request","text":"<p>It is not confirmed that this packet is actually a request for discovering smoke detectors. Rather, this designation was chosen based on conclusions drawn from the observed packets and protocol behavior.</p>"},{"location":"reverse-engineering/protocol-analysis/#observations_2","title":"Observations","text":"<p>These packets occur in connection with commissioning. Once the initiating radio module has sent the Alarm Line Commissioning Packet, these Discovery Requests are sometimes (the exact conditions are not known) additionally transmitted. In my experiments, these requests were answered with Discovery Response Packets. The radio module serial numbers contained in them did not belong to my own radio modules and were unknown to me.</p> <p>Since many residential units in my apartment complex are equipped with smoke detectors from the Hekatron Genius Plus X  system, my current assumption is that the Discovery Response Packets could originate from smoke detectors (i.e. their radio modules) belonging to my neighbors. It may also specifically be their unnetworked smoke detectors, i.e., those that are installed in the base but for which commissioning (to register them in an alarm line) has not been performed.</p> <p>Furthermore, it appears that each radio module (in its own smoke detector network) that either receives the Discovery Request or is involved in the ongoing commissioning also sends the Discovery Request itself (not forwarding it, but initiating it with its own serial number). Each radio module that sent a Discovery Request itself responded to the other requests with its own Discovery Response.</p> <p>Hypothesis</p> <p>Since this packet type is not forwarded by other radio modules, only smoke detectors within direct transmission/reception range of the initiating module can respond. Thus, this part of the protocol could serve to allow smoke detectors to detect all other directly reachable smoke detectors in their vicinity.</p> <p>I do not know whether the Hekatron Genius Plus X  system implements routing in any way, since I have not found any indication of an addressed recipient in the packet structure so far, but such a discovery function could serve to establish routes in such a case.</p> <p>Perhaps the mechanism is also used to prevent forwarding cycles. There is also no definitive evidence or investigation for this either.</p>"},{"location":"reverse-engineering/protocol-analysis/#basic-properties_3","title":"Basic properties","text":"<ul> <li>Overall packet length: 28 bytes</li> <li>Repititions: 26 </li> <li>Forwarded within network: no</li> </ul>"},{"location":"reverse-engineering/protocol-analysis/#compact-view-complete_3","title":"Compact view (complete)","text":"<pre><code>Byte offset |  0 |  1-2  |  3 |  4 |  5 |  6 |  7 |  8 |    9-12     | 13 |    14-17    |    18-21    |  22  | 23 | 24 | 25 | 26 | 27 |\nValue (hex) | 02 | XX XX | 00 | FF | FF | FF | FF | 00 | XX XX XX XX | 00 | XX XX XX XX | XX XX XX XX |  XX  | XX | XX | 00 | XX | 00 |\nField            | Pkt-# |                             |   Org-SN    |    |   Fwd-SN    |   Line-ID   | Hops |\n</code></pre>"},{"location":"reverse-engineering/protocol-analysis/#detailed-explanation-delta_3","title":"Detailed explanation (delta)","text":"Offset Length(bytes) Value Field Purpose/Description 0-26 27 See Base Packet Structure for details on the common packet part. 27 1 <code>0x00</code> Unknown, seems to be constant"},{"location":"reverse-engineering/protocol-analysis/#discovery-response","title":"Discovery Response","text":"<p>Like Discovery Requests it is not confirmed that this packet is actually the response to a previous request for discovering smoke detectors. Rather, this designation was chosen based on conclusions drawn from the observed packets and protocol behavior.</p>"},{"location":"reverse-engineering/protocol-analysis/#observations_3","title":"Observations","text":"<p>Radio modules seem to respond with this packet to a previous Discovery Request. The <code>Org-SN</code> and <code>Fwd-SN</code> fields are populated with the serial number of the responding radio module. Additionally, the <code>Req-SN</code> field contains the serial number of the requesting radio module. This makes it possible to identify which requesting radio module the response is intended for.</p> <p>Further details are described in the Discovery Request section.</p>"},{"location":"reverse-engineering/protocol-analysis/#basic-properties_4","title":"Basic properties","text":"<ul> <li>Overall packet length: 32 bytes</li> <li>Repititions: 24 </li> <li>Forwarded within network: no</li> </ul>"},{"location":"reverse-engineering/protocol-analysis/#compact-view-complete_4","title":"Compact view (complete)","text":"<pre><code>Byte offset |  0 |  1-2  |  3 |  4 |  5 |  6 |  7 |  8 |    9-12     | 13 |    14-17    |    18-21    |  22  | 23 | 24 | 25 | 26 | 27 |    28-31    |\nValue (hex) | 02 | XX XX | 00 | FF | FF | FF | FF | 00 | XX XX XX XX | 00 | XX XX XX XX | XX XX XX XX |  XX  | XX | XX | 00 | XX | 01 | XX XX XX XX |\nField            | Pkt-# |                             |   Org-SN    |    |   Fwd-SN    |   Line-ID   | Hops |                        |   Req-SN    |\n</code></pre>"},{"location":"reverse-engineering/protocol-analysis/#detailed-explanation-delta_4","title":"Detailed explanation (delta)","text":"Offset Length(bytes) Value Field Purpose/Description 0-26 27 See Base Packet Structure for details on the common packet part. 27 1 <code>0x01</code> Unknown, seems to be constant 28-31 4 <code>XX XX XX XX</code>big endian Req-SN Serial number of the radio module that sent the original Discovery Request.This field allows the requesting module to identify that this response is directed to its specific request, enabling proper association between requests and responses in environments with multiple simultaneous discovery operations. <ol> <li> <p>See Packet Fragmentation section for details on the 64-byte total packet size limit that constrains the maximum payload to 59 bytes in practice.\u00a0\u21a9\u21a9</p> </li> <li> <p>Genius Gateway uses FF FF FF FE (4294967294) as serial number when it sends packets. See Alarm Lines Management for more information.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"reverse-engineering/protocol-captures/","title":"Protocol Captures","text":""},{"location":"reverse-engineering/protocol-captures/#protocol-captures","title":"Protocol Captures","text":"<p>Logic analyzer traces for CC1101 communication, as well as UART and EEPROM communication, can be found here.</p>"},{"location":"reverse-engineering/protocol-captures/#peripheral-interfaces","title":"Peripheral Interfaces","text":"<p>The radio module's microcontroller communicates with three peripheral devices using two serial interfaces.</p> <p>The MSP430 communicates with the CC1101 RF transceiver and the EEPROM via a shared SPI bus .</p> <p>The MSP430 communicates via the 6-pin header with the smoke detector's microcontroller over a 2-wire UART .</p>"},{"location":"reverse-engineering/protocol-captures/#logic-analyzer","title":"Logic Analyzer","text":""},{"location":"reverse-engineering/protocol-captures/#measurement-device","title":"Measurement Device","text":"<p>For recording the serial communication, I used the DSLogic U3Pro16  logic analyzer, which was very well suited for this task.</p>"},{"location":"reverse-engineering/protocol-captures/#software","title":"Software","text":"<p>The logic analyzers from DreamSourceLab  use the freely available open-source software DSView  ( GitHub Repository ) for visualizing and exporting traces. DSView can also be used without a logic analyzer to load and analyze traces.</p> <p>DSView is a clone of the open-source tool PulseView (sigrok)  ( GitHub Repository ).</p>"},{"location":"reverse-engineering/protocol-captures/#decoders","title":"Decoders","text":"<p>The performance of an analysis tool like DSView or PulseView is largely determined by the number and analysis scope of supported buses and protocols. Multi-layer protocol decoder stacks significantly facilitate evaluation.</p> <p>The following decoders should be installed for evaluating the trace files: </p>"},{"location":"reverse-engineering/protocol-captures/#trace-files","title":"Trace files","text":"File Content CC1101 EEPROM UART  startup_new-rm.dsl Radio module is plugged onto the smoke detector.  mounting-to-base.dsl Interface communication when the smoke detector (with attached radio module) is twisted into the base.  comissioning-master.dsl Interface communication of the radio module that initiates commissioning.  comissioning-slave.dsl Interface communication of the radio module that participates in commissioning.  linetest-start-stop.dsl Alarm line test is started and stopped.  firealarm-start-stop.dsl Fire alarm is triggered and ended on a smoke detector."},{"location":"reverse-engineering/uart-analysis/","title":"UART Analysis","text":""},{"location":"reverse-engineering/uart-analysis/#uart-analysis","title":"UART Analysis","text":"<p>Analysis of the UART communication has not yet been completed.</p> <p>However, the Trace files contain some recorded UART communication.</p> <p>There seems to be some kind of header byte, specifying the purpose/meaning of the transmission.</p> <p>At the end of every transmission, an error recognition byte (XOR) is appended.</p> <p>In some transmissions, known structures and values can be found, such as serial numbers, time, and date.</p> <p></p>"},{"location":"setup/","title":"Setting up Genius Gateway","text":""},{"location":"setup/#setting-up-genius-gateway","title":"Setting up Genius Gateway","text":"<p>This guide walks you through the complete setup process for Genius Gateway, from initial hardware assembly and software installation to network configuration and integration with your smart home system.</p>"},{"location":"setup/#setup-pages","title":"Setup Pages","text":""},{"location":"setup/#general-setup","title":"General Setup","text":"<p>The foundation of your Genius Gateway deployment. This page covers:</p> <ul> <li>Hardware Assembly: Experimental breadboard setup or final PCB assembly</li> <li>Development Environment: Installing VSCode with Pioarduino IDE</li> <li>Software Build: Cloning repository, configuring target board, building firmware</li> <li>Initial Flash: Uploading firmware and accessing the web interface for the first time</li> <li>Basic connectivity: Connecting to WiFi network and to MQTT broker, setting up user authorization</li> </ul>"},{"location":"setup/#configure-gateway","title":"Configure Gateway","text":"<p>Smoke detector and alarm line configuration for full functionality:</p> <ul> <li>Integration Levels: Basic alarm detection (no configuration), advanced device integration (Home Assistant), alarm line functions (line tests, fire alarm tests)</li> <li>Adding Smoke Detectors: Import from backup, manual entry with serial numbers, automatic discovery</li> <li>Alarm Line Configuration: Import from backup, manual registration, automatic discovery via line test</li> </ul>"},{"location":"setup/#connections","title":"Connections","text":"<p>External service integration for smart home and time synchronization:</p> <ul> <li>MQTT Configuration: Connect to MQTT broker (encrypted/unencrypted), configure authentication and connection parameters, set up simple alarm publishing and Home Assistant MQTT Discovery</li> <li>NTP Setup: Configure time server, select timezone with automatic DST handling, ensure accurate timestamps for logging</li> </ul>"},{"location":"setup/#wifi","title":"WiFi","text":"<p>Network connectivity configuration for both normal operation and fallback scenarios:</p> <ul> <li>WiFi Station Mode: Connect as a client to your existing WiFi network, configure hostname (mDNS), manage multiple networks with priority or signal strength selection</li> <li>Access Point Mode: Provide fallback WiFi network for initial setup or when station connection fails, configure SSID, password, channel, and IP addressing</li> </ul>"},{"location":"setup/#users","title":"Users","text":"<p>Security and access control configuration:</p> <ul> <li>User Accounts: Create, edit, and delete users with different privilege levels (admin/guest)</li> <li>JWT Security: Configure JWT secret for authentication token generation</li> <li>Authentication Flow: Understand login process, session management, and token-based authentication</li> </ul>"},{"location":"setup/#system","title":"System","text":"<p>Ongoing monitoring, maintenance, and firmware management:</p> <ul> <li>System Status: Real-time monitoring of hardware, memory, network, and radio module status</li> <li>Diagnostics: System metrics, check radio module connectivity, download core dump</li> <li>Firmware Updates: OTA updates, upload new firmware</li> <li>Device Actions: Restart, factory reset</li> </ul>"},{"location":"setup/configure-gateway/","title":"Configure Genius Gateway","text":""},{"location":"setup/configure-gateway/#configure-genius-gateway","title":"Configure Genius Gateway","text":""},{"location":"setup/configure-gateway/#integration-level","title":"Integration Level","text":""},{"location":"setup/configure-gateway/#basic-function","title":"Basic Function","text":"<p>The simplest setup that can detect fire alarms from nearby radio-networked Genius Plus X smoke detectors and forward them to a smart home system without explicit configuration of smoke detectors and alarm lines in Genius Gateway is:</p> <ul> <li>Basic configuration (WiFi, MQTT broker) has been  performed</li> <li>Processing of alarms from unknown smoke detectors is enabled in the Gateway Settings</li> <li>Simple Alarm Publishing via a central topic is configured</li> </ul>"},{"location":"setup/configure-gateway/#advanced-integration-home-assistant-compatible","title":"Advanced Integration (Home Assistant Compatible)","text":"<p>If existing radio-networked Genius Plus X smoke detectors are to be integrated as devices in Home Assistant, they must be added in Genius Gateway.</p> <p>More details about the possibilities in interaction with Home Assistant are described in Smart Home Integration.</p> <p>Changes to the configuration in Genius Gateway (e.g., adjusting the location) are also synchronized to Home Assistant.</p>"},{"location":"setup/configure-gateway/#alarm-line-functions","title":"Alarm Line Functions","text":"<p>Additional functions are available when alarm lines are configured in Genius Gateway:</p> <ul> <li>Line tests</li> <li>Fire alarm tests</li> </ul>"},{"location":"setup/configure-gateway/#adding-smoke-detectors","title":"Adding Smoke Detectors","text":""},{"location":"setup/configure-gateway/#importing-smoke-detectors","title":"Importing Smoke Detectors","text":"<p>If smoke detectors were previously configured and exported with Genius Gateway, they can be imported again.</p>"},{"location":"setup/configure-gateway/#manually-adding-smoke-detectors","title":"Manually Adding Smoke Detectors","text":"<p>To add smoke detectors, proceed as follows:</p> <ol> <li>Twist the smoke detector out of the socket.</li> <li>Determine the serial number and production date of the radio module and the smoke detector and write them down</li> <li>Add the smoke detector in the Genius Gateway web interface</li> </ol> <p>Repeat these steps for each smoke detector that should be integrated into Home Assistant.</p>"},{"location":"setup/configure-gateway/#determining-serial-numbers-and-production-dates","title":"Determining Serial Numbers and Production Dates","text":"<p>The Genius Plus X smoke detectors come in two variants, which can be distinguished by the color of the batteries:</p> <ul> <li>Purple batteries: older version</li> <li>Blue batteries: newer version</li> </ul>"},{"location":"setup/configure-gateway/#older-smoke-detector-version","title":"Older Smoke Detector Version","text":"<p>On the older smoke detector version, the serial number of the smoke detector is unfortunately covered by the radio module. To read the serial number, the radio module must be temporarily removed.</p> <p>Meaning of the markings:</p> <ul> <li>Serial number and production date of the smoke detector</li> <li>Serial number and production date of the radio module</li> </ul> <ul> <li> <p></p> <p>Older detector with mounted radio module The radio module covers the smoke detector's serial number.</p> </li> <li> <p></p> <p>Older detector without radio module As soon as the radio module is removed, the smoke detector's serial number is revealed.</p> </li> </ul> <p>New Commissioning Required</p> <p>When the radio module is removed from the smoke detector, the radio module loses its association with an alarm line. After reading the serial number of the smoke detector and correctly placing the radio module back on the smoke detector, commissioning for alarm line formation must be performed again according to the manufacturer's instructions.</p>"},{"location":"setup/configure-gateway/#newer-smoke-detector-version","title":"Newer Smoke Detector Version","text":"<p>On the newer smoke detector version, the serial number of the smoke detector can be read without removing the radio module.</p> <p>Meaning of the markings:</p> <ul> <li>Serial number and production date of the smoke detector</li> <li>Serial number and production date of the radio module</li> </ul> <ul> <li> <p></p> <p>Newer detector with mounted radio module The serial number is perfectly readable on the newer detector version.</p> </li> <li> <p></p> <p>Newer detector with revealed production date To read the production date more easily, the radio module can be slightly lifted without interrupting the connection between radio module and smoke detector.</p> </li> </ul> <p>Radio Module Must Remain Securely Connected</p> <p>If the radio module has been lifted too much so that the connection to the smoke detector was interrupted, the radio module has also lost its association with an alarm line. This can be recognized by the fact that the test button of the radio module lights up green-yellow-red after screwing it back into the socket.</p> <p>In this case, commissioning for alarm line formation must be performed again according to the manufacturer's instructions.</p>"},{"location":"setup/configure-gateway/#adding-alarm-lines","title":"Adding Alarm Lines","text":"<p>There are three ways to configure alarm lines:</p> <ol> <li>Import from a backup (not recommended)</li> <li>Manual addition (not recommended)</li> <li>Alarm line discovery (recommended)</li> </ol>"},{"location":"setup/configure-gateway/#import","title":"Import","text":"<p>Import Alarm Lines Only in Exceptional Cases</p> <p>Alarm lines should only be imported for testing and development purposes, as after import it cannot be guaranteed that the actual alarm lines still correspond to those previously configured.</p> <p>Importing alarm lines is done through the web interface.</p>"},{"location":"setup/configure-gateway/#manually-adding-alarm-lines","title":"Manually Adding Alarm Lines","text":"<p>Manually Add Alarm Lines Only in Exceptional Cases</p> <p>Alarm lines should only be manually added for testing and development purposes, as after creation it cannot be guaranteed that the actual alarm lines correspond to those manually specified.</p> <p>Manually adding alarm lines is done through the web interface.</p>"},{"location":"setup/configure-gateway/#alarm-line-discovery","title":"Alarm Line Discovery","text":"<p>This is the safest method to determine and save the currently existing alarm line (or alarm lines).</p> <ol> <li>Log in to the Genius Gateway web interface.</li> <li>Make sure that automatic addition of alarm lines from all received packet types is enabled in the Gateway Settings.</li> <li>Switch to Alarm Line Management in the web interface.</li> <li> <p>Initiate a line test on one of the installed smoke detectors for an existing alarm line according to the manufacturer's operating instructions:</p> <ul> <li>Twist a smoke detector of an alarm line out of the socket</li> <li>Shortly press (&lt; 5 seconds) the red control button on the radio module</li> </ul> <p>All reachable and functional smoke detectors will now begin to signal the test. Let the line test run until the new alarm line is visible in the web interface. 5. Abort the line test: - Shortly press the red control button again - Twist the smoke detector back into the socket 6. Edit the alarm line and give it a meaningful name.</p> </li> </ol> <p>Repeat the procedure if multiple alarm lines should be configured.</p>"},{"location":"setup/connections/","title":"Connections","text":""},{"location":"setup/connections/#connections","title":"Connections","text":"<p>The Connections pages configure external network services that the Genius Gateway can integrate with, including MQTT for smart home integration and NTP for accurate time synchronization.</p>"},{"location":"setup/connections/#mqtt","title":"MQTT","text":"<p>MQTT (Message Queuing Telemetry Transport) is a lightweight messaging protocol ideal for IoT devices and smart home integration. The Genius Gateway can publish device states and alarm events to an MQTT broker for integration with home automation systems like Home Assistant.</p> <p></p>"},{"location":"setup/connections/#mqtt-status","title":"MQTT Status","text":"<p>The MQTT status section displays self-explaning real-time connection information.</p>"},{"location":"setup/connections/#general-settings","title":"General Settings","text":"<p>Click the General Settings collapsible section to configure MQTT connection parameters.</p> <p>Administrator Access Required</p> <p>MQTT settings can only be modified by users with administrator privileges.</p>"},{"location":"setup/connections/#connection-settings","title":"Connection Settings","text":"<p>Enable MQTT</p> <p>Toggle to enable or disable MQTT functionality. When disabled, no MQTT connections or publishing occur.</p> <p>URI</p> <p>The MQTT broker URI including protocol and port. Supported formats:</p> <ul> <li>Unencrypted, for example<ul> <li><code>mqtt://broker.hivemq.com</code> or</li> <li><code>mqtt://broker.hivemq.com:1883</code> or</li> <li><code>mqtt://192.168.1.100:1883</code></li> </ul> </li> <li>Encrypted (TLS/SSL), for example<ul> <li><code>mqtts://mqtt.example.com</code> or</li> <li><code>mqtts://mqtt.example.com:8883</code> or</li> </ul> </li> </ul> <p>Common MQTT ports:</p> <ul> <li>1883 for unencrypted MQTT (use <code>mqtt://</code> protocol)</li> <li>8883 for MQTT over TLS/SSL (use <code>mqtts://</code> protocol)</li> </ul> <p>Validation</p> <p>The URI must include the protocol (<code>mqtt://</code> or <code>mqtts://</code>) and a valid hostname or IP address.</p> <p>Username</p> <p>Optional username for MQTT broker authentication. Leave empty if the broker doesn't require authentication.</p> <p>Password</p> <p>Optional password for MQTT broker authentication. Leave empty if the broker doesn't require authentication.</p> <p>Password Storage</p> <p>Passwords are stored unencrypted in the device's file system. Ensure physical access to the device is restricted.</p> <p>Client ID</p> <p>Unique identifier for this MQTT client. Each device connecting to the same broker must have a unique client ID.</p> <p>Keep Alive</p> <p>MQTT keep-alive interval in seconds (1-600). The device sends a ping to the broker if no other messages are sent within this interval to maintain the connection.</p> <p>Publish Message Interval</p> <p>Minimum interval between published MQTT messages in milliseconds (0-1000).</p> <p>Disable Rate Limiting</p> <p>0 = no rate limiting. Messages will be sent immediately.</p> <p>This rate limiting may be used to prevent overwhelming the broker with rapid updates, if necessary.</p> <p>Clean Session</p> <p>When enabled, the broker discards all information about previous sessions when the client connects.</p> <ul> <li>Enabled (checked): Start with a clean slate, no retained messages or subscriptions</li> <li>Disabled (unchecked): Resume previous session with retained messages and subscriptions</li> </ul> <p>Session Persistence</p> <p>Genius Gateway does not rely on the MQTT broker's persistence function, as it publishes the state of all smoke detectors to the broker on every reconnect.</p> <p>It is therefore recommended to enable this feature to ensure a consistent state and stable connection at all times.</p> <p>Applying Changes</p> <p>Click Apply Settings to save and apply the MQTT configuration. The device will reconnect to the MQTT broker with the new settings.</p>"},{"location":"setup/connections/#smart-home-integration","title":"Smart Home Integration","text":"<p>The Smart Home Integration section provides two MQTT publishing modes specifically designed for home automation systems.</p> <p>Administrator Access Required</p> <p>Smart home integration settings can only be modified by users with administrator privileges.</p>"},{"location":"setup/connections/#simple-alarm-publishing","title":"Simple Alarm Publishing","text":"<p>Enable simple alarm publishing</p> <p>Toggle to enable/disable publishing alarm events to a central topic.</p> <p>Alarm Topic</p> <p>MQTT topic where alarm state is published when any smoke detector triggers an alarm.</p> Valid MQTT Topic Syntax <ul> <li>1-64 characters</li> <li>no wildcards <code>+</code> or <code>#</code></li> <li>cannot start or end with <code>/</code></li> <li>no double slashes <code>//</code></li> <li>no special characters except <code>/</code>, <code>-</code>, and <code>_</code></li> </ul> <p>Global Alarm State Topic</p> <p>More details to this Global Alarm State Topic, like its specific payload format, can be found in the MQTT API.</p>"},{"location":"setup/connections/#device-publishing","title":"Device Publishing","text":"<p>Enable device publishing</p> <p>Toggle to enable/disable publishing individual detector configurations and states with Home Assistant MQTT Discovery  support.</p> <p>MQTT Topics Path Prefix</p> <p>Topic prefix used for all detector device publications. </p> Valid MQTT Topic Syntax <ul> <li>1-64 characters</li> <li>no wildcards <code>+</code> or <code>#</code></li> <li>cannot start or end with <code>/</code></li> <li>no double slashes <code>//</code></li> <li>no special characters except <code>/</code>, <code>-</code>, and <code>_</code></li> </ul> <p>Home Assistant compatibility</p> <p>The Topic path must also comply with the Home Assistant MQTT Discovery Messages  requirements.</p> <p>Below the topic input field, the derived configuration and state topics are displayed.</p> <p>Global Alarm State Topic</p> <p>More details to this Home Assistant Auto-Discovery related MQTT Topics, like their specific payload format, can be found in the MQTT API.</p> <p>Applying Changes</p> <p>Click Apply Settings to save the smart home integration configuration. The button is:</p> <ul> <li>Disabled when no changes are pending or validation errors exist</li> <li>Enabled when valid changes are ready to apply</li> </ul> <p>Changes take effect immediately after applying.</p>"},{"location":"setup/connections/#related-documentation","title":"Related Documentation","text":"<p>Integration with Home Assistant and other smart home systems is described in more detail in Smart Home Integration.</p>"},{"location":"setup/connections/#network-time-ntp","title":"Network Time (NTP)","text":"<p>Network Time Protocol (NTP) synchronizes the device's internal clock with internet time servers, ensuring accurate timestamps for logs, alarms, and event recording.</p> <p></p>"},{"location":"setup/connections/#ntp-status","title":"NTP Status","text":"<p>The status section displays various time synchronization information, updated every 5 seconds.</p>"},{"location":"setup/connections/#change-ntp-settings","title":"Change NTP Settings","text":"<p>Click the Change NTP Settings collapsible section to configure NTP parameters.</p> <p>Administrator Access Required</p> <p>NTP settings can only be modified by users with administrator privileges.</p>"},{"location":"setup/connections/#enable-ntp","title":"Enable NTP","text":"<p>Toggle checkbox to enable or disable NTP time synchronization.</p>"},{"location":"setup/connections/#server","title":"Server","text":"<p>NTP server hostname or IPv4 address.</p> <ul> <li>Format: Valid domain name or IPv4 address (3-64 characters)</li> <li>Default: <code>pool.ntp.org</code> (public NTP pool server)</li> </ul>"},{"location":"setup/connections/#pick-time-zone","title":"Pick Time Zone","text":"<p>Select your local timezone from the dropdown list. The device uses this to convert UTC time to your local time.</p> <p>Daylight Saving Time</p> <p>The selected timezone automatically handles daylight saving time transitions where applicable.</p>"},{"location":"setup/connections/#applying-changes","title":"Applying Changes","text":"<p>Click Apply Settings to save and apply the NTP configuration. The device will apply the new timezone and NTP server settings immediately and begin time synchronization.</p>"},{"location":"setup/general-setup/","title":"General Setup","text":""},{"location":"setup/general-setup/#general-setup","title":"General Setup","text":""},{"location":"setup/general-setup/#hardware-setup","title":"Hardware Setup","text":"<p>Choose either the experimental setup to test the functions of Genius Gateway, or the Genius Gateway PCB to put Genius Gateway into operation.</p>"},{"location":"setup/general-setup/#build-and-install-software","title":"Build and Install Software","text":""},{"location":"setup/general-setup/#ide-und-plugins","title":"IDE und Plugins","text":"<p>The project is based on the PlatformIO  build system. Unfortunately, PlatformIO does not support Espressif Arduino 3.x . </p> <p>Fortunately, there is piorduino : a community-maintained fork of the PlatformIO IDE for Visual Studio Code that provides support for Espressif microcontrollers, especially the newer ESP32 boards and the latest Arduino Core for them.</p> <ol> <li>Download and install Microsoft VSCode .</li> <li>Install Pioarduino IDE (pioarduino)  extension from within VSCode.</li> </ol>"},{"location":"setup/general-setup/#clone-github-project","title":"Clone GitHub Project","text":"<ol> <li> <p>Clone the project to your local environment </p><pre><code>git clone https://github.com/hmbacher/genius-gateway.git\n</code></pre><p></p> </li> <li> <p>Open the project in VSCode </p><pre><code>cd genius-gateway\nvscode .\n</code></pre><p></p> </li> </ol>"},{"location":"setup/general-setup/#configuration","title":"Configuration","text":""},{"location":"setup/general-setup/#target-board","title":"Target board","text":"<p>Choose the board you are working with in <code>platformio.ini</code> file by (un)commenting the appropriate <code>default_envs</code> options: </p><pre><code>[platformio]\ndescription = Genius Gateway - A gateway for Hekatron Genius Plus X smoke detectors\ndata_dir = data\nextra_configs = \n    factory_settings.ini\n    features.ini\n    config.ini\n;default_envs = esp32-s3-devkitc-1\n;default_envs = esp32-s3-devkitc-1-n8r2\ndefault_envs = seeed-xiao-esp32s3\n</code></pre><p></p> <p>No PSRAM used</p> <p>Since PSRAM is not necessary or not used by Genius Gateway, it is not necessary to create variants of <code>esp32-s3-devkitc-1</code> (e.g., <code>esp32-s3-devkitc-1-n8r2</code>).</p>"},{"location":"setup/general-setup/#spi-bus-wiring","title":"SPI bus wiring","text":"<p>Depending on the technical setup, the SPI bus-related signal lines may need to be adjusted. This is done via the <code>config.ini</code> file: </p><pre><code>[config]\nbuild_flags = \n  ; --- Espressif ESP32S3 DevKit-C 1 ---\n  ; -D CONFIG_CSN_GPIO=45   ; blue\n  ; -D CONFIG_MISO_GPIO=11  ; yellow\n  ; -D CONFIG_GDO0_GPIO=47  ; gray\n  ; -D CONFIG_MOSI_GPIO=13  ; brown\n  ; -D CONFIG_SCK_GPIO=12   ; white\n  ; -D GPIO_TEST1=21\n  ; -D GPIO_TEST2=14\n  ; --- XIAO ESP32S3 &amp; Genius Gateway PCB 1.0 ---\n  -D CONFIG_CSN_GPIO=5\n  -D CONFIG_MISO_GPIO=8\n  -D CONFIG_GDO0_GPIO=6\n  -D CONFIG_MOSI_GPIO=9\n  -D CONFIG_SCK_GPIO=7\n  -D GPIO_TEST1=1\n  -D GPIO_TEST2=2\n  -D GPIO_TEST3=3\n  -D GPIO_TEST4=4\n  ; Common\n  -D HOST_ID=1\n</code></pre><p></p>"},{"location":"setup/general-setup/#more-build-options","title":"More build options","text":"<p>The platformio.ini file is the main file for controlling the software build. It references three additional files whose content is evaluated by the build system: - <code>features.ini</code> - <code>factory-settings.ini</code> - <code>config.ini</code></p> <p>Critical</p> <p>Settings can be made in the listed files that affect the build and the later functionality of the Genius Gateway.</p> <p>For regular functionality, no adjustments beyond those described above need to be made.</p>"},{"location":"setup/general-setup/#build","title":"Build","text":""},{"location":"setup/general-setup/#build-software","title":"Build Software","text":"<p>Start the Build task for the corresponding project environment (target device):  </p> <p></p>"},{"location":"setup/general-setup/#flash-software","title":"Flash Software","text":"<p>Make sure you have properly connected the board to your computer via USB cable. A serial device must appear in the systems devices.</p> <p>Start the Upload and Monitor Task and pick the right serial interface if asked:  </p> <p></p> <p>After the device has been successfully flashed, it will restart and you will see its serial output in VSCode's terminal window.</p>"},{"location":"setup/general-setup/#initial-configuration-of-genius-gateway","title":"Initial Configuration of Genius Gateway","text":"<p>After the first startup, the device has the settings stored in factory_settings.ini .</p> <p>The device creates its own WiFi network with the SSID <code>Genius-Gateway-XXX</code> and the password <code>genius-gateway</code>. The Genius Gateway web interface can be accessed via the IP address 192.168.4.1 .</p> <p>The default password for the <code>admin</code> account is <code>admin</code>.</p>"},{"location":"setup/general-setup/#wifi-settings","title":"WiFi Settings","text":"<p>Genius Gateway can be integrated into an existing WiFi network.</p>"},{"location":"setup/general-setup/#users","title":"Users","text":"<p>By default, two users are created: an <code>admin</code> account with elevated privileges and a <code>guest</code> account with limited privileges.</p> <p>Additional users can be created with their own username and password. See the Users page for details on managing user accounts.</p>"},{"location":"setup/general-setup/#change-jwt-secret","title":"Change JWT Secret","text":"<p>For security reasons, it is strongly recommended to change the default JWT (JSON Web Token) secret after initial setup. The JWT secret is used to sign authentication tokens and should be unique for your gateway.</p> <p>To change the JWT token, navigate to the Security Settings section on the Users page and enter a new JWT secret value. Note that changing the JWT secret will sign out all users immediately.</p> <p>How to get a secure JWT Secret</p> <p>You can generate a cryptographically strong JWT secret using an online tool such as RandomKeygen . Use a Fort Knox Password (256-bit or higher) for maximum security.</p>"},{"location":"setup/general-setup/#mqtt","title":"MQTT","text":"<p>For integration into a smart home system, the local MQTT broker must be configured. See the MQTT Settings page for details on configuring the MQTT connection.</p>"},{"location":"setup/system/","title":"System","text":""},{"location":"setup/system/#system","title":"System","text":"<p>The System pages provide comprehensive information about the Genius Gateway's hardware status, performance metrics, diagnostic tools, and firmware management capabilities.</p>"},{"location":"setup/system/#system-status","title":"System Status","text":"<p>The System Status page displays detailed information about the gateway's current operating state, hardware configuration, and resource utilization. This information updates in real-time via WebSocket connection.</p> <p></p>"},{"location":"setup/system/#system-information","title":"System Information","text":"<p>The status page displays a lot of self-explaning system related information.</p>"},{"location":"setup/system/#device-management-actions","title":"Device Management Actions","text":"<p>At the bottom of the System Status page, several management actions are available:</p>"},{"location":"setup/system/#restart","title":"Restart","text":"<p>Performs a software restart of the device. The device will reboot and reconnect to the network automatically.</p>"},{"location":"setup/system/#factory-reset","title":"Factory Reset","text":"<p>Resets all settings to factory defaults, including: - WiFi configuration - User accounts - MQTT settings - Device and alarm line configurations - All other custom settings</p> <p>Permanent Action</p> <p>Factory reset cannot be undone. All configuration data will be permanently erased. The device will restart with default system settings (from <code>factory_settings.ini</code>) and not Genius PLus X related configuration.</p>"},{"location":"setup/system/#cc1101","title":"CC1101","text":"<p>The CC1101 page displays the current state of the CC1101 radio transceiver chip used for communication with smoke detectors. This page is only accessible to administrators and only available if the CC1101 controller feature is enabled.</p> <p></p>"},{"location":"setup/system/#main-radio-control-state-machine-state-marcstate","title":"Main Radio Control State Machine State (MARCSTATE)","text":"<p>The CC1101 chip operates in various states during normal operation. The page displays the current state in the format <code>STATE / NAME</code>, where STATE represents the functional state group and NAME represents the specific MARCSTATE value.</p> <ul> <li>SLEEP / SLEEP: Low-power sleep mode</li> <li>IDLE / IDLE: Radio is idle and ready</li> <li>XOFF / XOFF: Crystal oscillator off</li> <li>MANCAL / VCOON_MC: Voltage-controlled oscillator on (manual calibration)</li> <li>MANCAL / REGON_MC: Regulator on (manual calibration)</li> <li>MANCAL / MANCAL: Manual calibration in progress</li> <li>FS_WAKEUP / VCOON: Voltage-controlled oscillator on</li> <li>FS_WAKEUP / REGON: Regulator on</li> <li>CALIBRATE / STARTCAL: Starting calibration</li> <li>SETTLING / BWBOOST: Bandwidth boost during settling</li> <li>SETTLING / FS_LOCK: Frequency synthesizer lock</li> <li>SETTLING / IFADCON: IF ADC on during settling</li> <li>CALIBRATE / ENDCAL: Ending calibration</li> <li>RX / RX: Receiving mode (normal listening state)</li> <li>RX / RX_END: End of receive</li> <li>RX / RX_RST: Receive reset</li> <li>TXRX_SETTLING / TXRX_SWITCH: Switching from transmit to receive</li> <li>RXFIFO_OVERFLOW / RXFIFO_OVERFLOW: Receive buffer overflow (data loss)</li> <li>FSTXON / FSTXON: Frequency synthesizer ready for transmission</li> <li>TX / TX: Transmitting mode</li> <li>TX / TX_END: End of transmit</li> <li>RXTX_SETTLING / RXTX_SWITCH: Switching from receive to transmit</li> <li>TXFIFO_UNDERFLOW / TXFIFO_UNDERFLOW: Transmit buffer underflow</li> </ul>"},{"location":"setup/system/#actions","title":"Actions","text":""},{"location":"setup/system/#update-cc1101-state","title":"Update CC1101 State","text":"<p>Click the  Update button to refresh the current CC1101 state from the chip.</p>"},{"location":"setup/system/#set-cc1101-to-rx-state","title":"Set CC1101 to RX State","text":"<p>Click the  Listen button to command the CC1101 chip to enter receive (RX) mode. This button is disabled if: - The chip is already in RX state - An SPI communication error occurred</p> <p>Not for regular use</p> <p>The CC1101 chip should typically be in RX state (<code>RX/RX</code>) during normal operation to receive packets from smoke detectors. If the chip is in an unexpected state, you can try to return to RX mode.</p>"},{"location":"setup/system/#error-conditions","title":"Error Conditions","text":"<p>If an error occurs, the state display will show:</p> <ul> <li>Red indicator: Error condition detected</li> <li>Error message: Description of the problem (e.g., \"SPI error while obtaining state\" or \"Invalid state\")</li> </ul>"},{"location":"setup/system/#system-metrics","title":"System Metrics","text":"<p>The System Metrics page provides real-time graphical visualization of system performance over time.</p> <p>Metrics collection begins when the web interface connects to the device and continues while it remains open, with data displayed as line charts. Charts update automatically as new data arrives via WebSocket.</p> <p></p> <p>Performance Monitoring</p> <p>Monitor these metrics to identify resource constraints, memory leaks, or thermal issues. Sudden spikes or trends may indicate problems that need attention.</p>"},{"location":"setup/system/#memory-heap-usage","title":"Memory (Heap) Usage","text":"<p>Line chart showing:</p> <ul> <li>Used: Amount of heap memory currently allocated (primary line)</li> <li>Max Alloc: Maximum contiguous block available for allocation (secondary line)</li> </ul> <p>Y-axis scale adjusts to the total heap size.</p>"},{"location":"setup/system/#psram-usage","title":"PSRAM Usage","text":"<p>Line chart showing PSRAM utilization over time.</p> <p>Info</p> <p>This chart is only displayed if PSRAM is available on the device.</p>"},{"location":"setup/system/#file-system-usage","title":"File System Usage","text":"<p>Line chart showing the amount of flash storage used by the file system over time.</p>"},{"location":"setup/system/#core-temperature","title":"Core Temperature","text":"<p>Line chart showing the ESP32 chip temperature in degrees Celsius over time. Useful for monitoring thermal performance and detecting overheating conditions.</p>"},{"location":"setup/system/#core-dump","title":"Core Dump","text":"<p>The Core Dump page allows you to download diagnostic information captured when the device experiences a crash or exception. This data can be helpful for debugging firmware issues.</p> <p></p>"},{"location":"setup/system/#core-dump-information","title":"Core Dump Information","text":"<p>A core dump is a snapshot of the device's memory at the moment of a crash, including:</p> <ul> <li>Register states</li> <li>Stack trace</li> <li>Memory contents</li> <li>Exception cause</li> </ul>"},{"location":"setup/system/#downloading-core-dumps","title":"Downloading Core Dumps","text":"<p>If a core dump is available:</p> <ol> <li>Click the Download Core Dump (coredump.bin) button to download the core dump file to your computer</li> <li>This file can be analyzed using ESP-IDF tools  to determine the crash cause</li> </ol> <p>Info</p> <p>If no core dump is available, the message \"No core dump available.\" is displayed.</p>"},{"location":"setup/system/#firmware-update","title":"Firmware Update","text":"<p>The Firmware Update page provides two methods for updating the gateway firmware: downloading releases from GitHub or manually uploading firmware files.</p> <p></p> <p>Administrator Access Required</p> <p>Firmware update features are only accessible to users with administrator privileges.</p>"},{"location":"setup/system/#upload-firmware","title":"Upload Firmware","text":"<p>The Upload Firmware section allows manual installation of firmware files from your local computer.</p>"},{"location":"setup/system/#firmware-validation","title":"Firmware Validation","text":"<p>The upload service performs several validation checks to ensure firmware safety:</p> <ul> <li>File Type Verification: Only <code>.bin</code> (firmware binary) and <code>.md5</code> (checksum) files are accepted</li> <li>Firmware Size Check: Minimum size of 1 MB required (for the <code>.bin</code> file) to be recognized as valid firmware</li> <li> <p>Target Hardware Validation: The firmware header is checked to ensure it matches the device's chip type (ESP32, ESP32-S2, ESP32-C3, or ESP32-S3)</p> <p>Target Compatibility</p> <p>Firmware compiled for a different ESP32 chip variant will be rejected during upload. For example, firmware built for ESP32-S3 cannot be uploaded to an ESP32-S2 device.</p> </li> <li> <p>MD5 Checksum: If an <code>.md5</code> file is uploaded before the firmware, the binary is verified against the checksum during upload</p> </li> </ul>"},{"location":"setup/system/#supported-file-types","title":"Supported File Types","text":"<ul> <li>.bin: Compiled firmware binary file (minimum 1 MB)</li> <li>.md5: MD5 checksum file (32-character hex string)</li> </ul> <p>The <code>.md5</code> file should contain only the 32-character MD5 hash of the corresponding <code>.bin</code> file.</p>"},{"location":"setup/system/#uploading-firmware","title":"Uploading Firmware","text":"<p>To upload firmware manually:</p> <ol> <li> <p>(Optional) Upload MD5 checksum first:</p> <ul> <li>Click Choose File and select the <code>.md5</code> file</li> <li>The checksum is stored and will be used to verify the firmware</li> </ul> </li> <li> <p>Upload the firmware binary:</p> <ul> <li>Click Choose File and select the <code>.bin</code> file</li> <li>A confirmation dialog appears: \"Are you sure you want to overwrite the existing firmware with a new one?\"</li> <li>Click Upload to confirm and begin the installation</li> </ul> </li> <li> <p>Firmware Installation:</p> <ul> <li>The device validates the firmware header</li> <li>If an MD5 checksum was provided, the firmware is verified against it</li> <li>The firmware is written to the device's flash memory</li> <li>Upon successful completion, the device automatically restarts and executes the newly installed firmware</li> </ul> </li> </ol> <p>Failure Recovery</p> <p>If the firmware validation or flashing fails or the device becomes unresponsive after an update:</p> <ul> <li>After upload: If validation fails (wrong chip type, MD5 mismatch), the upload is rejected and the current firmware remains active</li> <li>During flashing: If persisting the new firmware to flash memory fails, the current firmware remains active after restart</li> <li>After restart: If the new firmware crashes or fails to boot properly, the device will likely enter a boot loop. Then a manual recovery is required, i.e. flashing a working firmware via USB using the build and flash instructions.</li> </ul> <p>No Automatic Rollback</p> <p>The firmware does not implement automatic rollback to the previous version. Always test new firmware builds on a development device before updating production devices.</p>"},{"location":"setup/users/","title":"Users","text":""},{"location":"setup/users/#users","title":"Users","text":"<p>The Users page allows administrators to manage user accounts and configure security settings for the Genius Gateway. Each user can have different privilege levels, and authentication is secured using JWT (JSON Web Token) technology.</p> <p>Administrator Access Required</p> <p>The Users page is only accessible to users with administrator privileges. Non-admin users are automatically redirected to the home page.</p> <p></p>"},{"location":"setup/users/#manage-users","title":"Manage Users","text":"<p>The user management section displays all configured users in a table format and provides controls for adding, editing, and deleting user accounts.</p>"},{"location":"setup/users/#user-list","title":"User List","text":"<p>The user table displays the following information for each user:</p> <ul> <li>Username: The user's login name</li> <li>Admin: Displays a  key icon if the user has administrator privileges</li> <li>Edit: Action buttons for modifying or removing the user</li> </ul>"},{"location":"setup/users/#adding-a-user","title":"Adding a User","text":"<p>To create a new user account:</p> <ol> <li>Click the  button in the top-right corner of the user list</li> <li> <p>The \"Add User\" dialog opens</p> <p></p> </li> <li> <p>Configure the user details:</p> <p>Username </p> <p>Enter a unique username (3-32 characters) for the new account.</p> <p>Warning</p> <p>The username cannot be changed after creation.</p> <p>Password Enter a password for the user.</p> <p>Warning</p> <p>The password field can be left empty if desired, though this is not recommended for security reasons.</p> <p>Is Admin? Check this box to grant administrator privileges to the user. Administrators have full access to all gateway features and settings, including user management.</p> </li> <li> <p>Click Save to create the user</p> </li> </ol> <p>After saving, the new user appears in the user list and can immediately log in with the configured credentials.</p>"},{"location":"setup/users/#editing-a-user","title":"Editing a User","text":"<p>To modify an existing user account:</p> <ol> <li>Click the  Edit button next to the user you want to modify</li> <li> <p>The \"Edit User\" dialog opens with the current settings</p> <p></p> </li> <li> <p>Modify the desired settings:</p> <p>Username The username field is displayed but cannot be modified for existing users.</p> <p>Password Enter a new password to change the user's credentials. Leave the field unchanged to keep the current password.</p> <p>Is Admin? Check or uncheck this box to change the user's administrator privileges.</p> </li> <li> <p>Click Save to apply the changes</p> </li> </ol> <p>Privilege Changes</p> <p>Changes to administrator privileges take effect immediately. If you remove admin privileges from your own account while logged in, you will lose access to the Users page and other admin-only features until you log in with an admin account.</p>"},{"location":"setup/users/#deleting-a-user","title":"Deleting a User","text":"<p>Permanent Action</p> <p>Deleting a user is permanent and cannot be undone. The user will be immediately logged out if currently connected.</p> <p>To remove a user account:</p> <ol> <li>Click the  Delete button next to the user you want to remove</li> <li>A confirmation dialog appears</li> <li>Click Yes to confirm deletion, or Abort to cancel</li> </ol> <p>The user account is immediately removed and can no longer be used to access the gateway.</p>"},{"location":"setup/users/#security-settings","title":"Security Settings","text":"<p>The Security Settings section allows you to configure the JWT (JSON Web Token) secret used for authentication token signing.</p>"},{"location":"setup/users/#jwt-secret","title":"JWT Secret","text":"<p>The JWT secret is a cryptographic key used to sign and verify authentication tokens. This ensures that tokens cannot be forged or tampered with.</p> <p>Default Value: A random string generated during factory setup</p> <p>To change the JWT secret:</p> <ol> <li>Enter a new value in the JWT Secret field</li> <li>Click Apply Settings to save the change</li> </ol> <p>Sign-Out Warning</p> <p>If you modify the JWT Secret, all users will be signed out immediately. All active sessions will be invalidated, and users must log in again with their credentials.</p>"},{"location":"setup/users/#best-practices","title":"Best Practices","text":"<ul> <li>Protect the JWT Secret: Never share or expose the JWT secret. It should be treated as a highly sensitive credential.</li> <li>Use Strong Secrets: The JWT secret should be a long, random string to ensure maximum security.</li> <li>Change After Setup: Consider changing the default JWT secret during initial setup to ensure unique security for your gateway.</li> <li>Regular Updates: For enhanced security, consider changing the JWT secret periodically (this will require all users to log in again).</li> </ul>"},{"location":"setup/users/#authentication-flow","title":"Authentication Flow","text":"<p>The token-based authentication provides secure access control without requiring passwords to be sent with every request.</p> <p>When a user logs in to the Genius Gateway:</p> <ol> <li>The user provides their username and password</li> <li>The gateway validates the credentials against the user database</li> <li>If valid, a JWT token is generated and signed with the JWT secret</li> <li>The token is sent to the user's browser and included in all subsequent requests</li> <li>The gateway verifies the token signature on each request to ensure authenticity</li> </ol> <pre><code>sequenceDiagram\n    participant User as User Browser\n    participant Gateway as Genius Gateway\n\n    Note over User,Gateway: Login Phase\n    User-&gt;&gt;Gateway: POST /login (username, password)\n    Gateway-&gt;&gt;Gateway: Validate credentials\n    Gateway-&gt;&gt;Gateway: Generate JWT token&lt;br/&gt;signed with JWT secret\n    Gateway--&gt;&gt;User: Return JWT token\n    User-&gt;&gt;User: Store token in browser\n\n    Note over User,Gateway: Authenticated Requests\n    User-&gt;&gt;Gateway: API Request&lt;br/&gt;(Authorization: Bearer &lt;token&gt;)\n    Gateway-&gt;&gt;Gateway: Verify token signature&lt;br/&gt;using JWT secret\n    Gateway--&gt;&gt;User: Return response (if valid)\n\n    Note over User,Gateway: Token Invalidation\n    User-&gt;&gt;Gateway: Logout or JWT secret changed\n    User-&gt;&gt;User: Clear stored token\n    User--&gt;&gt;Gateway: Must re-authenticate</code></pre>"},{"location":"setup/wifi/","title":"WiFi","text":""},{"location":"setup/wifi/#wifi-configuration","title":"WiFi Configuration","text":"<p>The WiFi configuration allows you to connect the Genius Gateway to your local network and optionally provide an Access Point for initial setup or fallback connectivity. This page covers both WiFi Station (client) mode and Access Point mode configuration.</p>"},{"location":"setup/wifi/#wifi-station","title":"WiFi Station","text":"<p>The WiFi Station mode connects the Genius Gateway to your existing WiFi network as a client device. This is the primary mode for integrating the gateway into your home network.</p>"},{"location":"setup/wifi/#wifi-connection","title":"WiFi Connection","text":"<p>When you access the WiFi Station page, you'll see the current connection status at the top of the page.</p>"},{"location":"setup/wifi/#not-connected","title":"Not Connected","text":"<p>When the gateway is not connected to any WiFi network, the status shows as \"Inactive\":</p> <p></p>"},{"location":"setup/wifi/#connected","title":"Connected","text":"<p>When successfully connected to a WiFi network, the status shows detailed connection information:</p> <p></p>"},{"location":"setup/wifi/#settings-networks","title":"Settings &amp; Networks","text":"<p>Access Requirements</p> <p>WiFi settings can only be modified by users with administrator privileges.</p> <p>The Settings &amp; Networks section allows you to configure the hostname and manage known WiFi networks.</p>"},{"location":"setup/wifi/#host-name-mdns","title":"Host Name (mDNS)","text":"<p>Format: 3-32 characters</p> <p>The hostname is used for mDNS (multicast DNS) resolution, allowing you to access the gateway using a friendly name like <code>http://hostname.local</code> instead of an IP address.</p>"},{"location":"setup/wifi/#wifi-connection-mode","title":"WiFi Connection Mode","text":"<p>The connection mode determines how the gateway selects which network to connect to when multiple networks are available:</p> <ul> <li>Offline: WiFi connection is disabled</li> <li>Signal Strength: Automatically connects to the network with the strongest signal</li> <li> <p>Priority (Sequence): Connects to networks based on the order in the list (drag-and-drop to reorder)</p> <p>Priority Mode</p> <p>When using Priority mode with multiple networks configured, arrange the networks according to their priority (most important first) using the drag-and-drop handles.</p> </li> </ul>"},{"location":"setup/wifi/#initial-configuration","title":"Initial Configuration","text":"<p>When no WiFi networks are configured, you'll see a message:</p> <p>No WiFi networks configured yet. Scan for available networks or add one manually.</p> <p>Use the Scan or Add buttons to configure your first network.</p>"},{"location":"setup/wifi/#adding-wifi-networks","title":"Adding WiFi Networks","text":"<p>The gateway supports up to 5 configured WiFi networks. You can add networks in two ways:</p>"},{"location":"setup/wifi/#scanning-for-networks","title":"Scanning for Networks","text":"<ol> <li>Click the  Scan button in the top-right corner</li> <li> <p>The gateway scans for available WiFi networks</p> <p></p> </li> <li> <p>After scanning completes, a list of discovered networks appears</p> <p></p> </li> <li> <p>Click on a network from the list to proceed with configuration</p> </li> <li>The \"Add network\" dialog opens with the SSID pre-filled</li> </ol> <p>Network Limit</p> <p>If you already have 5 networks configured, you'll see a message: \"You have reached the maximum number of networks. Please delete one to add another.\"</p>"},{"location":"setup/wifi/#manual-entry","title":"Manual Entry","text":"<ol> <li>Click the  Add button in the top-right corner</li> <li> <p>The \"Add network\" dialog opens</p> <p></p> </li> <li> <p>Configure the network parameters:</p> <p>SSID Enter the network name (case-sensitive)</p> <p>Password Enter the WiFi password (if the network is secured)</p> <p>Password Storage</p> <p>WiFi passwords are stored unencrypted in the device's file system. Ensure physical access to the device is restricted.</p> <p>Use Static IP Enable this option to configure a static IP address instead of using DHCP</p> <p>Static IP Configuration (only when \"Use Static IP\" is enabled):</p> <ul> <li>Local IP: The static IP address to assign to the gateway</li> <li>Gateway IP: The network gateway address</li> <li>Subnet Mask: The network subnet mask</li> <li>DNS IP 1: Primary DNS server address</li> <li>DNS IP 2: Secondary DNS server address (optional)</li> </ul> </li> <li> <p>Click Save to add the network</p> </li> </ol> <p></p> <p>The new network appears in the list with a badge indicating either \"Static\" or \"DHCP\" configuration.</p>"},{"location":"setup/wifi/#managing-networks","title":"Managing Networks","text":"<p>Each configured network in the list displays:</p> <ul> <li> Drag handle: Reorder networks (only visible when Connection Mode is set to \"Priority\")</li> <li>SSID: Network name</li> <li>Configuration badge: Shows \"Static\" (static IP) or \"DHCP\" (automatic IP)</li> <li> Edit button: Modify network settings</li> <li> Delete button: Remove the network from the list</li> </ul>"},{"location":"setup/wifi/#editing-a-network","title":"Editing a Network","text":"<ol> <li>Click the  Edit button next to the network you want to modify</li> <li>The \"Edit network\" dialog opens with current settings</li> <li>Modify the desired parameters</li> <li>Click Save to apply changes</li> </ol>"},{"location":"setup/wifi/#deleting-a-network","title":"Deleting a Network","text":"<ol> <li>Click the  Delete button next to the network you want to remove</li> <li>A confirmation dialog appears: \"Are you sure you want to delete network '[SSID]'?\"</li> <li>Click Delete to confirm removal</li> </ol>"},{"location":"setup/wifi/#reordering-networks-priority-mode","title":"Reordering Networks (Priority Mode)","text":"<p>When Connection Mode is set to \"Priority (Sequence)\":</p> <ol> <li>Click and hold the  grip handle on the left side of a network entry</li> <li>Drag the network to the desired position</li> <li>Release to drop the network in its new position</li> <li>The gateway will attempt to connect to networks in the displayed order</li> </ol>"},{"location":"setup/wifi/#applying-settings","title":"Applying Settings","text":"<p>After making changes to the hostname, connection mode, or network list:</p> <ol> <li>The Apply Settings button becomes enabled</li> <li>Click Apply Settings to save your configuration</li> <li>A notification confirms: \"Wi-Fi settings updated.\"</li> <li>If WiFi connection settings changed, you may see: \"Reconnecting shortly as new WiFi settings will be applied in X seconds.\"</li> </ol> <p>Connection Changes</p> <p>When changing WiFi settings, the gateway will reconnect to apply the new configuration. This may cause a brief disconnection.</p>"},{"location":"setup/wifi/#access-point","title":"Access Point","text":"<p>The Access Point mode allows the Genius Gateway to create its own WiFi network, enabling direct connection from your devices. This is useful for initial setup when no WiFi credentials are known, or as a fallback when the primary WiFi connection is unavailable.</p> <p></p>"},{"location":"setup/wifi/#access-point-status","title":"Access Point Status","text":"<p>The status section displays current Access Point information:</p>"},{"location":"setup/wifi/#status","title":"Status","text":"<p>The AP status can be:</p> <ul> <li>Active (green): Access Point is running and accepting connections</li> <li>Inactive (red): Access Point is disabled</li> <li>Lingering (yellow): Access Point is in the process of shutting down</li> </ul>"},{"location":"setup/wifi/#status-information","title":"Status Information","text":"<p>When the Access Point is active, the following information is displayed:</p> <ul> <li>IP Address: The gateway's IP address on the AP network (typically <code>192.168.4.1</code>)</li> <li>MAC Address: The Access Point's MAC address</li> <li>AP Clients: Number of devices currently connected to the Access Point</li> </ul>"},{"location":"setup/wifi/#access-point-settings","title":"Access Point Settings","text":"<p>Access Requirements</p> <p>Access Point settings can only be modified by users with administrator privileges.</p>"},{"location":"setup/wifi/#provide-access-point","title":"Provide Access Point ...","text":"<p>This setting controls when the Access Point is available:</p> <ul> <li>Always: Access Point is permanently enabled</li> <li>When WiFi Disconnected: Access Point activates only when the gateway cannot connect to any configured WiFi network (fallback mode)</li> <li>Never: Access Point is permanently disabled</li> </ul> <p>Recommended Setting</p> <p>\"When WiFi Disconnected\" is recommended for most users, as it provides automatic fallback connectivity while conserving resources when WiFi station is connected.</p>"},{"location":"setup/wifi/#ssid","title":"SSID","text":"<p>Format: 2-32 characters</p> <p>The network name (SSID) that will be broadcast by the Access Point. Choose a unique name to identify your gateway's network.</p>"},{"location":"setup/wifi/#password","title":"Password","text":"<p>The WiFi password required to connect to the Access Point. Leave empty for an open (unsecured) network.</p> <p>Security</p> <p>For security reasons, it's strongly recommended to set a password for your Access Point.</p> <p>Password Storage</p> <p>WiFi passwords are stored unencrypted in the device's file system. Ensure physical access to the device is restricted.</p>"},{"location":"setup/wifi/#preferred-channel","title":"Preferred Channel","text":"<p>Range: 1-13</p> <p>The WiFi channel number the Access Point will use. If experiencing interference, try changing to a different channel. Channels 1, 6, and 11 are commonly recommended as they don't overlap.</p>"},{"location":"setup/wifi/#max-clients","title":"Max Clients","text":"<p>Range: 1-8</p> <p>The maximum number of devices that can simultaneously connect to the Access Point. Lower values reduce resource usage.</p>"},{"location":"setup/wifi/#local-ip","title":"Local IP","text":"<p>Format: Valid IPv4 address</p> <p>The IP address the gateway will use on the Access Point network. Standard configuration is <code>192.168.4.1</code>.</p>"},{"location":"setup/wifi/#gateway-ip","title":"Gateway IP","text":"<p>Format: Valid IPv4 address</p> <p>The gateway IP address for the Access Point network. This is typically the same as the Local IP (<code>192.168.4.1</code>).</p>"},{"location":"setup/wifi/#subnet-mask","title":"Subnet Mask","text":"<p>Format: Valid IPv4 address</p> <p>The subnet mask for the Access Point network. Standard configuration is <code>255.255.255.0</code>.</p>"},{"location":"setup/wifi/#applying-access-point-settings","title":"Applying Access Point Settings","text":"<p>After modifying Access Point settings:</p> <ol> <li>Click the Apply Settings button at the bottom of the form</li> <li>All fields are validated:<ul> <li>SSID must be 2-32 characters</li> <li>Channel must be 1-13</li> <li>Max Clients must be 1-8</li> <li>All IP addresses must be valid IPv4 format</li> </ul> </li> <li>If validation passes, a notification confirms: \"Access Point settings updated.\"</li> <li>If validation fails, error messages appear below the invalid fields in red text</li> </ol> <p>Configuration Tips</p> <ul> <li>Use the default IP configuration (<code>192.168.4.1</code>) unless you have specific networking requirements</li> <li>Set Max Clients to match your expected usage to optimize performance</li> <li>Choose a channel with minimal interference from nearby networks</li> </ul>"}]}